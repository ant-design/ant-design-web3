"use strict";(self.webpackChunk_ant_design_web3_docs=self.webpackChunk_ant_design_web3_docs||[]).push([[9909],{49909:function(vt,le,p){p.d(le,{default:function(){return Et}});const de=()=>"9.1.0",fe=e=>e.toString(16).padStart(2,"0"),he=e=>{const t=new Uint8Array((e||40)/2);return window.crypto.getRandomValues(t),Array.from(t,fe).join("")},pe=()=>typeof window<"u"?he(10):new Date().getTime().toString(36);class I{}I.makeRequest=(e,t)=>({id:pe(),method:e,params:t,env:{sdkVersion:de()}}),I.makeResponse=(e,t,n)=>({id:e,success:!0,version:n,data:t}),I.makeErrorResponse=(e,t,n)=>({id:e,success:!1,error:t,version:n});var c;(function(e){e.sendTransactions="sendTransactions",e.rpcCall="rpcCall",e.getChainInfo="getChainInfo",e.getSafeInfo="getSafeInfo",e.getTxBySafeTxHash="getTxBySafeTxHash",e.getSafeBalances="getSafeBalances",e.signMessage="signMessage",e.signTypedMessage="signTypedMessage",e.getEnvironmentInfo="getEnvironmentInfo",e.getOffChainSignature="getOffChainSignature",e.requestAddressBook="requestAddressBook",e.wallet_getPermissions="wallet_getPermissions",e.wallet_requestPermissions="wallet_requestPermissions"})(c||(c={}));var T;(function(e){e.requestAddressBook="requestAddressBook"})(T||(T={}));class ge{constructor(t=null,n=!1){this.allowedOrigins=null,this.callbacks=new Map,this.debugMode=!1,this.isServer=typeof window>"u",this.isValidMessage=({origin:r,data:s,source:o})=>{const a=!s,i=!this.isServer&&o===window.parent,u=typeof s.version<"u"&&parseInt(s.version.split(".")[0]),m=typeof u=="number"&&u>=1;let h=!0;return Array.isArray(this.allowedOrigins)&&(h=this.allowedOrigins.find(l=>l.test(r))!==void 0),!a&&i&&m&&h},this.logIncomingMessage=r=>{console.info(`Safe Apps SDK v1: A message was received from origin ${r.origin}. `,r.data)},this.onParentMessage=r=>{this.isValidMessage(r)&&(this.debugMode&&this.logIncomingMessage(r),this.handleIncomingMessage(r.data))},this.handleIncomingMessage=r=>{const{id:s}=r,o=this.callbacks.get(s);o&&(o(r),this.callbacks.delete(s))},this.send=(r,s)=>{const o=I.makeRequest(r,s);if(this.isServer)throw new Error("Window doesn't exist");return window.parent.postMessage(o,"*"),new Promise((a,i)=>{this.callbacks.set(o.id,u=>{if(!u.success){i(new Error(u.error));return}a(u)})})},this.allowedOrigins=t,this.debugMode=n,this.isServer||window.addEventListener("message",this.onParentMessage)}}var ye=ge;const z=e=>typeof e=="object"&&e!=null&&"domain"in e&&"types"in e&&"message"in e;var St=p(52478);class me{constructor(t){this.communicator=t}async getBySafeTxHash(t){if(!t)throw new Error("Invalid safeTxHash");return(await this.communicator.send(c.getTxBySafeTxHash,{safeTxHash:t})).data}async signMessage(t){const n={message:t};return(await this.communicator.send(c.signMessage,n)).data}async signTypedMessage(t){if(!z(t))throw new Error("Invalid typed data");return(await this.communicator.send(c.signTypedMessage,{typedData:t})).data}async send({txs:t,params:n}){if(!t||!t.length)throw new Error("No transactions were passed");const r={txs:t,params:n};return(await this.communicator.send(c.sendTransactions,r)).data}}const d={eth_call:"eth_call",eth_gasPrice:"eth_gasPrice",eth_getLogs:"eth_getLogs",eth_getBalance:"eth_getBalance",eth_getCode:"eth_getCode",eth_getBlockByHash:"eth_getBlockByHash",eth_getBlockByNumber:"eth_getBlockByNumber",eth_getStorageAt:"eth_getStorageAt",eth_getTransactionByHash:"eth_getTransactionByHash",eth_getTransactionReceipt:"eth_getTransactionReceipt",eth_getTransactionCount:"eth_getTransactionCount",eth_estimateGas:"eth_estimateGas",safe_setSettings:"safe_setSettings"},b={defaultBlockParam:(e="latest")=>e,returnFullTxObjectParam:(e=!1)=>e,blockNumberToHex:e=>Number.isInteger(e)?`0x${e.toString(16)}`:e};class be{constructor(t){this.communicator=t,this.call=this.buildRequest({call:d.eth_call,formatters:[null,b.defaultBlockParam]}),this.getBalance=this.buildRequest({call:d.eth_getBalance,formatters:[null,b.defaultBlockParam]}),this.getCode=this.buildRequest({call:d.eth_getCode,formatters:[null,b.defaultBlockParam]}),this.getStorageAt=this.buildRequest({call:d.eth_getStorageAt,formatters:[null,b.blockNumberToHex,b.defaultBlockParam]}),this.getPastLogs=this.buildRequest({call:d.eth_getLogs}),this.getBlockByHash=this.buildRequest({call:d.eth_getBlockByHash,formatters:[null,b.returnFullTxObjectParam]}),this.getBlockByNumber=this.buildRequest({call:d.eth_getBlockByNumber,formatters:[b.blockNumberToHex,b.returnFullTxObjectParam]}),this.getTransactionByHash=this.buildRequest({call:d.eth_getTransactionByHash}),this.getTransactionReceipt=this.buildRequest({call:d.eth_getTransactionReceipt}),this.getTransactionCount=this.buildRequest({call:d.eth_getTransactionCount,formatters:[null,b.defaultBlockParam]}),this.getGasPrice=this.buildRequest({call:d.eth_gasPrice}),this.getEstimateGas=n=>this.buildRequest({call:d.eth_estimateGas})([n]),this.setSafeSettings=this.buildRequest({call:d.safe_setSettings})}buildRequest(t){const{call:n,formatters:r}=t;return async s=>{r&&Array.isArray(s)&&r.forEach((i,u)=>{i&&(s[u]=i(s[u]))});const o={call:n,params:s||[]};return(await this.communicator.send(c.rpcCall,o)).data}}}function E(e){return typeof e[0]=="string"?F(e):we(e)}function we(e){let t=0;for(const s of e)t+=s.length;const n=new Uint8Array(t);let r=0;for(const s of e)n.set(s,r),r+=s.length;return n}function F(e){return`0x${e.reduce((t,n)=>t+n.replace("0x",""),"")}`}function C(e,{includeName:t=!1}={}){if(e.type!=="function"&&e.type!=="event"&&e.type!=="error")throw new Pe(e.type);return`${e.name}(${H(e.inputs,{includeName:t})})`}function H(e,{includeName:t=!1}={}){return e?e.map(n=>Ee(n,{includeName:t})).join(t?", ":","):""}function Ee(e,{includeName:t}){return e.type.startsWith("tuple")?`(${H(e.components,{includeName:t})})${e.type.slice(5)}`:e.type+(t&&e.name?` ${e.name}`:"")}var g=p(68045),f=p(23011);class $t extends null{constructor({docsPath:t}){super(["A constructor was not found on the ABI.","Make sure you are using the correct ABI and that the constructor exists on it."].join(`
`),{docsPath:t,name:"AbiConstructorNotFoundError"})}}class Bt extends null{constructor({docsPath:t}){super(["Constructor arguments were provided (`args`), but a constructor parameters (`inputs`) were not found on the ABI.","Make sure you are using the correct ABI, and that the `inputs` attribute on the constructor exists."].join(`
`),{docsPath:t,name:"AbiConstructorParamsNotFoundError"})}}class It extends null{constructor({data:t,size:n}){super([`Data size of ${n} bytes is invalid.`,"Size must be in increments of 32 bytes (size % 32 === 0)."].join(`
`),{metaMessages:[`Data: ${t} (${n} bytes)`],name:"AbiDecodingDataSizeInvalidError"})}}class Pt extends null{constructor({data:t,params:n,size:r}){super([`Data size of ${r} bytes is too small for given parameters.`].join(`
`),{metaMessages:[`Params: (${formatAbiParams(n,{includeName:!0})})`,`Data:   ${t} (${r} bytes)`],name:"AbiDecodingDataSizeTooSmallError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t,this.params=n,this.size=r}}class Tt extends null{constructor(){super('Cannot decode zero data ("0x") with ABI parameters.',{name:"AbiDecodingZeroDataError"})}}class Ae extends f.G{constructor({expectedLength:t,givenLength:n,type:r}){super([`ABI encoding array length mismatch for type ${r}.`,`Expected length: ${t}`,`Given length: ${n}`].join(`
`),{name:"AbiEncodingArrayLengthMismatchError"})}}class xe extends f.G{constructor({expectedSize:t,value:n}){super(`Size of bytes "${n}" (bytes${(0,g.d)(n)}) does not match expected size (bytes${t}).`,{name:"AbiEncodingBytesSizeMismatchError"})}}class ve extends f.G{constructor({expectedLength:t,givenLength:n}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${t}`,`Given length (values): ${n}`].join(`
`),{name:"AbiEncodingLengthMismatchError"})}}class Ct extends null{constructor(t,{docsPath:n}){super([`Arguments (\`args\`) were provided to "${t}", but "${t}" on the ABI does not contain any parameters (\`inputs\`).`,"Cannot encode error result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the inputs exist on it."].join(`
`),{docsPath:n,name:"AbiErrorInputsNotFoundError"})}}class Dt extends null{constructor(t,{docsPath:n}={}){super([`Error ${t?`"${t}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it."].join(`
`),{docsPath:n,name:"AbiErrorNotFoundError"})}}class Mt extends null{constructor(t,{docsPath:n}){super([`Encoded error signature "${t}" not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${t}.`].join(`
`),{docsPath:n,name:"AbiErrorSignatureNotFoundError"}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.signature=t}}class kt extends null{constructor({docsPath:t}){super("Cannot extract event signature from empty topics.",{docsPath:t,name:"AbiEventSignatureEmptyTopicsError"})}}class jt extends null{constructor(t,{docsPath:n}){super([`Encoded event signature "${t}" not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${t}.`].join(`
`),{docsPath:n,name:"AbiEventSignatureNotFoundError"})}}class Nt extends null{constructor(t,{docsPath:n}={}){super([`Event ${t?`"${t}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it."].join(`
`),{docsPath:n,name:"AbiEventNotFoundError"})}}class V extends f.G{constructor(t,{docsPath:n}={}){super([`Function ${t?`"${t}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionNotFoundError"})}}class Ot extends null{constructor(t,{docsPath:n}){super([`Function "${t}" does not contain any \`outputs\` on ABI.`,"Cannot decode function result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionOutputsNotFoundError"})}}class Rt extends null{constructor(t,{docsPath:n}){super([`Encoded function signature "${t}" not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${t}.`].join(`
`),{docsPath:n,name:"AbiFunctionSignatureNotFoundError"})}}class Se extends f.G{constructor(t,n){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${t.type}\` in \`${C(t.abiItem)}\`, and`,`\`${n.type}\` in \`${C(n.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."],name:"AbiItemAmbiguityError"})}}class $e extends f.G{constructor({expectedSize:t,givenSize:n}){super(`Expected bytes${t}, got bytes${n}.`,{name:"BytesSizeMismatchError"})}}class zt extends null{constructor({abiItem:t,data:n,params:r,size:s}){super([`Data size of ${s} bytes is too small for non-indexed event parameters.`].join(`
`),{metaMessages:[`Params: (${formatAbiParams(r,{includeName:!0})})`,`Data:   ${n} (${s} bytes)`],name:"DecodeLogDataMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=t,this.data=n,this.params=r,this.size=s}}class Ft extends null{constructor({abiItem:t,param:n}){super([`Expected a topic for indexed event parameter${n.name?` "${n.name}"`:""} on event "${formatAbiItem(t,{includeName:!0})}".`].join(`
`),{name:"DecodeLogTopicsMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=t}}class Be extends f.G{constructor(t,{docsPath:n}){super([`Type "${t}" is not a valid encoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiEncodingType"})}}class Ht extends null{constructor(t,{docsPath:n}){super([`Type "${t}" is not a valid decoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiDecodingType"})}}class Ie extends f.G{constructor(t){super([`Value "${t}" is not a valid array.`].join(`
`),{name:"InvalidArrayError"})}}class Pe extends f.G{constructor(t){super([`"${t}" is not a valid definition type.`,'Valid types: "function", "event", "error"'].join(`
`),{name:"InvalidDefinitionTypeError"})}}class Vt extends null{constructor(t){super(`Type "${t}" is not supported for packed encoding.`,{name:"UnsupportedPackedAbiType"})}}class _ extends f.G{constructor({address:t}){super(`Address "${t}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}var Te=p(34819),Ce=p(78390),De=p(76113);const Me=/^0x[a-fA-F0-9]{40}$/,D=new Ce.k(8192);function x(e,t){const{strict:n=!0}=t??{},r=`${e}.${n}`;if(D.has(r))return D.get(r);const s=Me.test(e)?e.toLowerCase()===e?!0:n?(0,De.x)(e)===e:!0:!1;return D.set(r,s),s}var A=p(89236),q=p(40534),G=p(81013);function L(e,t,n,{strict:r}={}){return(0,G.v)(e,{strict:!1})?je(e,t,n,{strict:r}):ke(e,t,n,{strict:r})}function W(e,t){if(typeof t=="number"&&t>0&&t>(0,g.d)(e)-1)throw new q.mV({offset:t,position:"start",size:(0,g.d)(e)})}function U(e,t,n){if(typeof t=="number"&&typeof n=="number"&&(0,g.d)(e)!==n-t)throw new q.mV({offset:n,position:"end",size:(0,g.d)(e)})}function ke(e,t,n,{strict:r}={}){W(e,t);const s=e.slice(t,n);return r&&U(s,t,n),s}function je(e,t,n,{strict:r}={}){W(e,t);const s=`0x${e.replace("0x","").slice((t??0)*2,(n??e.length)*2)}`;return r&&U(s,t,n),s}var y=p(2275);const _t=/^(.*)\[([0-9]*)\]$/,Ne=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,J=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function M(e,t){if(e.length!==t.length)throw new ve({expectedLength:e.length,givenLength:t.length});const n=Oe({params:e,values:t}),r=j(n);return r.length===0?"0x":r}function Oe({params:e,values:t}){const n=[];for(let r=0;r<e.length;r++)n.push(k({param:e[r],value:t[r]}));return n}function k({param:e,value:t}){const n=Ge(e.type);if(n){const[r,s]=n;return ze(t,{length:r,param:{...e,type:s}})}if(e.type==="tuple")return qe(t,{param:e});if(e.type==="address")return Re(t);if(e.type==="bool")return He(t);if(e.type.startsWith("uint")||e.type.startsWith("int")){const r=e.type.startsWith("int"),[,,s="256"]=J.exec(e.type)??[];return Ve(t,{signed:r,size:Number(s)})}if(e.type.startsWith("bytes"))return Fe(t,{param:e});if(e.type==="string")return _e(t);throw new Be(e.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function j(e){let t=0;for(let o=0;o<e.length;o++){const{dynamic:a,encoded:i}=e[o];a?t+=32:t+=(0,g.d)(i)}const n=[],r=[];let s=0;for(let o=0;o<e.length;o++){const{dynamic:a,encoded:i}=e[o];a?(n.push((0,y.eC)(t+s,{size:32})),r.push(i),s+=(0,g.d)(i)):n.push(i)}return E([...n,...r])}function Re(e){if(!x(e))throw new _({address:e});return{dynamic:!1,encoded:(0,A.gc)(e.toLowerCase())}}function ze(e,{length:t,param:n}){const r=t===null;if(!Array.isArray(e))throw new Ie(e);if(!r&&e.length!==t)throw new Ae({expectedLength:t,givenLength:e.length,type:`${n.type}[${t}]`});let s=!1;const o=[];for(let a=0;a<e.length;a++){const i=k({param:n,value:e[a]});i.dynamic&&(s=!0),o.push(i)}if(r||s){const a=j(o);if(r){const i=(0,y.eC)(o.length,{size:32});return{dynamic:!0,encoded:o.length>0?E([i,a]):i}}if(s)return{dynamic:!0,encoded:a}}return{dynamic:!1,encoded:E(o.map(({encoded:a})=>a))}}function Fe(e,{param:t}){const[,n]=t.type.split("bytes"),r=(0,g.d)(e);if(!n){let s=e;return r%32!==0&&(s=(0,A.gc)(s,{dir:"right",size:Math.ceil((e.length-2)/2/32)*32})),{dynamic:!0,encoded:E([(0,A.gc)((0,y.eC)(r,{size:32})),s])}}if(r!==Number.parseInt(n))throw new xe({expectedSize:Number.parseInt(n),value:e});return{dynamic:!1,encoded:(0,A.gc)(e,{dir:"right"})}}function He(e){if(typeof e!="boolean")throw new f.G(`Invalid boolean value: "${e}" (type: ${typeof e}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:(0,A.gc)((0,y.C4)(e))}}function Ve(e,{signed:t,size:n=256}){if(typeof n=="number"){const r=2n**(BigInt(n)-(t?1n:0n))-1n,s=t?-r-1n:0n;if(e>r||e<s)throw new Te.J5({max:r.toString(),min:s.toString(),signed:t,size:n/8,value:e.toString()})}return{dynamic:!1,encoded:(0,y.eC)(e,{size:32,signed:t})}}function _e(e){const t=(0,y.$G)(e),n=Math.ceil((0,g.d)(t)/32),r=[];for(let s=0;s<n;s++)r.push((0,A.gc)(L(t,s*32,(s+1)*32),{dir:"right"}));return{dynamic:!0,encoded:E([(0,A.gc)((0,y.eC)((0,g.d)(t),{size:32})),...r])}}function qe(e,{param:t}){let n=!1;const r=[];for(let s=0;s<t.components.length;s++){const o=t.components[s],a=Array.isArray(e)?s:o.name,i=k({param:o,value:e[a]});r.push(i),i.dynamic&&(n=!0)}return{dynamic:n,encoded:n?j(r):E(r.map(({encoded:s})=>s))}}function Ge(e){const t=e.match(/^(.*)\[(\d+)?\]$/);return t?[t[2]?Number(t[2]):null,t[1]]:void 0}var Le=p(26654),w=p(59520);const We=e=>(0,w.w)((0,Le.O0)(e));function Ue(e){return We(e)}function Je(e,t){const n=e.exec(t);return n==null?void 0:n.groups}const qt=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,Gt=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,Lt=/^\(.+?\).*?$/,Y=/^tuple(?<array>(\[(\d*)\])*)$/;function N(e){let t=e.type;if(Y.test(e.type)&&"components"in e){t="(";const n=e.components.length;for(let s=0;s<n;s++){const o=e.components[s];t+=N(o),s<n-1&&(t+=", ")}const r=Je(Y,e.type);return t+=`)${(r==null?void 0:r.array)??""}`,N({...e,type:t})}return"indexed"in e&&e.indexed&&(t=`${t} indexed`),e.name?`${t} ${e.name}`:t}function v(e){let t="";const n=e.length;for(let r=0;r<n;r++){const s=e[r];t+=N(s),r!==n-1&&(t+=", ")}return t}function Ye(e){var t;return e.type==="function"?`function ${e.name}(${v(e.inputs)})${e.stateMutability&&e.stateMutability!=="nonpayable"?` ${e.stateMutability}`:""}${(t=e.outputs)!=null&&t.length?` returns (${v(e.outputs)})`:""}`:e.type==="event"?`event ${e.name}(${v(e.inputs)})`:e.type==="error"?`error ${e.name}(${v(e.inputs)})`:e.type==="constructor"?`constructor(${v(e.inputs)})${e.stateMutability==="payable"?" payable":""}`:e.type==="fallback"?`fallback() external${e.stateMutability==="payable"?" payable":""}`:"receive() external payable"}function Ke(e){let t=!0,n="",r=0,s="",o=!1;for(let a=0;a<e.length;a++){const i=e[a];if(["(",")",","].includes(i)&&(t=!0),i==="("&&r++,i===")"&&r--,!!t){if(r===0){if(i===" "&&["event","function",""].includes(s))s="";else if(s+=i,i===")"){o=!0;break}continue}if(i===" "){e[a-1]!==","&&n!==","&&n!==",("&&(n="",t=!1);continue}s+=i,n+=i}}if(!o)throw new f.G("Unable to normalize signature.");return s}const Ze=e=>{const t=typeof e=="string"?e:Ye(e);return Ke(t)};function K(e){return Ue(Ze(e))}const Z=e=>L(K(e),0,4),Qe=K;function Xe(e){const{abi:t,args:n=[],name:r}=e,s=(0,G.v)(r,{strict:!1}),o=t.filter(i=>s?i.type==="function"?Z(i)===r:i.type==="event"?Qe(i)===r:!1:"name"in i&&i.name===r);if(o.length===0)return;if(o.length===1)return o[0];let a;for(const i of o){if(!("inputs"in i))continue;if(!n||n.length===0){if(!i.inputs||i.inputs.length===0)return i;continue}if(!i.inputs||i.inputs.length===0||i.inputs.length!==n.length)continue;if(n.every((m,h)=>{const l="inputs"in i&&i.inputs[h];return l?O(m,l):!1})){if(a&&"inputs"in a&&a.inputs){const m=Q(i.inputs,a.inputs,n);if(m)throw new Se({abiItem:i,type:m[0]},{abiItem:a,type:m[1]})}a=i}}return a||o[0]}function O(e,t){const n=typeof e,r=t.type;switch(r){case"address":return x(e,{strict:!1});case"bool":return n==="boolean";case"function":return n==="string";case"string":return n==="string";default:return r==="tuple"&&"components"in t?Object.values(t.components).every((s,o)=>O(Object.values(e)[o],s)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(r)?n==="number"||n==="bigint":/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(r)?n==="string"||e instanceof Uint8Array:/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(r)?Array.isArray(e)&&e.every(s=>O(s,{...t,type:r.replace(/(\[[0-9]{0,}\])$/,"")})):!1}}function Q(e,t,n){for(const r in e){const s=e[r],o=t[r];if(s.type==="tuple"&&o.type==="tuple"&&"components"in s&&"components"in o)return Q(s.components,o.components,n[r]);const a=[s.type,o.type];if(a.includes("address")&&a.includes("bytes20")?!0:a.includes("address")&&a.includes("string")?x(n[r],{strict:!1}):a.includes("address")&&a.includes("bytes")?x(n[r],{strict:!1}):!1)return a}}const X="/docs/contract/encodeFunctionData";function et(e){const{abi:t,args:n,functionName:r}=e;let s=t[0];if(r){const o=Xe({abi:t,args:n,name:r});if(!o)throw new V(r,{docsPath:X});s=o}if(s.type!=="function")throw new V(void 0,{docsPath:X});return{abi:[s],functionName:Z(C(s))}}function ee(e){const{args:t}=e,{abi:n,functionName:r}=(()=>{var i;return e.abi.length===1&&((i=e.functionName)!=null&&i.startsWith("0x"))?e:et(e)})(),s=n[0],o=r,a="inputs"in s&&s.inputs?M(s.inputs,t??[]):void 0;return F([o,a??"0x"])}const tt=`Ethereum Signed Message:
`;function nt(e){const t=typeof e=="string"?(0,y.$G)(e):typeof e.raw=="string"?e.raw:(0,y.ci)(e.raw),n=(0,y.$G)(`${tt}${(0,g.d)(t)}`);return E([n,t])}function rt(e,t){return(0,w.w)(nt(e),t)}const st=(e,t,n)=>JSON.stringify(e,(r,s)=>{const o=typeof s=="bigint"?s.toString():s;return typeof t=="function"?t(r,o):o},n);class ot extends f.G{constructor({domain:t}){super(`Invalid domain "${st(t)}".`,{metaMessages:["Must be a valid EIP-712 domain."]})}}class it extends f.G{constructor({primaryType:t,types:n}){super(`Invalid primary type \`${t}\` must be one of \`${JSON.stringify(Object.keys(n))}\`.`,{docsPath:"/api/glossary/Errors#typeddatainvalidprimarytypeerror",metaMessages:["Check that the primary type is a key in `types`."]})}}class at extends f.G{constructor({type:t}){super(`Struct type "${t}" is invalid.`,{metaMessages:["Struct type must not be a Solidity type."],name:"InvalidStructTypeError"})}}function Wt(e){const{domain:t,message:n,primaryType:r,types:s}=e,o=(u,m)=>{const h={...m};for(const l of u){const{name:$,type:P}=l;P==="address"&&(h[$]=h[$].toLowerCase())}return h},a=s.EIP712Domain?t?o(s.EIP712Domain,t):{}:{},i=(()=>{if(r!=="EIP712Domain")return o(s[r],n)})();return stringify({domain:a,message:i,primaryType:r,types:s})}function ct(e){const{domain:t,message:n,primaryType:r,types:s}=e,o=(a,i)=>{for(const u of a){const{name:m,type:h}=u,l=i[m],$=h.match(J);if($&&(typeof l=="number"||typeof l=="bigint")){const[At,B,xt]=$;(0,y.eC)(l,{signed:B==="int",size:Number.parseInt(xt)/8})}if(h==="address"&&typeof l=="string"&&!x(l))throw new _({address:l});const P=h.match(Ne);if(P){const[At,B]=P;if(B&&(0,g.d)(l)!==Number.parseInt(B))throw new $e({expectedSize:Number.parseInt(B),givenSize:(0,g.d)(l)})}const ue=s[h];ue&&(ut(h),o(ue,l))}};if(s.EIP712Domain&&t){if(typeof t!="object")throw new ot({domain:t});o(s.EIP712Domain,t)}if(r!=="EIP712Domain")if(s[r])o(s[r],n);else throw new it({primaryType:r,types:s})}function te({domain:e}){return[typeof(e==null?void 0:e.name)=="string"&&{name:"name",type:"string"},(e==null?void 0:e.version)&&{name:"version",type:"string"},(typeof(e==null?void 0:e.chainId)=="number"||typeof(e==null?void 0:e.chainId)=="bigint")&&{name:"chainId",type:"uint256"},(e==null?void 0:e.verifyingContract)&&{name:"verifyingContract",type:"address"},(e==null?void 0:e.salt)&&{name:"salt",type:"bytes32"}].filter(Boolean)}function Ut({domain:e}){return hashDomain({domain:e,types:{EIP712Domain:te({domain:e})}})}function ut(e){if(e==="address"||e==="bool"||e==="string"||e.startsWith("bytes")||e.startsWith("uint")||e.startsWith("int"))throw new at({type:e})}function lt(e){const{domain:t={},message:n,primaryType:r}=e,s={EIP712Domain:te({domain:t}),...e.types};ct({domain:t,message:n,primaryType:r,types:s});const o=["0x1901"];return t&&o.push(dt({domain:t,types:s})),r!=="EIP712Domain"&&o.push(ne({data:n,primaryType:r,types:s})),(0,w.w)(E(o))}function dt({domain:e,types:t}){return ne({data:e,primaryType:"EIP712Domain",types:t})}function ne({data:e,primaryType:t,types:n}){const r=re({data:e,primaryType:t,types:n});return(0,w.w)(r)}function re({data:e,primaryType:t,types:n}){const r=[{type:"bytes32"}],s=[ft({primaryType:t,types:n})];for(const o of n[t]){const[a,i]=oe({types:n,name:o.name,type:o.type,value:e[o.name]});r.push(a),s.push(i)}return M(r,s)}function ft({primaryType:e,types:t}){const n=(0,y.NC)(ht({primaryType:e,types:t}));return(0,w.w)(n)}function ht({primaryType:e,types:t}){let n="";const r=se({primaryType:e,types:t});r.delete(e);const s=[e,...Array.from(r).sort()];for(const o of s)n+=`${o}(${t[o].map(({name:a,type:i})=>`${i} ${a}`).join(",")})`;return n}function se({primaryType:e,types:t},n=new Set){const r=e.match(/^\w*/u),s=r==null?void 0:r[0];if(n.has(s)||t[s]===void 0)return n;n.add(s);for(const o of t[s])se({primaryType:o.type,types:t},n);return n}function oe({types:e,name:t,type:n,value:r}){if(e[n]!==void 0)return[{type:"bytes32"},(0,w.w)(re({data:r,primaryType:n,types:e}))];if(n==="bytes")return r=`0x${(r.length%2?"0":"")+r.slice(2)}`,[{type:"bytes32"},(0,w.w)(r)];if(n==="string")return[{type:"bytes32"},(0,w.w)((0,y.NC)(r))];if(n.lastIndexOf("]")===n.length-1){const s=n.slice(0,n.lastIndexOf("[")),o=r.map(a=>oe({name:t,type:s,types:e,value:a}));return[{type:"bytes32"},(0,w.w)(M(o.map(([a])=>a),o.map(([,a])=>a)))]}return[{type:n},r]}const pt="0x1626ba7e",gt="0x20c13b0b",R=4001;class S extends Error{constructor(t,n,r){super(t),this.code=n,this.data=r,Object.setPrototypeOf(this,S.prototype)}}class ie{constructor(t){this.communicator=t}async getPermissions(){return(await this.communicator.send(c.wallet_getPermissions,void 0)).data}async requestPermissions(t){if(!this.isPermissionRequestValid(t))throw new S("Permissions request is invalid",R);try{return(await this.communicator.send(c.wallet_requestPermissions,t)).data}catch{throw new S("Permissions rejected",R)}}isPermissionRequestValid(t){return t.every(n=>typeof n=="object"?Object.keys(n).every(r=>!!Object.values(T).includes(r)):!1)}}const ae=(e,t)=>t.some(n=>n.parentCapability===e);var yt=()=>(e,t,n)=>{const r=n.value;return n.value=async function(){const s=new ie(this.communicator);let o=await s.getPermissions();if(ae(t,o)||(o=await s.requestPermissions([{[t]:{}}])),!ae(t,o))throw new S("Permissions rejected",R);return r.apply(this)},n},mt=function(e,t,n,r){var s=arguments.length,o=s<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(a=e[i])&&(o=(s<3?a(o):s>3?a(t,n,o):a(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o};class ce{constructor(t){this.communicator=t}async getChainInfo(){return(await this.communicator.send(c.getChainInfo,void 0)).data}async getInfo(){return(await this.communicator.send(c.getSafeInfo,void 0)).data}async experimental_getBalances({currency:t="usd"}={}){return(await this.communicator.send(c.getSafeBalances,{currency:t})).data}async check1271Signature(t,n="0x"){const r=await this.getInfo(),s=ee({abi:[{constant:!1,inputs:[{name:"_dataHash",type:"bytes32"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[t,n]}),o={call:d.eth_call,params:[{to:r.safeAddress,data:s},"latest"]};try{return(await this.communicator.send(c.rpcCall,o)).data.slice(0,10).toLowerCase()===pt}catch{return!1}}async check1271SignatureBytes(t,n="0x"){const r=await this.getInfo(),s=ee({abi:[{constant:!1,inputs:[{name:"_data",type:"bytes"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[t,n]}),o={call:d.eth_call,params:[{to:r.safeAddress,data:s},"latest"]};try{return(await this.communicator.send(c.rpcCall,o)).data.slice(0,10).toLowerCase()===gt}catch{return!1}}calculateMessageHash(t){return rt(t)}calculateTypedMessageHash(t){const n=typeof t.domain.chainId=="object"?t.domain.chainId.toNumber():Number(t.domain.chainId);let r=t.primaryType;if(!r){const s=Object.values(t.types),o=Object.keys(t.types).filter(a=>s.every(i=>i.every(({type:u})=>u.replace("[","").replace("]","")!==a)));if(o.length===0||o.length>1)throw new Error("Please specify primaryType");r=o[0]}return lt({message:t.message,domain:{...t.domain,chainId:n,verifyingContract:t.domain.verifyingContract,salt:t.domain.salt},types:t.types,primaryType:r})}async getOffChainSignature(t){return(await this.communicator.send(c.getOffChainSignature,t)).data}async isMessageSigned(t,n="0x"){let r;if(typeof t=="string"&&(r=async()=>{const s=this.calculateMessageHash(t);return await this.isMessageHashSigned(s,n)}),z(t)&&(r=async()=>{const s=this.calculateTypedMessageHash(t);return await this.isMessageHashSigned(s,n)}),r)return await r();throw new Error("Invalid message type")}async isMessageHashSigned(t,n="0x"){const r=[this.check1271Signature.bind(this),this.check1271SignatureBytes.bind(this)];for(const s of r)if(await s(t,n))return!0;return!1}async getEnvironmentInfo(){return(await this.communicator.send(c.getEnvironmentInfo,void 0)).data}async requestAddressBook(){return(await this.communicator.send(c.requestAddressBook,void 0)).data}}mt([yt()],ce.prototype,"requestAddressBook",null);class bt{constructor(t={}){const{allowedDomains:n=null,debug:r=!1}=t;this.communicator=new ye(n,r),this.eth=new be(this.communicator),this.txs=new me(this.communicator),this.safe=new ce(this.communicator),this.wallet=new ie(this.communicator)}}var wt=bt,Et=wt}}]);
