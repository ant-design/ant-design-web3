(self.webpackChunk_ant_design_web3_docs=self.webpackChunk_ant_design_web3_docs||[]).push([[2286],{62286:function(Ba,Un,ce){"use strict";ce.r(Un),ce.d(Un,{UniversalProvider:function(){return H2},default:function(){return Yo}});var ti=ce(72100),Ms=ce.n(ti),Pi=ce(53070),vn=ce(19994),Ne=ce(56526),Ft=ce(36900);class vo extends Ft.q{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class ka{constructor(e,t,s){this.core=e,this.logger=t}}class yn extends Ft.q{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class yo{constructor(e,t){this.logger=e,this.core=t}}class wo extends Ft.q{constructor(e,t){super(),this.relayer=e,this.logger=t}}class jn extends Ft.q{constructor(e){super()}}class Zi{constructor(e,t,s,a){this.core=e,this.logger=t,this.name=s}}class bo{constructor(){this.map=new Map}}class _0 extends Ft.q{constructor(e,t){super(),this.relayer=e,this.logger=t}}class V4{constructor(e,t){this.core=e,this.logger=t}}class A0 extends Ft.q{constructor(e,t){super(),this.core=e,this.logger=t}}class $4{constructor(e,t){this.logger=e,this.core=t}}class E0{constructor(e,t){this.projectId=e,this.logger=t}}class I0{constructor(e,t){this.projectId=e,this.logger=t}}class J4 extends null{constructor(){super()}}class S0{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class Q4 extends null{constructor(){super()}}class x0{constructor(e){this.client=e}}var Yu=ce(41926),_o=ce(70083),P0=ce(81365),se=ce(46196),Rs=ce(73079),M0=ce(42669),Ao=ce(85577),Wu=ce(11541),R0=ce(45306),Zu=ce(54889),Ua=ce(76846),Xu=ce(9267),Pt=ce(90032);function wn(r,e,t="string"){if(!r[e]||typeof r[e]!==t)throw new Error(`Missing or invalid "${e}" param`)}function N0(r,e){let t=!0;return e.forEach(s=>{s in r||(t=!1)}),t}function C0(r,e){return Array.isArray(r)?r.length===e:Object.keys(r).length===e}function O0(r,e){return Array.isArray(r)?r.length>=e:Object.keys(r).length>=e}function Eo(r,e,t){return(t.length?O0(r,e.length):C0(r,e.length))?N0(r,e):!1}function Io(r,e,t="_"){const s=r.split(t);return s[s.length-1].trim().toLowerCase()===e.trim().toLowerCase()}function G4(r){return eh(r.method)&&th(r.params)}function eh(r){return Io(r,"subscribe")}function th(r){return Eo(r,["topic"],[])}function Y4(r){return rh(r.method)&&ih(r.params)}function rh(r){return Io(r,"publish")}function ih(r){return Eo(r,["message","topic","ttl"],["prompt","tag"])}function W4(r){return nh(r.method)&&sh(r.params)}function nh(r){return Io(r,"unsubscribe")}function sh(r){return Eo(r,["id","topic"],[])}function Z4(r){return oh(r.method)&&ah(r.params)}function oh(r){return Io(r,"subscription")}function ah(r){return Eo(r,["id","data"],[])}function X4(r){if(!eh(r.method))throw new Error("JSON-RPC Request has invalid subscribe method");if(!th(r.params))throw new Error("JSON-RPC Request has invalid subscribe params");const e=r.params;return wn(e,"topic"),e}function eI(r){if(!rh(r.method))throw new Error("JSON-RPC Request has invalid publish method");if(!ih(r.params))throw new Error("JSON-RPC Request has invalid publish params");const e=r.params;return wn(e,"topic"),wn(e,"message"),wn(e,"ttl","number"),e}function tI(r){if(!nh(r.method))throw new Error("JSON-RPC Request has invalid unsubscribe method");if(!sh(r.params))throw new Error("JSON-RPC Request has invalid unsubscribe params");const e=r.params;return wn(e,"id"),e}function rI(r){if(!oh(r.method))throw new Error("JSON-RPC Request has invalid subscription method");if(!ah(r.params))throw new Error("JSON-RPC Request has invalid subscription params");const e=r.params;return wn(e,"id"),wn(e,"data"),e}const F0={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var zn=ce(14224),ch=ce(55872).Buffer;const So=":";function Ln(r){const[e,t]=r.split(So);return{namespace:e,reference:t}}function D0(r){const{namespace:e,reference:t}=r;return[e,t].join(So)}function uh(r){const[e,t,s]=r.split(So);return{namespace:e,reference:t,address:s}}function T0(r){const{namespace:e,reference:t,address:s}=r;return[e,t,s].join(So)}function hh(r,e){const t=[];return r.forEach(s=>{const a=e(s);t.includes(a)||t.push(a)}),t}function q0(r){const{address:e}=uh(r);return e}function B0(r){const{namespace:e,reference:t}=uh(r);return D0({namespace:e,reference:t})}function iI(r,e){const{namespace:t,reference:s}=Ln(e);return T0({namespace:t,reference:s,address:r})}function nI(r){return hh(r,q0)}function k0(r){return hh(r,B0)}function sI(r,e=[]){const t=[];return Object.keys(r).forEach(s=>{if(e.length&&!e.includes(s))return;const a=r[s];t.push(...a.accounts)}),t}function oI(r,e=[]){const t=[];return Object.keys(r).forEach(s=>{if(e.length&&!e.includes(s))return;const a=r[s];t.push(...k0(a.accounts))}),t}function aI(r,e=[]){const t=[];return Object.keys(r).forEach(s=>{if(e.length&&!e.includes(s))return;const a=r[s];t.push(...ja(s,a))}),t}function ja(r,e){return r.includes(":")?[r]:e.chains||[]}var U0=Object.defineProperty,lh=Object.getOwnPropertySymbols,j0=Object.prototype.hasOwnProperty,z0=Object.prototype.propertyIsEnumerable,fh=(r,e,t)=>e in r?U0(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,dh=(r,e)=>{for(var t in e||(e={}))j0.call(e,t)&&fh(r,t,e[t]);if(lh)for(var t of lh(e))z0.call(e,t)&&fh(r,t,e[t]);return r};const L0="ReactNative",ur={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},za=" ",cI=":",K0="/",ph=2,uI=1e3,H0="js";function Ns(){return typeof zn<"u"&&typeof zn.versions<"u"&&typeof zn.versions.node<"u"}function Kn(){return!(0,Rs.getDocument)()&&!!(0,Rs.getNavigator)()&&navigator.product===L0}function Hn(){return!Ns()&&!!(0,Rs.getNavigator)()&&!!(0,Rs.getDocument)()}function Vn(){return Kn()?ur.reactNative:Ns()?ur.node:Hn()?ur.browser:ur.unknown}function V0(){var r;try{return Kn()&&typeof ce.g<"u"&&typeof(ce.g==null?void 0:ce.g.Application)<"u"?(r=ce.g.Application)==null?void 0:r.applicationId:void 0}catch{return}}function $0(r,e){let t=Ao.parse(r);return t=dh(dh({},t),e),r=Ao.stringify(t),r}function J0(){return(0,M0.D)()||{name:"",description:"",url:"",icons:[""]}}function hI(r,e){var t;const s=Vn(),a={protocol:r,version:e,env:s};return s==="browser"&&(a.host=((t=sn())==null?void 0:t.host)||"unknown"),a}function Q0(){if(Vn()===ur.reactNative&&typeof ce.g<"u"&&typeof(ce.g==null?void 0:ce.g.Platform)<"u"){const{OS:t,Version:s}=ce.g.Platform;return[t,s].join("-")}const r=(0,P0.qY)();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function G0(){var r;const e=Vn();return e===ur.browser?[e,((r=(0,Rs.getLocation)())==null?void 0:r.host)||"unknown"].join(":"):e}function Y0(r,e,t){const s=Q0(),a=G0();return[[r,e].join("-"),[H0,t].join("-"),s,a].join("/")}function W0({protocol:r,version:e,relayUrl:t,sdkVersion:s,auth:a,projectId:u,useOnCloseEvent:f,bundleId:m}){const b=t.split("?"),w=Y0(r,e,s),P={auth:a,ua:w,projectId:u,useOnCloseEvent:f||void 0,origin:m||void 0},R=$0(b[1]||"",P);return b[0]+"?"+R}function lI(r){let e=(r.match(/^[^:]+(?=:\/\/)/gi)||[])[0];const t=typeof e<"u"?r.split("://")[1]:r;return e=e==="wss"?"https":"http",[e,t].join("://")}function fI(r,e,t){if(!r[e]||typeof r[e]!==t)throw new Error(`Missing or invalid "${e}" param`)}function Z0(r,e=ph){return X0(r.split(K0),e)}function dI(r){return Z0(r).join(za)}function bn(r,e){return r.filter(t=>e.includes(t)).length===r.length}function X0(r,e=ph){return r.slice(Math.max(r.length-e,0))}function gh(r){return Object.fromEntries(r.entries())}function mh(r){return new Map(Object.entries(r))}function pI(r,e){const t={};return Object.keys(r).forEach(s=>{t[s]=e(r[s])}),t}const gI=r=>r;function eg(r){return r.trim().replace(/^\w/,e=>e.toUpperCase())}function mI(r){return r.split(za).map(e=>eg(e)).join(za)}function _n(r=se.FIVE_MINUTES,e){const t=(0,se.toMiliseconds)(r||se.FIVE_MINUTES);let s,a,u;return{resolve:f=>{u&&s&&(clearTimeout(u),s(f))},reject:f=>{u&&a&&(clearTimeout(u),a(f))},done:()=>new Promise((f,m)=>{u=setTimeout(()=>{m(new Error(e))},t),s=f,a=m})}}function $n(r,e,t){return new Promise(async(s,a)=>{const u=setTimeout(()=>a(new Error(t)),e);try{const f=await r;s(f)}catch(f){a(f)}clearTimeout(u)})}function vh(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function tg(r){return vh("topic",r)}function rg(r){return vh("id",r)}function yh(r){const[e,t]=r.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function $t(r,e){return(0,se.fromMiliseconds)((e||Date.now())+(0,se.toMiliseconds)(r))}function Xi(r){return Date.now()>=(0,se.toMiliseconds)(r)}function Ce(r,e){return`${r}${e?`:${e}`:""}`}function zr(r=[],e=[]){return[...new Set([...r,...e])]}async function ig({id:r,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const u=`${a}/wc?requestId=${r}&sessionTopic=${e}`,f=Vn();f===ur.browser?u.startsWith("https://")||u.startsWith("http://")?window.open(u,"_blank","noreferrer noopener"):window.open(u,"_self","noreferrer noopener"):f===ur.reactNative&&typeof(ce.g==null?void 0:ce.g.Linking)<"u"&&await ce.g.Linking.openURL(u)}catch(s){console.error(s)}}async function ng(r,e){try{return await r.getItem(e)||(Hn()?localStorage.getItem(e):void 0)}catch(t){console.error(t)}}function wh(r,e){return r.filter(t=>e.includes(t))}var bh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ce.g<"u"?ce.g:typeof self<"u"?self:{};function sg(r){var e=r.default;if(typeof e=="function"){var t=function(){return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(s){var a=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:function(){return r[s]}})}),t}var _h={exports:{}};(function(r){(function(){var e="input is invalid type",t="finalize already called",s=typeof window=="object",a=s?window:{};a.JS_SHA3_NO_WINDOW&&(s=!1);var u=!s&&typeof self=="object",f=!a.JS_SHA3_NO_NODE_JS&&typeof zn=="object"&&zn.versions&&zn.versions.node;f?a=bh:u&&(a=self);var m=!a.JS_SHA3_NO_COMMON_JS&&!0&&r.exports,b=!a.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",w="0123456789abcdef".split(""),P=[31,7936,2031616,520093696],R=[4,1024,262144,67108864],F=[1,256,65536,16777216],B=[6,1536,393216,100663296],k=[0,8,16,24],L=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],H=[224,256,384,512],ee=[128,256],pe=["hex","buffer","arrayBuffer","array","digest"],de={128:168,256:136};(a.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(y){return Object.prototype.toString.call(y)==="[object Array]"}),b&&(a.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(y){return typeof y=="object"&&y.buffer&&y.buffer.constructor===ArrayBuffer});for(var oe=function(y,K,j){return function(Q){return new I(y,K,y).update(Q)[j]()}},re=function(y,K,j){return function(Q,ne){return new I(y,K,ne).update(Q)[j]()}},ue=function(y,K,j){return function(Q,ne,te,ie){return g["cshake"+y].update(Q,ne,te,ie)[j]()}},be=function(y,K,j){return function(Q,ne,te,ie){return g["kmac"+y].update(Q,ne,te,ie)[j]()}},_e=function(y,K,j,Q){for(var ne=0;ne<pe.length;++ne){var te=pe[ne];y[te]=K(j,Q,te)}return y},Ve=function(y,K){var j=oe(y,K,"hex");return j.create=function(){return new I(y,K,y)},j.update=function(Q){return j.create().update(Q)},_e(j,oe,y,K)},Ht=function(y,K){var j=re(y,K,"hex");return j.create=function(Q){return new I(y,K,Q)},j.update=function(Q,ne){return j.create(ne).update(Q)},_e(j,re,y,K)},qe=function(y,K){var j=de[y],Q=ue(y,K,"hex");return Q.create=function(ne,te,ie){return!te&&!ie?g["shake"+y].create(ne):new I(y,K,ne).bytepad([te,ie],j)},Q.update=function(ne,te,ie,fe){return Q.create(te,ie,fe).update(ne)},_e(Q,ue,y,K)},kt=function(y,K){var j=de[y],Q=be(y,K,"hex");return Q.create=function(ne,te,ie){return new ge(y,K,te).bytepad(["KMAC",ie],j).bytepad([ne],j)},Q.update=function(ne,te,ie,fe){return Q.create(ne,ie,fe).update(te)},_e(Q,be,y,K)},l=[{name:"keccak",padding:F,bits:H,createMethod:Ve},{name:"sha3",padding:B,bits:H,createMethod:Ve},{name:"shake",padding:P,bits:ee,createMethod:Ht},{name:"cshake",padding:R,bits:ee,createMethod:qe},{name:"kmac",padding:R,bits:ee,createMethod:kt}],g={},A=[],S=0;S<l.length;++S)for(var M=l[S],O=M.bits,q=0;q<O.length;++q){var x=M.name+"_"+O[q];if(A.push(x),g[x]=M.createMethod(O[q],M.padding),M.name!=="sha3"){var p=M.name+O[q];A.push(p),g[p]=g[x]}}function I(y,K,j){this.blocks=[],this.s=[],this.padding=K,this.outputBits=j,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(y<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=j>>5,this.extraBytes=(j&31)>>3;for(var Q=0;Q<50;++Q)this.s[Q]=0}I.prototype.update=function(y){if(this.finalized)throw new Error(t);var K,j=typeof y;if(j!=="string"){if(j==="object"){if(y===null)throw new Error(e);if(b&&y.constructor===ArrayBuffer)y=new Uint8Array(y);else if(!Array.isArray(y)&&(!b||!ArrayBuffer.isView(y)))throw new Error(e)}else throw new Error(e);K=!0}for(var Q=this.blocks,ne=this.byteCount,te=y.length,ie=this.blockCount,fe=0,Ae=this.s,W,je;fe<te;){if(this.reset)for(this.reset=!1,Q[0]=this.block,W=1;W<ie+1;++W)Q[W]=0;if(K)for(W=this.start;fe<te&&W<ne;++fe)Q[W>>2]|=y[fe]<<k[W++&3];else for(W=this.start;fe<te&&W<ne;++fe)je=y.charCodeAt(fe),je<128?Q[W>>2]|=je<<k[W++&3]:je<2048?(Q[W>>2]|=(192|je>>6)<<k[W++&3],Q[W>>2]|=(128|je&63)<<k[W++&3]):je<55296||je>=57344?(Q[W>>2]|=(224|je>>12)<<k[W++&3],Q[W>>2]|=(128|je>>6&63)<<k[W++&3],Q[W>>2]|=(128|je&63)<<k[W++&3]):(je=65536+((je&1023)<<10|y.charCodeAt(++fe)&1023),Q[W>>2]|=(240|je>>18)<<k[W++&3],Q[W>>2]|=(128|je>>12&63)<<k[W++&3],Q[W>>2]|=(128|je>>6&63)<<k[W++&3],Q[W>>2]|=(128|je&63)<<k[W++&3]);if(this.lastByteIndex=W,W>=ne){for(this.start=W-ne,this.block=Q[ie],W=0;W<ie;++W)Ae[W]^=Q[W];le(Ae),this.reset=!0}else this.start=W}return this},I.prototype.encode=function(y,K){var j=y&255,Q=1,ne=[j];for(y=y>>8,j=y&255;j>0;)ne.unshift(j),y=y>>8,j=y&255,++Q;return K?ne.push(Q):ne.unshift(Q),this.update(ne),ne.length},I.prototype.encodeString=function(y){var K,j=typeof y;if(j!=="string"){if(j==="object"){if(y===null)throw new Error(e);if(b&&y.constructor===ArrayBuffer)y=new Uint8Array(y);else if(!Array.isArray(y)&&(!b||!ArrayBuffer.isView(y)))throw new Error(e)}else throw new Error(e);K=!0}var Q=0,ne=y.length;if(K)Q=ne;else for(var te=0;te<y.length;++te){var ie=y.charCodeAt(te);ie<128?Q+=1:ie<2048?Q+=2:ie<55296||ie>=57344?Q+=3:(ie=65536+((ie&1023)<<10|y.charCodeAt(++te)&1023),Q+=4)}return Q+=this.encode(Q*8),this.update(y),Q},I.prototype.bytepad=function(y,K){for(var j=this.encode(K),Q=0;Q<y.length;++Q)j+=this.encodeString(y[Q]);var ne=K-j%K,te=[];return te.length=ne,this.update(te),this},I.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var y=this.blocks,K=this.lastByteIndex,j=this.blockCount,Q=this.s;if(y[K>>2]|=this.padding[K&3],this.lastByteIndex===this.byteCount)for(y[0]=y[j],K=1;K<j+1;++K)y[K]=0;for(y[j-1]|=2147483648,K=0;K<j;++K)Q[K]^=y[K];le(Q)}},I.prototype.toString=I.prototype.hex=function(){this.finalize();for(var y=this.blockCount,K=this.s,j=this.outputBlocks,Q=this.extraBytes,ne=0,te=0,ie="",fe;te<j;){for(ne=0;ne<y&&te<j;++ne,++te)fe=K[ne],ie+=w[fe>>4&15]+w[fe&15]+w[fe>>12&15]+w[fe>>8&15]+w[fe>>20&15]+w[fe>>16&15]+w[fe>>28&15]+w[fe>>24&15];te%y===0&&(le(K),ne=0)}return Q&&(fe=K[ne],ie+=w[fe>>4&15]+w[fe&15],Q>1&&(ie+=w[fe>>12&15]+w[fe>>8&15]),Q>2&&(ie+=w[fe>>20&15]+w[fe>>16&15])),ie},I.prototype.arrayBuffer=function(){this.finalize();var y=this.blockCount,K=this.s,j=this.outputBlocks,Q=this.extraBytes,ne=0,te=0,ie=this.outputBits>>3,fe;Q?fe=new ArrayBuffer(j+1<<2):fe=new ArrayBuffer(ie);for(var Ae=new Uint32Array(fe);te<j;){for(ne=0;ne<y&&te<j;++ne,++te)Ae[te]=K[ne];te%y===0&&le(K)}return Q&&(Ae[ne]=K[ne],fe=fe.slice(0,ie)),fe},I.prototype.buffer=I.prototype.arrayBuffer,I.prototype.digest=I.prototype.array=function(){this.finalize();for(var y=this.blockCount,K=this.s,j=this.outputBlocks,Q=this.extraBytes,ne=0,te=0,ie=[],fe,Ae;te<j;){for(ne=0;ne<y&&te<j;++ne,++te)fe=te<<2,Ae=K[ne],ie[fe]=Ae&255,ie[fe+1]=Ae>>8&255,ie[fe+2]=Ae>>16&255,ie[fe+3]=Ae>>24&255;te%y===0&&le(K)}return Q&&(fe=te<<2,Ae=K[ne],ie[fe]=Ae&255,Q>1&&(ie[fe+1]=Ae>>8&255),Q>2&&(ie[fe+2]=Ae>>16&255)),ie};function ge(y,K,j){I.call(this,y,K,j)}ge.prototype=new I,ge.prototype.finalize=function(){return this.encode(this.outputBits,!0),I.prototype.finalize.call(this)};var le=function(y){var K,j,Q,ne,te,ie,fe,Ae,W,je,at,Be,mi,ct,ze,jt,Le,$e,qi,Ke,ut,br,Ue,Qe,Jr,Ge,Ye,Qr,We,Ze,Gr,Xe,ht,Bi,lt,it,vi,ft,dt,ki,pt,nt,Ui,gt,mt,Yr,vt,et,ji,yt,wt,zi,_t,At,Li,Et,st,yi,wi,bi,_i,Ai,Ei;for(Q=0;Q<48;Q+=2)ne=y[0]^y[10]^y[20]^y[30]^y[40],te=y[1]^y[11]^y[21]^y[31]^y[41],ie=y[2]^y[12]^y[22]^y[32]^y[42],fe=y[3]^y[13]^y[23]^y[33]^y[43],Ae=y[4]^y[14]^y[24]^y[34]^y[44],W=y[5]^y[15]^y[25]^y[35]^y[45],je=y[6]^y[16]^y[26]^y[36]^y[46],at=y[7]^y[17]^y[27]^y[37]^y[47],Be=y[8]^y[18]^y[28]^y[38]^y[48],mi=y[9]^y[19]^y[29]^y[39]^y[49],K=Be^(ie<<1|fe>>>31),j=mi^(fe<<1|ie>>>31),y[0]^=K,y[1]^=j,y[10]^=K,y[11]^=j,y[20]^=K,y[21]^=j,y[30]^=K,y[31]^=j,y[40]^=K,y[41]^=j,K=ne^(Ae<<1|W>>>31),j=te^(W<<1|Ae>>>31),y[2]^=K,y[3]^=j,y[12]^=K,y[13]^=j,y[22]^=K,y[23]^=j,y[32]^=K,y[33]^=j,y[42]^=K,y[43]^=j,K=ie^(je<<1|at>>>31),j=fe^(at<<1|je>>>31),y[4]^=K,y[5]^=j,y[14]^=K,y[15]^=j,y[24]^=K,y[25]^=j,y[34]^=K,y[35]^=j,y[44]^=K,y[45]^=j,K=Ae^(Be<<1|mi>>>31),j=W^(mi<<1|Be>>>31),y[6]^=K,y[7]^=j,y[16]^=K,y[17]^=j,y[26]^=K,y[27]^=j,y[36]^=K,y[37]^=j,y[46]^=K,y[47]^=j,K=je^(ne<<1|te>>>31),j=at^(te<<1|ne>>>31),y[8]^=K,y[9]^=j,y[18]^=K,y[19]^=j,y[28]^=K,y[29]^=j,y[38]^=K,y[39]^=j,y[48]^=K,y[49]^=j,ct=y[0],ze=y[1],Yr=y[11]<<4|y[10]>>>28,vt=y[10]<<4|y[11]>>>28,Qr=y[20]<<3|y[21]>>>29,We=y[21]<<3|y[20]>>>29,bi=y[31]<<9|y[30]>>>23,_i=y[30]<<9|y[31]>>>23,nt=y[40]<<18|y[41]>>>14,Ui=y[41]<<18|y[40]>>>14,Bi=y[2]<<1|y[3]>>>31,lt=y[3]<<1|y[2]>>>31,jt=y[13]<<12|y[12]>>>20,Le=y[12]<<12|y[13]>>>20,et=y[22]<<10|y[23]>>>22,ji=y[23]<<10|y[22]>>>22,Ze=y[33]<<13|y[32]>>>19,Gr=y[32]<<13|y[33]>>>19,Ai=y[42]<<2|y[43]>>>30,Ei=y[43]<<2|y[42]>>>30,At=y[5]<<30|y[4]>>>2,Li=y[4]<<30|y[5]>>>2,it=y[14]<<6|y[15]>>>26,vi=y[15]<<6|y[14]>>>26,$e=y[25]<<11|y[24]>>>21,qi=y[24]<<11|y[25]>>>21,yt=y[34]<<15|y[35]>>>17,wt=y[35]<<15|y[34]>>>17,Xe=y[45]<<29|y[44]>>>3,ht=y[44]<<29|y[45]>>>3,Qe=y[6]<<28|y[7]>>>4,Jr=y[7]<<28|y[6]>>>4,Et=y[17]<<23|y[16]>>>9,st=y[16]<<23|y[17]>>>9,ft=y[26]<<25|y[27]>>>7,dt=y[27]<<25|y[26]>>>7,Ke=y[36]<<21|y[37]>>>11,ut=y[37]<<21|y[36]>>>11,zi=y[47]<<24|y[46]>>>8,_t=y[46]<<24|y[47]>>>8,gt=y[8]<<27|y[9]>>>5,mt=y[9]<<27|y[8]>>>5,Ge=y[18]<<20|y[19]>>>12,Ye=y[19]<<20|y[18]>>>12,yi=y[29]<<7|y[28]>>>25,wi=y[28]<<7|y[29]>>>25,ki=y[38]<<8|y[39]>>>24,pt=y[39]<<8|y[38]>>>24,br=y[48]<<14|y[49]>>>18,Ue=y[49]<<14|y[48]>>>18,y[0]=ct^~jt&$e,y[1]=ze^~Le&qi,y[10]=Qe^~Ge&Qr,y[11]=Jr^~Ye&We,y[20]=Bi^~it&ft,y[21]=lt^~vi&dt,y[30]=gt^~Yr&et,y[31]=mt^~vt&ji,y[40]=At^~Et&yi,y[41]=Li^~st&wi,y[2]=jt^~$e&Ke,y[3]=Le^~qi&ut,y[12]=Ge^~Qr&Ze,y[13]=Ye^~We&Gr,y[22]=it^~ft&ki,y[23]=vi^~dt&pt,y[32]=Yr^~et&yt,y[33]=vt^~ji&wt,y[42]=Et^~yi&bi,y[43]=st^~wi&_i,y[4]=$e^~Ke&br,y[5]=qi^~ut&Ue,y[14]=Qr^~Ze&Xe,y[15]=We^~Gr&ht,y[24]=ft^~ki&nt,y[25]=dt^~pt&Ui,y[34]=et^~yt&zi,y[35]=ji^~wt&_t,y[44]=yi^~bi&Ai,y[45]=wi^~_i&Ei,y[6]=Ke^~br&ct,y[7]=ut^~Ue&ze,y[16]=Ze^~Xe&Qe,y[17]=Gr^~ht&Jr,y[26]=ki^~nt&Bi,y[27]=pt^~Ui&lt,y[36]=yt^~zi&gt,y[37]=wt^~_t&mt,y[46]=bi^~Ai&At,y[47]=_i^~Ei&Li,y[8]=br^~ct&jt,y[9]=Ue^~ze&Le,y[18]=Xe^~Qe&Ge,y[19]=ht^~Jr&Ye,y[28]=nt^~Bi&it,y[29]=Ui^~lt&vi,y[38]=zi^~gt&Yr,y[39]=_t^~mt&vt,y[48]=Ai^~At&Et,y[49]=Ei^~Li&st,y[0]^=L[Q],y[1]^=L[Q+1]};if(m)r.exports=g;else for(S=0;S<A.length;++S)a[A[S]]=g[A[S]]})()})(_h);var og=_h.exports;const ag="logger/5.7.0";let Ah=!1,Eh=!1;const xo={debug:1,default:2,info:2,warning:3,error:4,off:5};let Ih=xo.default,La=null;function cg(){try{const r=[];if(["NFD","NFC","NFKD","NFKC"].forEach(e=>{try{if("test".normalize(e)!=="test")throw new Error("bad normalize")}catch{r.push(e)}}),r.length)throw new Error("missing "+r.join(", "));if("\xE9".normalize("NFD")!=="e\u0301")throw new Error("broken implementation")}catch(r){return r.message}return null}const Sh=cg();var Ka;(function(r){r.DEBUG="DEBUG",r.INFO="INFO",r.WARNING="WARNING",r.ERROR="ERROR",r.OFF="OFF"})(Ka||(Ka={}));var Lr;(function(r){r.UNKNOWN_ERROR="UNKNOWN_ERROR",r.NOT_IMPLEMENTED="NOT_IMPLEMENTED",r.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",r.NETWORK_ERROR="NETWORK_ERROR",r.SERVER_ERROR="SERVER_ERROR",r.TIMEOUT="TIMEOUT",r.BUFFER_OVERRUN="BUFFER_OVERRUN",r.NUMERIC_FAULT="NUMERIC_FAULT",r.MISSING_NEW="MISSING_NEW",r.INVALID_ARGUMENT="INVALID_ARGUMENT",r.MISSING_ARGUMENT="MISSING_ARGUMENT",r.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",r.CALL_EXCEPTION="CALL_EXCEPTION",r.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",r.NONCE_EXPIRED="NONCE_EXPIRED",r.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",r.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",r.TRANSACTION_REPLACED="TRANSACTION_REPLACED",r.ACTION_REJECTED="ACTION_REJECTED"})(Lr||(Lr={}));const xh="0123456789abcdef";class xe{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,t){const s=e.toLowerCase();xo[s]==null&&this.throwArgumentError("invalid log level name","logLevel",e),!(Ih>xo[s])&&console.log.apply(console,t)}debug(...e){this._log(xe.levels.DEBUG,e)}info(...e){this._log(xe.levels.INFO,e)}warn(...e){this._log(xe.levels.WARNING,e)}makeError(e,t,s){if(Eh)return this.makeError("censored error",t,{});t||(t=xe.errors.UNKNOWN_ERROR),s||(s={});const a=[];Object.keys(s).forEach(b=>{const w=s[b];try{if(w instanceof Uint8Array){let P="";for(let R=0;R<w.length;R++)P+=xh[w[R]>>4],P+=xh[w[R]&15];a.push(b+"=Uint8Array(0x"+P+")")}else a.push(b+"="+JSON.stringify(w))}catch{a.push(b+"="+JSON.stringify(s[b].toString()))}}),a.push(`code=${t}`),a.push(`version=${this.version}`);const u=e;let f="";switch(t){case Lr.NUMERIC_FAULT:{f="NUMERIC_FAULT";const b=e;switch(b){case"overflow":case"underflow":case"division-by-zero":f+="-"+b;break;case"negative-power":case"negative-width":f+="-unsupported";break;case"unbound-bitwise-result":f+="-unbound-result";break}break}case Lr.CALL_EXCEPTION:case Lr.INSUFFICIENT_FUNDS:case Lr.MISSING_NEW:case Lr.NONCE_EXPIRED:case Lr.REPLACEMENT_UNDERPRICED:case Lr.TRANSACTION_REPLACED:case Lr.UNPREDICTABLE_GAS_LIMIT:f=t;break}f&&(e+=" [ See: https://links.ethers.org/v5-errors-"+f+" ]"),a.length&&(e+=" ("+a.join(", ")+")");const m=new Error(e);return m.reason=u,m.code=t,Object.keys(s).forEach(function(b){m[b]=s[b]}),m}throwError(e,t,s){throw this.makeError(e,t,s)}throwArgumentError(e,t,s){return this.throwError(e,xe.errors.INVALID_ARGUMENT,{argument:t,value:s})}assert(e,t,s,a){e||this.throwError(t,s,a)}assertArgument(e,t,s,a){e||this.throwArgumentError(t,s,a)}checkNormalize(e){Sh&&this.throwError("platform missing String.prototype.normalize",xe.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:Sh})}checkSafeUint53(e,t){typeof e=="number"&&(t==null&&(t="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(t,xe.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(t,xe.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,t,s){s?s=": "+s:s="",e<t&&this.throwError("missing argument"+s,xe.errors.MISSING_ARGUMENT,{count:e,expectedCount:t}),e>t&&this.throwError("too many arguments"+s,xe.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:t})}checkNew(e,t){(e===Object||e==null)&&this.throwError("missing new",xe.errors.MISSING_NEW,{name:t.name})}checkAbstract(e,t){e===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",xe.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):(e===Object||e==null)&&this.throwError("missing new",xe.errors.MISSING_NEW,{name:t.name})}static globalLogger(){return La||(La=new xe(ag)),La}static setCensorship(e,t){if(!e&&t&&this.globalLogger().throwError("cannot permanently disable censorship",xe.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),Ah){if(!e)return;this.globalLogger().throwError("error censorship permanent",xe.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}Eh=!!e,Ah=!!t}static setLogLevel(e){const t=xo[e.toLowerCase()];if(t==null){xe.globalLogger().warn("invalid log level - "+e);return}Ih=t}static from(e){return new xe(e)}}xe.errors=Lr,xe.levels=Ka;const ug="bytes/5.7.0",Dt=new xe(ug);function Ph(r){return!!r.toHexString}function Jn(r){return r.slice||(r.slice=function(){const e=Array.prototype.slice.call(arguments);return Jn(new Uint8Array(Array.prototype.slice.apply(r,e)))}),r}function hg(r){return yr(r)&&!(r.length%2)||Qn(r)}function Mh(r){return typeof r=="number"&&r==r&&r%1===0}function Qn(r){if(r==null)return!1;if(r.constructor===Uint8Array)return!0;if(typeof r=="string"||!Mh(r.length)||r.length<0)return!1;for(let e=0;e<r.length;e++){const t=r[e];if(!Mh(t)||t<0||t>=256)return!1}return!0}function Ct(r,e){if(e||(e={}),typeof r=="number"){Dt.checkSafeUint53(r,"invalid arrayify value");const t=[];for(;r;)t.unshift(r&255),r=parseInt(String(r/256));return t.length===0&&t.push(0),Jn(new Uint8Array(t))}if(e.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),Ph(r)&&(r=r.toHexString()),yr(r)){let t=r.substring(2);t.length%2&&(e.hexPad==="left"?t="0"+t:e.hexPad==="right"?t+="0":Dt.throwArgumentError("hex data is odd-length","value",r));const s=[];for(let a=0;a<t.length;a+=2)s.push(parseInt(t.substring(a,a+2),16));return Jn(new Uint8Array(s))}return Qn(r)?Jn(new Uint8Array(r)):Dt.throwArgumentError("invalid arrayify value","value",r)}function lg(r){const e=r.map(a=>Ct(a)),t=e.reduce((a,u)=>a+u.length,0),s=new Uint8Array(t);return e.reduce((a,u)=>(s.set(u,a),a+u.length),0),Jn(s)}function fg(r,e){r=Ct(r),r.length>e&&Dt.throwArgumentError("value out of range","value",arguments[0]);const t=new Uint8Array(e);return t.set(r,e-r.length),Jn(t)}function yr(r,e){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||e&&r.length!==2+2*e)}const Ha="0123456789abcdef";function rr(r,e){if(e||(e={}),typeof r=="number"){Dt.checkSafeUint53(r,"invalid hexlify value");let t="";for(;r;)t=Ha[r&15]+t,r=Math.floor(r/16);return t.length?(t.length%2&&(t="0"+t),"0x"+t):"0x00"}if(typeof r=="bigint")return r=r.toString(16),r.length%2?"0x0"+r:"0x"+r;if(e.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),Ph(r))return r.toHexString();if(yr(r))return r.length%2&&(e.hexPad==="left"?r="0x0"+r.substring(2):e.hexPad==="right"?r+="0":Dt.throwArgumentError("hex data is odd-length","value",r)),r.toLowerCase();if(Qn(r)){let t="0x";for(let s=0;s<r.length;s++){let a=r[s];t+=Ha[(a&240)>>4]+Ha[a&15]}return t}return Dt.throwArgumentError("invalid hexlify value","value",r)}function dg(r){if(typeof r!="string")r=rr(r);else if(!yr(r)||r.length%2)return null;return(r.length-2)/2}function Rh(r,e,t){return typeof r!="string"?r=rr(r):(!yr(r)||r.length%2)&&Dt.throwArgumentError("invalid hexData","value",r),e=2+2*e,t!=null?"0x"+r.substring(e,2+2*t):"0x"+r.substring(e)}function ri(r,e){for(typeof r!="string"?r=rr(r):yr(r)||Dt.throwArgumentError("invalid hex string","value",r),r.length>2*e+2&&Dt.throwArgumentError("value out of range","value",arguments[1]);r.length<2*e+2;)r="0x0"+r.substring(2);return r}function Nh(r){const e={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(hg(r)){let t=Ct(r);t.length===64?(e.v=27+(t[32]>>7),t[32]&=127,e.r=rr(t.slice(0,32)),e.s=rr(t.slice(32,64))):t.length===65?(e.r=rr(t.slice(0,32)),e.s=rr(t.slice(32,64)),e.v=t[64]):Dt.throwArgumentError("invalid signature string","signature",r),e.v<27&&(e.v===0||e.v===1?e.v+=27:Dt.throwArgumentError("signature invalid v byte","signature",r)),e.recoveryParam=1-e.v%2,e.recoveryParam&&(t[32]|=128),e._vs=rr(t.slice(32,64))}else{if(e.r=r.r,e.s=r.s,e.v=r.v,e.recoveryParam=r.recoveryParam,e._vs=r._vs,e._vs!=null){const a=fg(Ct(e._vs),32);e._vs=rr(a);const u=a[0]>=128?1:0;e.recoveryParam==null?e.recoveryParam=u:e.recoveryParam!==u&&Dt.throwArgumentError("signature recoveryParam mismatch _vs","signature",r),a[0]&=127;const f=rr(a);e.s==null?e.s=f:e.s!==f&&Dt.throwArgumentError("signature v mismatch _vs","signature",r)}if(e.recoveryParam==null)e.v==null?Dt.throwArgumentError("signature missing v and recoveryParam","signature",r):e.v===0||e.v===1?e.recoveryParam=e.v:e.recoveryParam=1-e.v%2;else if(e.v==null)e.v=27+e.recoveryParam;else{const a=e.v===0||e.v===1?e.v:1-e.v%2;e.recoveryParam!==a&&Dt.throwArgumentError("signature recoveryParam mismatch v","signature",r)}e.r==null||!yr(e.r)?Dt.throwArgumentError("signature missing or invalid r","signature",r):e.r=ri(e.r,32),e.s==null||!yr(e.s)?Dt.throwArgumentError("signature missing or invalid s","signature",r):e.s=ri(e.s,32);const t=Ct(e.s);t[0]>=128&&Dt.throwArgumentError("signature s out of range","signature",r),e.recoveryParam&&(t[0]|=128);const s=rr(t);e._vs&&(yr(e._vs)||Dt.throwArgumentError("signature invalid _vs","signature",r),e._vs=ri(e._vs,32)),e._vs==null?e._vs=s:e._vs!==s&&Dt.throwArgumentError("signature _vs mismatch v and s","signature",r)}return e.yParityAndS=e._vs,e.compact=e.r+e.yParityAndS.substring(2),e}function Va(r){return"0x"+og.keccak_256(Ct(r))}var Ch={exports:{}},pg={},gg=Object.freeze({__proto__:null,default:pg}),mg=sg(gg);(function(r){(function(e,t){function s(l,g){if(!l)throw new Error(g||"Assertion failed")}function a(l,g){l.super_=g;var A=function(){};A.prototype=g.prototype,l.prototype=new A,l.prototype.constructor=l}function u(l,g,A){if(u.isBN(l))return l;this.negative=0,this.words=null,this.length=0,this.red=null,l!==null&&((g==="le"||g==="be")&&(A=g,g=10),this._init(l||0,g||10,A||"be"))}typeof e=="object"?e.exports=u:t.BN=u,u.BN=u,u.wordSize=26;var f;try{typeof window<"u"&&typeof window.Buffer<"u"?f=window.Buffer:f=mg.Buffer}catch{}u.isBN=function(l){return l instanceof u?!0:l!==null&&typeof l=="object"&&l.constructor.wordSize===u.wordSize&&Array.isArray(l.words)},u.max=function(l,g){return l.cmp(g)>0?l:g},u.min=function(l,g){return l.cmp(g)<0?l:g},u.prototype._init=function(l,g,A){if(typeof l=="number")return this._initNumber(l,g,A);if(typeof l=="object")return this._initArray(l,g,A);g==="hex"&&(g=16),s(g===(g|0)&&g>=2&&g<=36),l=l.toString().replace(/\s+/g,"");var S=0;l[0]==="-"&&(S++,this.negative=1),S<l.length&&(g===16?this._parseHex(l,S,A):(this._parseBase(l,g,S),A==="le"&&this._initArray(this.toArray(),g,A)))},u.prototype._initNumber=function(l,g,A){l<0&&(this.negative=1,l=-l),l<67108864?(this.words=[l&67108863],this.length=1):l<4503599627370496?(this.words=[l&67108863,l/67108864&67108863],this.length=2):(s(l<9007199254740992),this.words=[l&67108863,l/67108864&67108863,1],this.length=3),A==="le"&&this._initArray(this.toArray(),g,A)},u.prototype._initArray=function(l,g,A){if(s(typeof l.length=="number"),l.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(l.length/3),this.words=new Array(this.length);for(var S=0;S<this.length;S++)this.words[S]=0;var M,O,q=0;if(A==="be")for(S=l.length-1,M=0;S>=0;S-=3)O=l[S]|l[S-1]<<8|l[S-2]<<16,this.words[M]|=O<<q&67108863,this.words[M+1]=O>>>26-q&67108863,q+=24,q>=26&&(q-=26,M++);else if(A==="le")for(S=0,M=0;S<l.length;S+=3)O=l[S]|l[S+1]<<8|l[S+2]<<16,this.words[M]|=O<<q&67108863,this.words[M+1]=O>>>26-q&67108863,q+=24,q>=26&&(q-=26,M++);return this._strip()};function m(l,g){var A=l.charCodeAt(g);if(A>=48&&A<=57)return A-48;if(A>=65&&A<=70)return A-55;if(A>=97&&A<=102)return A-87;s(!1,"Invalid character in "+l)}function b(l,g,A){var S=m(l,A);return A-1>=g&&(S|=m(l,A-1)<<4),S}u.prototype._parseHex=function(l,g,A){this.length=Math.ceil((l.length-g)/6),this.words=new Array(this.length);for(var S=0;S<this.length;S++)this.words[S]=0;var M=0,O=0,q;if(A==="be")for(S=l.length-1;S>=g;S-=2)q=b(l,g,S)<<M,this.words[O]|=q&67108863,M>=18?(M-=18,O+=1,this.words[O]|=q>>>26):M+=8;else{var x=l.length-g;for(S=x%2===0?g+1:g;S<l.length;S+=2)q=b(l,g,S)<<M,this.words[O]|=q&67108863,M>=18?(M-=18,O+=1,this.words[O]|=q>>>26):M+=8}this._strip()};function w(l,g,A,S){for(var M=0,O=0,q=Math.min(l.length,A),x=g;x<q;x++){var p=l.charCodeAt(x)-48;M*=S,p>=49?O=p-49+10:p>=17?O=p-17+10:O=p,s(p>=0&&O<S,"Invalid character"),M+=O}return M}u.prototype._parseBase=function(l,g,A){this.words=[0],this.length=1;for(var S=0,M=1;M<=67108863;M*=g)S++;S--,M=M/g|0;for(var O=l.length-A,q=O%S,x=Math.min(O,O-q)+A,p=0,I=A;I<x;I+=S)p=w(l,I,I+S,g),this.imuln(M),this.words[0]+p<67108864?this.words[0]+=p:this._iaddn(p);if(q!==0){var ge=1;for(p=w(l,I,l.length,g),I=0;I<q;I++)ge*=g;this.imuln(ge),this.words[0]+p<67108864?this.words[0]+=p:this._iaddn(p)}this._strip()},u.prototype.copy=function(l){l.words=new Array(this.length);for(var g=0;g<this.length;g++)l.words[g]=this.words[g];l.length=this.length,l.negative=this.negative,l.red=this.red};function P(l,g){l.words=g.words,l.length=g.length,l.negative=g.negative,l.red=g.red}if(u.prototype._move=function(l){P(l,this)},u.prototype.clone=function(){var l=new u(null);return this.copy(l),l},u.prototype._expand=function(l){for(;this.length<l;)this.words[this.length++]=0;return this},u.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},u.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{u.prototype[Symbol.for("nodejs.util.inspect.custom")]=R}catch{u.prototype.inspect=R}else u.prototype.inspect=R;function R(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var F=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],B=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],k=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];u.prototype.toString=function(l,g){l=l||10,g=g|0||1;var A;if(l===16||l==="hex"){A="";for(var S=0,M=0,O=0;O<this.length;O++){var q=this.words[O],x=((q<<S|M)&16777215).toString(16);M=q>>>24-S&16777215,S+=2,S>=26&&(S-=26,O--),M!==0||O!==this.length-1?A=F[6-x.length]+x+A:A=x+A}for(M!==0&&(A=M.toString(16)+A);A.length%g!==0;)A="0"+A;return this.negative!==0&&(A="-"+A),A}if(l===(l|0)&&l>=2&&l<=36){var p=B[l],I=k[l];A="";var ge=this.clone();for(ge.negative=0;!ge.isZero();){var le=ge.modrn(I).toString(l);ge=ge.idivn(I),ge.isZero()?A=le+A:A=F[p-le.length]+le+A}for(this.isZero()&&(A="0"+A);A.length%g!==0;)A="0"+A;return this.negative!==0&&(A="-"+A),A}s(!1,"Base should be between 2 and 36")},u.prototype.toNumber=function(){var l=this.words[0];return this.length===2?l+=this.words[1]*67108864:this.length===3&&this.words[2]===1?l+=4503599627370496+this.words[1]*67108864:this.length>2&&s(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-l:l},u.prototype.toJSON=function(){return this.toString(16,2)},f&&(u.prototype.toBuffer=function(l,g){return this.toArrayLike(f,l,g)}),u.prototype.toArray=function(l,g){return this.toArrayLike(Array,l,g)};var L=function(l,g){return l.allocUnsafe?l.allocUnsafe(g):new l(g)};u.prototype.toArrayLike=function(l,g,A){this._strip();var S=this.byteLength(),M=A||Math.max(1,S);s(S<=M,"byte array longer than desired length"),s(M>0,"Requested array length <= 0");var O=L(l,M),q=g==="le"?"LE":"BE";return this["_toArrayLike"+q](O,S),O},u.prototype._toArrayLikeLE=function(l,g){for(var A=0,S=0,M=0,O=0;M<this.length;M++){var q=this.words[M]<<O|S;l[A++]=q&255,A<l.length&&(l[A++]=q>>8&255),A<l.length&&(l[A++]=q>>16&255),O===6?(A<l.length&&(l[A++]=q>>24&255),S=0,O=0):(S=q>>>24,O+=2)}if(A<l.length)for(l[A++]=S;A<l.length;)l[A++]=0},u.prototype._toArrayLikeBE=function(l,g){for(var A=l.length-1,S=0,M=0,O=0;M<this.length;M++){var q=this.words[M]<<O|S;l[A--]=q&255,A>=0&&(l[A--]=q>>8&255),A>=0&&(l[A--]=q>>16&255),O===6?(A>=0&&(l[A--]=q>>24&255),S=0,O=0):(S=q>>>24,O+=2)}if(A>=0)for(l[A--]=S;A>=0;)l[A--]=0},Math.clz32?u.prototype._countBits=function(l){return 32-Math.clz32(l)}:u.prototype._countBits=function(l){var g=l,A=0;return g>=4096&&(A+=13,g>>>=13),g>=64&&(A+=7,g>>>=7),g>=8&&(A+=4,g>>>=4),g>=2&&(A+=2,g>>>=2),A+g},u.prototype._zeroBits=function(l){if(l===0)return 26;var g=l,A=0;return g&8191||(A+=13,g>>>=13),g&127||(A+=7,g>>>=7),g&15||(A+=4,g>>>=4),g&3||(A+=2,g>>>=2),g&1||A++,A},u.prototype.bitLength=function(){var l=this.words[this.length-1],g=this._countBits(l);return(this.length-1)*26+g};function H(l){for(var g=new Array(l.bitLength()),A=0;A<g.length;A++){var S=A/26|0,M=A%26;g[A]=l.words[S]>>>M&1}return g}u.prototype.zeroBits=function(){if(this.isZero())return 0;for(var l=0,g=0;g<this.length;g++){var A=this._zeroBits(this.words[g]);if(l+=A,A!==26)break}return l},u.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},u.prototype.toTwos=function(l){return this.negative!==0?this.abs().inotn(l).iaddn(1):this.clone()},u.prototype.fromTwos=function(l){return this.testn(l-1)?this.notn(l).iaddn(1).ineg():this.clone()},u.prototype.isNeg=function(){return this.negative!==0},u.prototype.neg=function(){return this.clone().ineg()},u.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},u.prototype.iuor=function(l){for(;this.length<l.length;)this.words[this.length++]=0;for(var g=0;g<l.length;g++)this.words[g]=this.words[g]|l.words[g];return this._strip()},u.prototype.ior=function(l){return s((this.negative|l.negative)===0),this.iuor(l)},u.prototype.or=function(l){return this.length>l.length?this.clone().ior(l):l.clone().ior(this)},u.prototype.uor=function(l){return this.length>l.length?this.clone().iuor(l):l.clone().iuor(this)},u.prototype.iuand=function(l){var g;this.length>l.length?g=l:g=this;for(var A=0;A<g.length;A++)this.words[A]=this.words[A]&l.words[A];return this.length=g.length,this._strip()},u.prototype.iand=function(l){return s((this.negative|l.negative)===0),this.iuand(l)},u.prototype.and=function(l){return this.length>l.length?this.clone().iand(l):l.clone().iand(this)},u.prototype.uand=function(l){return this.length>l.length?this.clone().iuand(l):l.clone().iuand(this)},u.prototype.iuxor=function(l){var g,A;this.length>l.length?(g=this,A=l):(g=l,A=this);for(var S=0;S<A.length;S++)this.words[S]=g.words[S]^A.words[S];if(this!==g)for(;S<g.length;S++)this.words[S]=g.words[S];return this.length=g.length,this._strip()},u.prototype.ixor=function(l){return s((this.negative|l.negative)===0),this.iuxor(l)},u.prototype.xor=function(l){return this.length>l.length?this.clone().ixor(l):l.clone().ixor(this)},u.prototype.uxor=function(l){return this.length>l.length?this.clone().iuxor(l):l.clone().iuxor(this)},u.prototype.inotn=function(l){s(typeof l=="number"&&l>=0);var g=Math.ceil(l/26)|0,A=l%26;this._expand(g),A>0&&g--;for(var S=0;S<g;S++)this.words[S]=~this.words[S]&67108863;return A>0&&(this.words[S]=~this.words[S]&67108863>>26-A),this._strip()},u.prototype.notn=function(l){return this.clone().inotn(l)},u.prototype.setn=function(l,g){s(typeof l=="number"&&l>=0);var A=l/26|0,S=l%26;return this._expand(A+1),g?this.words[A]=this.words[A]|1<<S:this.words[A]=this.words[A]&~(1<<S),this._strip()},u.prototype.iadd=function(l){var g;if(this.negative!==0&&l.negative===0)return this.negative=0,g=this.isub(l),this.negative^=1,this._normSign();if(this.negative===0&&l.negative!==0)return l.negative=0,g=this.isub(l),l.negative=1,g._normSign();var A,S;this.length>l.length?(A=this,S=l):(A=l,S=this);for(var M=0,O=0;O<S.length;O++)g=(A.words[O]|0)+(S.words[O]|0)+M,this.words[O]=g&67108863,M=g>>>26;for(;M!==0&&O<A.length;O++)g=(A.words[O]|0)+M,this.words[O]=g&67108863,M=g>>>26;if(this.length=A.length,M!==0)this.words[this.length]=M,this.length++;else if(A!==this)for(;O<A.length;O++)this.words[O]=A.words[O];return this},u.prototype.add=function(l){var g;return l.negative!==0&&this.negative===0?(l.negative=0,g=this.sub(l),l.negative^=1,g):l.negative===0&&this.negative!==0?(this.negative=0,g=l.sub(this),this.negative=1,g):this.length>l.length?this.clone().iadd(l):l.clone().iadd(this)},u.prototype.isub=function(l){if(l.negative!==0){l.negative=0;var g=this.iadd(l);return l.negative=1,g._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(l),this.negative=1,this._normSign();var A=this.cmp(l);if(A===0)return this.negative=0,this.length=1,this.words[0]=0,this;var S,M;A>0?(S=this,M=l):(S=l,M=this);for(var O=0,q=0;q<M.length;q++)g=(S.words[q]|0)-(M.words[q]|0)+O,O=g>>26,this.words[q]=g&67108863;for(;O!==0&&q<S.length;q++)g=(S.words[q]|0)+O,O=g>>26,this.words[q]=g&67108863;if(O===0&&q<S.length&&S!==this)for(;q<S.length;q++)this.words[q]=S.words[q];return this.length=Math.max(this.length,q),S!==this&&(this.negative=1),this._strip()},u.prototype.sub=function(l){return this.clone().isub(l)};function ee(l,g,A){A.negative=g.negative^l.negative;var S=l.length+g.length|0;A.length=S,S=S-1|0;var M=l.words[0]|0,O=g.words[0]|0,q=M*O,x=q&67108863,p=q/67108864|0;A.words[0]=x;for(var I=1;I<S;I++){for(var ge=p>>>26,le=p&67108863,y=Math.min(I,g.length-1),K=Math.max(0,I-l.length+1);K<=y;K++){var j=I-K|0;M=l.words[j]|0,O=g.words[K]|0,q=M*O+le,ge+=q/67108864|0,le=q&67108863}A.words[I]=le|0,p=ge|0}return p!==0?A.words[I]=p|0:A.length--,A._strip()}var pe=function(l,g,A){var S=l.words,M=g.words,O=A.words,q=0,x,p,I,ge=S[0]|0,le=ge&8191,y=ge>>>13,K=S[1]|0,j=K&8191,Q=K>>>13,ne=S[2]|0,te=ne&8191,ie=ne>>>13,fe=S[3]|0,Ae=fe&8191,W=fe>>>13,je=S[4]|0,at=je&8191,Be=je>>>13,mi=S[5]|0,ct=mi&8191,ze=mi>>>13,jt=S[6]|0,Le=jt&8191,$e=jt>>>13,qi=S[7]|0,Ke=qi&8191,ut=qi>>>13,br=S[8]|0,Ue=br&8191,Qe=br>>>13,Jr=S[9]|0,Ge=Jr&8191,Ye=Jr>>>13,Qr=M[0]|0,We=Qr&8191,Ze=Qr>>>13,Gr=M[1]|0,Xe=Gr&8191,ht=Gr>>>13,Bi=M[2]|0,lt=Bi&8191,it=Bi>>>13,vi=M[3]|0,ft=vi&8191,dt=vi>>>13,ki=M[4]|0,pt=ki&8191,nt=ki>>>13,Ui=M[5]|0,gt=Ui&8191,mt=Ui>>>13,Yr=M[6]|0,vt=Yr&8191,et=Yr>>>13,ji=M[7]|0,yt=ji&8191,wt=ji>>>13,zi=M[8]|0,_t=zi&8191,At=zi>>>13,Li=M[9]|0,Et=Li&8191,st=Li>>>13;A.negative=l.negative^g.negative,A.length=19,x=Math.imul(le,We),p=Math.imul(le,Ze),p=p+Math.imul(y,We)|0,I=Math.imul(y,Ze);var yi=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(yi>>>26)|0,yi&=67108863,x=Math.imul(j,We),p=Math.imul(j,Ze),p=p+Math.imul(Q,We)|0,I=Math.imul(Q,Ze),x=x+Math.imul(le,Xe)|0,p=p+Math.imul(le,ht)|0,p=p+Math.imul(y,Xe)|0,I=I+Math.imul(y,ht)|0;var wi=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(wi>>>26)|0,wi&=67108863,x=Math.imul(te,We),p=Math.imul(te,Ze),p=p+Math.imul(ie,We)|0,I=Math.imul(ie,Ze),x=x+Math.imul(j,Xe)|0,p=p+Math.imul(j,ht)|0,p=p+Math.imul(Q,Xe)|0,I=I+Math.imul(Q,ht)|0,x=x+Math.imul(le,lt)|0,p=p+Math.imul(le,it)|0,p=p+Math.imul(y,lt)|0,I=I+Math.imul(y,it)|0;var bi=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(bi>>>26)|0,bi&=67108863,x=Math.imul(Ae,We),p=Math.imul(Ae,Ze),p=p+Math.imul(W,We)|0,I=Math.imul(W,Ze),x=x+Math.imul(te,Xe)|0,p=p+Math.imul(te,ht)|0,p=p+Math.imul(ie,Xe)|0,I=I+Math.imul(ie,ht)|0,x=x+Math.imul(j,lt)|0,p=p+Math.imul(j,it)|0,p=p+Math.imul(Q,lt)|0,I=I+Math.imul(Q,it)|0,x=x+Math.imul(le,ft)|0,p=p+Math.imul(le,dt)|0,p=p+Math.imul(y,ft)|0,I=I+Math.imul(y,dt)|0;var _i=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(_i>>>26)|0,_i&=67108863,x=Math.imul(at,We),p=Math.imul(at,Ze),p=p+Math.imul(Be,We)|0,I=Math.imul(Be,Ze),x=x+Math.imul(Ae,Xe)|0,p=p+Math.imul(Ae,ht)|0,p=p+Math.imul(W,Xe)|0,I=I+Math.imul(W,ht)|0,x=x+Math.imul(te,lt)|0,p=p+Math.imul(te,it)|0,p=p+Math.imul(ie,lt)|0,I=I+Math.imul(ie,it)|0,x=x+Math.imul(j,ft)|0,p=p+Math.imul(j,dt)|0,p=p+Math.imul(Q,ft)|0,I=I+Math.imul(Q,dt)|0,x=x+Math.imul(le,pt)|0,p=p+Math.imul(le,nt)|0,p=p+Math.imul(y,pt)|0,I=I+Math.imul(y,nt)|0;var Ai=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(Ai>>>26)|0,Ai&=67108863,x=Math.imul(ct,We),p=Math.imul(ct,Ze),p=p+Math.imul(ze,We)|0,I=Math.imul(ze,Ze),x=x+Math.imul(at,Xe)|0,p=p+Math.imul(at,ht)|0,p=p+Math.imul(Be,Xe)|0,I=I+Math.imul(Be,ht)|0,x=x+Math.imul(Ae,lt)|0,p=p+Math.imul(Ae,it)|0,p=p+Math.imul(W,lt)|0,I=I+Math.imul(W,it)|0,x=x+Math.imul(te,ft)|0,p=p+Math.imul(te,dt)|0,p=p+Math.imul(ie,ft)|0,I=I+Math.imul(ie,dt)|0,x=x+Math.imul(j,pt)|0,p=p+Math.imul(j,nt)|0,p=p+Math.imul(Q,pt)|0,I=I+Math.imul(Q,nt)|0,x=x+Math.imul(le,gt)|0,p=p+Math.imul(le,mt)|0,p=p+Math.imul(y,gt)|0,I=I+Math.imul(y,mt)|0;var Ei=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(Ei>>>26)|0,Ei&=67108863,x=Math.imul(Le,We),p=Math.imul(Le,Ze),p=p+Math.imul($e,We)|0,I=Math.imul($e,Ze),x=x+Math.imul(ct,Xe)|0,p=p+Math.imul(ct,ht)|0,p=p+Math.imul(ze,Xe)|0,I=I+Math.imul(ze,ht)|0,x=x+Math.imul(at,lt)|0,p=p+Math.imul(at,it)|0,p=p+Math.imul(Be,lt)|0,I=I+Math.imul(Be,it)|0,x=x+Math.imul(Ae,ft)|0,p=p+Math.imul(Ae,dt)|0,p=p+Math.imul(W,ft)|0,I=I+Math.imul(W,dt)|0,x=x+Math.imul(te,pt)|0,p=p+Math.imul(te,nt)|0,p=p+Math.imul(ie,pt)|0,I=I+Math.imul(ie,nt)|0,x=x+Math.imul(j,gt)|0,p=p+Math.imul(j,mt)|0,p=p+Math.imul(Q,gt)|0,I=I+Math.imul(Q,mt)|0,x=x+Math.imul(le,vt)|0,p=p+Math.imul(le,et)|0,p=p+Math.imul(y,vt)|0,I=I+Math.imul(y,et)|0;var on=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(on>>>26)|0,on&=67108863,x=Math.imul(Ke,We),p=Math.imul(Ke,Ze),p=p+Math.imul(ut,We)|0,I=Math.imul(ut,Ze),x=x+Math.imul(Le,Xe)|0,p=p+Math.imul(Le,ht)|0,p=p+Math.imul($e,Xe)|0,I=I+Math.imul($e,ht)|0,x=x+Math.imul(ct,lt)|0,p=p+Math.imul(ct,it)|0,p=p+Math.imul(ze,lt)|0,I=I+Math.imul(ze,it)|0,x=x+Math.imul(at,ft)|0,p=p+Math.imul(at,dt)|0,p=p+Math.imul(Be,ft)|0,I=I+Math.imul(Be,dt)|0,x=x+Math.imul(Ae,pt)|0,p=p+Math.imul(Ae,nt)|0,p=p+Math.imul(W,pt)|0,I=I+Math.imul(W,nt)|0,x=x+Math.imul(te,gt)|0,p=p+Math.imul(te,mt)|0,p=p+Math.imul(ie,gt)|0,I=I+Math.imul(ie,mt)|0,x=x+Math.imul(j,vt)|0,p=p+Math.imul(j,et)|0,p=p+Math.imul(Q,vt)|0,I=I+Math.imul(Q,et)|0,x=x+Math.imul(le,yt)|0,p=p+Math.imul(le,wt)|0,p=p+Math.imul(y,yt)|0,I=I+Math.imul(y,wt)|0;var Js=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(Js>>>26)|0,Js&=67108863,x=Math.imul(Ue,We),p=Math.imul(Ue,Ze),p=p+Math.imul(Qe,We)|0,I=Math.imul(Qe,Ze),x=x+Math.imul(Ke,Xe)|0,p=p+Math.imul(Ke,ht)|0,p=p+Math.imul(ut,Xe)|0,I=I+Math.imul(ut,ht)|0,x=x+Math.imul(Le,lt)|0,p=p+Math.imul(Le,it)|0,p=p+Math.imul($e,lt)|0,I=I+Math.imul($e,it)|0,x=x+Math.imul(ct,ft)|0,p=p+Math.imul(ct,dt)|0,p=p+Math.imul(ze,ft)|0,I=I+Math.imul(ze,dt)|0,x=x+Math.imul(at,pt)|0,p=p+Math.imul(at,nt)|0,p=p+Math.imul(Be,pt)|0,I=I+Math.imul(Be,nt)|0,x=x+Math.imul(Ae,gt)|0,p=p+Math.imul(Ae,mt)|0,p=p+Math.imul(W,gt)|0,I=I+Math.imul(W,mt)|0,x=x+Math.imul(te,vt)|0,p=p+Math.imul(te,et)|0,p=p+Math.imul(ie,vt)|0,I=I+Math.imul(ie,et)|0,x=x+Math.imul(j,yt)|0,p=p+Math.imul(j,wt)|0,p=p+Math.imul(Q,yt)|0,I=I+Math.imul(Q,wt)|0,x=x+Math.imul(le,_t)|0,p=p+Math.imul(le,At)|0,p=p+Math.imul(y,_t)|0,I=I+Math.imul(y,At)|0;var an=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(an>>>26)|0,an&=67108863,x=Math.imul(Ge,We),p=Math.imul(Ge,Ze),p=p+Math.imul(Ye,We)|0,I=Math.imul(Ye,Ze),x=x+Math.imul(Ue,Xe)|0,p=p+Math.imul(Ue,ht)|0,p=p+Math.imul(Qe,Xe)|0,I=I+Math.imul(Qe,ht)|0,x=x+Math.imul(Ke,lt)|0,p=p+Math.imul(Ke,it)|0,p=p+Math.imul(ut,lt)|0,I=I+Math.imul(ut,it)|0,x=x+Math.imul(Le,ft)|0,p=p+Math.imul(Le,dt)|0,p=p+Math.imul($e,ft)|0,I=I+Math.imul($e,dt)|0,x=x+Math.imul(ct,pt)|0,p=p+Math.imul(ct,nt)|0,p=p+Math.imul(ze,pt)|0,I=I+Math.imul(ze,nt)|0,x=x+Math.imul(at,gt)|0,p=p+Math.imul(at,mt)|0,p=p+Math.imul(Be,gt)|0,I=I+Math.imul(Be,mt)|0,x=x+Math.imul(Ae,vt)|0,p=p+Math.imul(Ae,et)|0,p=p+Math.imul(W,vt)|0,I=I+Math.imul(W,et)|0,x=x+Math.imul(te,yt)|0,p=p+Math.imul(te,wt)|0,p=p+Math.imul(ie,yt)|0,I=I+Math.imul(ie,wt)|0,x=x+Math.imul(j,_t)|0,p=p+Math.imul(j,At)|0,p=p+Math.imul(Q,_t)|0,I=I+Math.imul(Q,At)|0,x=x+Math.imul(le,Et)|0,p=p+Math.imul(le,st)|0,p=p+Math.imul(y,Et)|0,I=I+Math.imul(y,st)|0;var Qs=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(Qs>>>26)|0,Qs&=67108863,x=Math.imul(Ge,Xe),p=Math.imul(Ge,ht),p=p+Math.imul(Ye,Xe)|0,I=Math.imul(Ye,ht),x=x+Math.imul(Ue,lt)|0,p=p+Math.imul(Ue,it)|0,p=p+Math.imul(Qe,lt)|0,I=I+Math.imul(Qe,it)|0,x=x+Math.imul(Ke,ft)|0,p=p+Math.imul(Ke,dt)|0,p=p+Math.imul(ut,ft)|0,I=I+Math.imul(ut,dt)|0,x=x+Math.imul(Le,pt)|0,p=p+Math.imul(Le,nt)|0,p=p+Math.imul($e,pt)|0,I=I+Math.imul($e,nt)|0,x=x+Math.imul(ct,gt)|0,p=p+Math.imul(ct,mt)|0,p=p+Math.imul(ze,gt)|0,I=I+Math.imul(ze,mt)|0,x=x+Math.imul(at,vt)|0,p=p+Math.imul(at,et)|0,p=p+Math.imul(Be,vt)|0,I=I+Math.imul(Be,et)|0,x=x+Math.imul(Ae,yt)|0,p=p+Math.imul(Ae,wt)|0,p=p+Math.imul(W,yt)|0,I=I+Math.imul(W,wt)|0,x=x+Math.imul(te,_t)|0,p=p+Math.imul(te,At)|0,p=p+Math.imul(ie,_t)|0,I=I+Math.imul(ie,At)|0,x=x+Math.imul(j,Et)|0,p=p+Math.imul(j,st)|0,p=p+Math.imul(Q,Et)|0,I=I+Math.imul(Q,st)|0;var Gs=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(Gs>>>26)|0,Gs&=67108863,x=Math.imul(Ge,lt),p=Math.imul(Ge,it),p=p+Math.imul(Ye,lt)|0,I=Math.imul(Ye,it),x=x+Math.imul(Ue,ft)|0,p=p+Math.imul(Ue,dt)|0,p=p+Math.imul(Qe,ft)|0,I=I+Math.imul(Qe,dt)|0,x=x+Math.imul(Ke,pt)|0,p=p+Math.imul(Ke,nt)|0,p=p+Math.imul(ut,pt)|0,I=I+Math.imul(ut,nt)|0,x=x+Math.imul(Le,gt)|0,p=p+Math.imul(Le,mt)|0,p=p+Math.imul($e,gt)|0,I=I+Math.imul($e,mt)|0,x=x+Math.imul(ct,vt)|0,p=p+Math.imul(ct,et)|0,p=p+Math.imul(ze,vt)|0,I=I+Math.imul(ze,et)|0,x=x+Math.imul(at,yt)|0,p=p+Math.imul(at,wt)|0,p=p+Math.imul(Be,yt)|0,I=I+Math.imul(Be,wt)|0,x=x+Math.imul(Ae,_t)|0,p=p+Math.imul(Ae,At)|0,p=p+Math.imul(W,_t)|0,I=I+Math.imul(W,At)|0,x=x+Math.imul(te,Et)|0,p=p+Math.imul(te,st)|0,p=p+Math.imul(ie,Et)|0,I=I+Math.imul(ie,st)|0;var Ys=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(Ys>>>26)|0,Ys&=67108863,x=Math.imul(Ge,ft),p=Math.imul(Ge,dt),p=p+Math.imul(Ye,ft)|0,I=Math.imul(Ye,dt),x=x+Math.imul(Ue,pt)|0,p=p+Math.imul(Ue,nt)|0,p=p+Math.imul(Qe,pt)|0,I=I+Math.imul(Qe,nt)|0,x=x+Math.imul(Ke,gt)|0,p=p+Math.imul(Ke,mt)|0,p=p+Math.imul(ut,gt)|0,I=I+Math.imul(ut,mt)|0,x=x+Math.imul(Le,vt)|0,p=p+Math.imul(Le,et)|0,p=p+Math.imul($e,vt)|0,I=I+Math.imul($e,et)|0,x=x+Math.imul(ct,yt)|0,p=p+Math.imul(ct,wt)|0,p=p+Math.imul(ze,yt)|0,I=I+Math.imul(ze,wt)|0,x=x+Math.imul(at,_t)|0,p=p+Math.imul(at,At)|0,p=p+Math.imul(Be,_t)|0,I=I+Math.imul(Be,At)|0,x=x+Math.imul(Ae,Et)|0,p=p+Math.imul(Ae,st)|0,p=p+Math.imul(W,Et)|0,I=I+Math.imul(W,st)|0;var ls=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(ls>>>26)|0,ls&=67108863,x=Math.imul(Ge,pt),p=Math.imul(Ge,nt),p=p+Math.imul(Ye,pt)|0,I=Math.imul(Ye,nt),x=x+Math.imul(Ue,gt)|0,p=p+Math.imul(Ue,mt)|0,p=p+Math.imul(Qe,gt)|0,I=I+Math.imul(Qe,mt)|0,x=x+Math.imul(Ke,vt)|0,p=p+Math.imul(Ke,et)|0,p=p+Math.imul(ut,vt)|0,I=I+Math.imul(ut,et)|0,x=x+Math.imul(Le,yt)|0,p=p+Math.imul(Le,wt)|0,p=p+Math.imul($e,yt)|0,I=I+Math.imul($e,wt)|0,x=x+Math.imul(ct,_t)|0,p=p+Math.imul(ct,At)|0,p=p+Math.imul(ze,_t)|0,I=I+Math.imul(ze,At)|0,x=x+Math.imul(at,Et)|0,p=p+Math.imul(at,st)|0,p=p+Math.imul(Be,Et)|0,I=I+Math.imul(Be,st)|0;var fs=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(fs>>>26)|0,fs&=67108863,x=Math.imul(Ge,gt),p=Math.imul(Ge,mt),p=p+Math.imul(Ye,gt)|0,I=Math.imul(Ye,mt),x=x+Math.imul(Ue,vt)|0,p=p+Math.imul(Ue,et)|0,p=p+Math.imul(Qe,vt)|0,I=I+Math.imul(Qe,et)|0,x=x+Math.imul(Ke,yt)|0,p=p+Math.imul(Ke,wt)|0,p=p+Math.imul(ut,yt)|0,I=I+Math.imul(ut,wt)|0,x=x+Math.imul(Le,_t)|0,p=p+Math.imul(Le,At)|0,p=p+Math.imul($e,_t)|0,I=I+Math.imul($e,At)|0,x=x+Math.imul(ct,Et)|0,p=p+Math.imul(ct,st)|0,p=p+Math.imul(ze,Et)|0,I=I+Math.imul(ze,st)|0;var ds=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(ds>>>26)|0,ds&=67108863,x=Math.imul(Ge,vt),p=Math.imul(Ge,et),p=p+Math.imul(Ye,vt)|0,I=Math.imul(Ye,et),x=x+Math.imul(Ue,yt)|0,p=p+Math.imul(Ue,wt)|0,p=p+Math.imul(Qe,yt)|0,I=I+Math.imul(Qe,wt)|0,x=x+Math.imul(Ke,_t)|0,p=p+Math.imul(Ke,At)|0,p=p+Math.imul(ut,_t)|0,I=I+Math.imul(ut,At)|0,x=x+Math.imul(Le,Et)|0,p=p+Math.imul(Le,st)|0,p=p+Math.imul($e,Et)|0,I=I+Math.imul($e,st)|0;var Ws=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(Ws>>>26)|0,Ws&=67108863,x=Math.imul(Ge,yt),p=Math.imul(Ge,wt),p=p+Math.imul(Ye,yt)|0,I=Math.imul(Ye,wt),x=x+Math.imul(Ue,_t)|0,p=p+Math.imul(Ue,At)|0,p=p+Math.imul(Qe,_t)|0,I=I+Math.imul(Qe,At)|0,x=x+Math.imul(Ke,Et)|0,p=p+Math.imul(Ke,st)|0,p=p+Math.imul(ut,Et)|0,I=I+Math.imul(ut,st)|0;var Zs=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(Zs>>>26)|0,Zs&=67108863,x=Math.imul(Ge,_t),p=Math.imul(Ge,At),p=p+Math.imul(Ye,_t)|0,I=Math.imul(Ye,At),x=x+Math.imul(Ue,Et)|0,p=p+Math.imul(Ue,st)|0,p=p+Math.imul(Qe,Et)|0,I=I+Math.imul(Qe,st)|0;var Xs=(q+x|0)+((p&8191)<<13)|0;q=(I+(p>>>13)|0)+(Xs>>>26)|0,Xs&=67108863,x=Math.imul(Ge,Et),p=Math.imul(Ge,st),p=p+Math.imul(Ye,Et)|0,I=Math.imul(Ye,st);var eo=(q+x|0)+((p&8191)<<13)|0;return q=(I+(p>>>13)|0)+(eo>>>26)|0,eo&=67108863,O[0]=yi,O[1]=wi,O[2]=bi,O[3]=_i,O[4]=Ai,O[5]=Ei,O[6]=on,O[7]=Js,O[8]=an,O[9]=Qs,O[10]=Gs,O[11]=Ys,O[12]=ls,O[13]=fs,O[14]=ds,O[15]=Ws,O[16]=Zs,O[17]=Xs,O[18]=eo,q!==0&&(O[19]=q,A.length++),A};Math.imul||(pe=ee);function de(l,g,A){A.negative=g.negative^l.negative,A.length=l.length+g.length;for(var S=0,M=0,O=0;O<A.length-1;O++){var q=M;M=0;for(var x=S&67108863,p=Math.min(O,g.length-1),I=Math.max(0,O-l.length+1);I<=p;I++){var ge=O-I,le=l.words[ge]|0,y=g.words[I]|0,K=le*y,j=K&67108863;q=q+(K/67108864|0)|0,j=j+x|0,x=j&67108863,q=q+(j>>>26)|0,M+=q>>>26,q&=67108863}A.words[O]=x,S=q,q=M}return S!==0?A.words[O]=S:A.length--,A._strip()}function oe(l,g,A){return de(l,g,A)}u.prototype.mulTo=function(l,g){var A,S=this.length+l.length;return this.length===10&&l.length===10?A=pe(this,l,g):S<63?A=ee(this,l,g):S<1024?A=de(this,l,g):A=oe(this,l,g),A},u.prototype.mul=function(l){var g=new u(null);return g.words=new Array(this.length+l.length),this.mulTo(l,g)},u.prototype.mulf=function(l){var g=new u(null);return g.words=new Array(this.length+l.length),oe(this,l,g)},u.prototype.imul=function(l){return this.clone().mulTo(l,this)},u.prototype.imuln=function(l){var g=l<0;g&&(l=-l),s(typeof l=="number"),s(l<67108864);for(var A=0,S=0;S<this.length;S++){var M=(this.words[S]|0)*l,O=(M&67108863)+(A&67108863);A>>=26,A+=M/67108864|0,A+=O>>>26,this.words[S]=O&67108863}return A!==0&&(this.words[S]=A,this.length++),g?this.ineg():this},u.prototype.muln=function(l){return this.clone().imuln(l)},u.prototype.sqr=function(){return this.mul(this)},u.prototype.isqr=function(){return this.imul(this.clone())},u.prototype.pow=function(l){var g=H(l);if(g.length===0)return new u(1);for(var A=this,S=0;S<g.length&&g[S]===0;S++,A=A.sqr());if(++S<g.length)for(var M=A.sqr();S<g.length;S++,M=M.sqr())g[S]!==0&&(A=A.mul(M));return A},u.prototype.iushln=function(l){s(typeof l=="number"&&l>=0);var g=l%26,A=(l-g)/26,S=67108863>>>26-g<<26-g,M;if(g!==0){var O=0;for(M=0;M<this.length;M++){var q=this.words[M]&S,x=(this.words[M]|0)-q<<g;this.words[M]=x|O,O=q>>>26-g}O&&(this.words[M]=O,this.length++)}if(A!==0){for(M=this.length-1;M>=0;M--)this.words[M+A]=this.words[M];for(M=0;M<A;M++)this.words[M]=0;this.length+=A}return this._strip()},u.prototype.ishln=function(l){return s(this.negative===0),this.iushln(l)},u.prototype.iushrn=function(l,g,A){s(typeof l=="number"&&l>=0);var S;g?S=(g-g%26)/26:S=0;var M=l%26,O=Math.min((l-M)/26,this.length),q=67108863^67108863>>>M<<M,x=A;if(S-=O,S=Math.max(0,S),x){for(var p=0;p<O;p++)x.words[p]=this.words[p];x.length=O}if(O!==0)if(this.length>O)for(this.length-=O,p=0;p<this.length;p++)this.words[p]=this.words[p+O];else this.words[0]=0,this.length=1;var I=0;for(p=this.length-1;p>=0&&(I!==0||p>=S);p--){var ge=this.words[p]|0;this.words[p]=I<<26-M|ge>>>M,I=ge&q}return x&&I!==0&&(x.words[x.length++]=I),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},u.prototype.ishrn=function(l,g,A){return s(this.negative===0),this.iushrn(l,g,A)},u.prototype.shln=function(l){return this.clone().ishln(l)},u.prototype.ushln=function(l){return this.clone().iushln(l)},u.prototype.shrn=function(l){return this.clone().ishrn(l)},u.prototype.ushrn=function(l){return this.clone().iushrn(l)},u.prototype.testn=function(l){s(typeof l=="number"&&l>=0);var g=l%26,A=(l-g)/26,S=1<<g;if(this.length<=A)return!1;var M=this.words[A];return!!(M&S)},u.prototype.imaskn=function(l){s(typeof l=="number"&&l>=0);var g=l%26,A=(l-g)/26;if(s(this.negative===0,"imaskn works only with positive numbers"),this.length<=A)return this;if(g!==0&&A++,this.length=Math.min(A,this.length),g!==0){var S=67108863^67108863>>>g<<g;this.words[this.length-1]&=S}return this._strip()},u.prototype.maskn=function(l){return this.clone().imaskn(l)},u.prototype.iaddn=function(l){return s(typeof l=="number"),s(l<67108864),l<0?this.isubn(-l):this.negative!==0?this.length===1&&(this.words[0]|0)<=l?(this.words[0]=l-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(l),this.negative=1,this):this._iaddn(l)},u.prototype._iaddn=function(l){this.words[0]+=l;for(var g=0;g<this.length&&this.words[g]>=67108864;g++)this.words[g]-=67108864,g===this.length-1?this.words[g+1]=1:this.words[g+1]++;return this.length=Math.max(this.length,g+1),this},u.prototype.isubn=function(l){if(s(typeof l=="number"),s(l<67108864),l<0)return this.iaddn(-l);if(this.negative!==0)return this.negative=0,this.iaddn(l),this.negative=1,this;if(this.words[0]-=l,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var g=0;g<this.length&&this.words[g]<0;g++)this.words[g]+=67108864,this.words[g+1]-=1;return this._strip()},u.prototype.addn=function(l){return this.clone().iaddn(l)},u.prototype.subn=function(l){return this.clone().isubn(l)},u.prototype.iabs=function(){return this.negative=0,this},u.prototype.abs=function(){return this.clone().iabs()},u.prototype._ishlnsubmul=function(l,g,A){var S=l.length+A,M;this._expand(S);var O,q=0;for(M=0;M<l.length;M++){O=(this.words[M+A]|0)+q;var x=(l.words[M]|0)*g;O-=x&67108863,q=(O>>26)-(x/67108864|0),this.words[M+A]=O&67108863}for(;M<this.length-A;M++)O=(this.words[M+A]|0)+q,q=O>>26,this.words[M+A]=O&67108863;if(q===0)return this._strip();for(s(q===-1),q=0,M=0;M<this.length;M++)O=-(this.words[M]|0)+q,q=O>>26,this.words[M]=O&67108863;return this.negative=1,this._strip()},u.prototype._wordDiv=function(l,g){var A=this.length-l.length,S=this.clone(),M=l,O=M.words[M.length-1]|0,q=this._countBits(O);A=26-q,A!==0&&(M=M.ushln(A),S.iushln(A),O=M.words[M.length-1]|0);var x=S.length-M.length,p;if(g!=="mod"){p=new u(null),p.length=x+1,p.words=new Array(p.length);for(var I=0;I<p.length;I++)p.words[I]=0}var ge=S.clone()._ishlnsubmul(M,1,x);ge.negative===0&&(S=ge,p&&(p.words[x]=1));for(var le=x-1;le>=0;le--){var y=(S.words[M.length+le]|0)*67108864+(S.words[M.length+le-1]|0);for(y=Math.min(y/O|0,67108863),S._ishlnsubmul(M,y,le);S.negative!==0;)y--,S.negative=0,S._ishlnsubmul(M,1,le),S.isZero()||(S.negative^=1);p&&(p.words[le]=y)}return p&&p._strip(),S._strip(),g!=="div"&&A!==0&&S.iushrn(A),{div:p||null,mod:S}},u.prototype.divmod=function(l,g,A){if(s(!l.isZero()),this.isZero())return{div:new u(0),mod:new u(0)};var S,M,O;return this.negative!==0&&l.negative===0?(O=this.neg().divmod(l,g),g!=="mod"&&(S=O.div.neg()),g!=="div"&&(M=O.mod.neg(),A&&M.negative!==0&&M.iadd(l)),{div:S,mod:M}):this.negative===0&&l.negative!==0?(O=this.divmod(l.neg(),g),g!=="mod"&&(S=O.div.neg()),{div:S,mod:O.mod}):this.negative&l.negative?(O=this.neg().divmod(l.neg(),g),g!=="div"&&(M=O.mod.neg(),A&&M.negative!==0&&M.isub(l)),{div:O.div,mod:M}):l.length>this.length||this.cmp(l)<0?{div:new u(0),mod:this}:l.length===1?g==="div"?{div:this.divn(l.words[0]),mod:null}:g==="mod"?{div:null,mod:new u(this.modrn(l.words[0]))}:{div:this.divn(l.words[0]),mod:new u(this.modrn(l.words[0]))}:this._wordDiv(l,g)},u.prototype.div=function(l){return this.divmod(l,"div",!1).div},u.prototype.mod=function(l){return this.divmod(l,"mod",!1).mod},u.prototype.umod=function(l){return this.divmod(l,"mod",!0).mod},u.prototype.divRound=function(l){var g=this.divmod(l);if(g.mod.isZero())return g.div;var A=g.div.negative!==0?g.mod.isub(l):g.mod,S=l.ushrn(1),M=l.andln(1),O=A.cmp(S);return O<0||M===1&&O===0?g.div:g.div.negative!==0?g.div.isubn(1):g.div.iaddn(1)},u.prototype.modrn=function(l){var g=l<0;g&&(l=-l),s(l<=67108863);for(var A=(1<<26)%l,S=0,M=this.length-1;M>=0;M--)S=(A*S+(this.words[M]|0))%l;return g?-S:S},u.prototype.modn=function(l){return this.modrn(l)},u.prototype.idivn=function(l){var g=l<0;g&&(l=-l),s(l<=67108863);for(var A=0,S=this.length-1;S>=0;S--){var M=(this.words[S]|0)+A*67108864;this.words[S]=M/l|0,A=M%l}return this._strip(),g?this.ineg():this},u.prototype.divn=function(l){return this.clone().idivn(l)},u.prototype.egcd=function(l){s(l.negative===0),s(!l.isZero());var g=this,A=l.clone();g.negative!==0?g=g.umod(l):g=g.clone();for(var S=new u(1),M=new u(0),O=new u(0),q=new u(1),x=0;g.isEven()&&A.isEven();)g.iushrn(1),A.iushrn(1),++x;for(var p=A.clone(),I=g.clone();!g.isZero();){for(var ge=0,le=1;!(g.words[0]&le)&&ge<26;++ge,le<<=1);if(ge>0)for(g.iushrn(ge);ge-- >0;)(S.isOdd()||M.isOdd())&&(S.iadd(p),M.isub(I)),S.iushrn(1),M.iushrn(1);for(var y=0,K=1;!(A.words[0]&K)&&y<26;++y,K<<=1);if(y>0)for(A.iushrn(y);y-- >0;)(O.isOdd()||q.isOdd())&&(O.iadd(p),q.isub(I)),O.iushrn(1),q.iushrn(1);g.cmp(A)>=0?(g.isub(A),S.isub(O),M.isub(q)):(A.isub(g),O.isub(S),q.isub(M))}return{a:O,b:q,gcd:A.iushln(x)}},u.prototype._invmp=function(l){s(l.negative===0),s(!l.isZero());var g=this,A=l.clone();g.negative!==0?g=g.umod(l):g=g.clone();for(var S=new u(1),M=new u(0),O=A.clone();g.cmpn(1)>0&&A.cmpn(1)>0;){for(var q=0,x=1;!(g.words[0]&x)&&q<26;++q,x<<=1);if(q>0)for(g.iushrn(q);q-- >0;)S.isOdd()&&S.iadd(O),S.iushrn(1);for(var p=0,I=1;!(A.words[0]&I)&&p<26;++p,I<<=1);if(p>0)for(A.iushrn(p);p-- >0;)M.isOdd()&&M.iadd(O),M.iushrn(1);g.cmp(A)>=0?(g.isub(A),S.isub(M)):(A.isub(g),M.isub(S))}var ge;return g.cmpn(1)===0?ge=S:ge=M,ge.cmpn(0)<0&&ge.iadd(l),ge},u.prototype.gcd=function(l){if(this.isZero())return l.abs();if(l.isZero())return this.abs();var g=this.clone(),A=l.clone();g.negative=0,A.negative=0;for(var S=0;g.isEven()&&A.isEven();S++)g.iushrn(1),A.iushrn(1);do{for(;g.isEven();)g.iushrn(1);for(;A.isEven();)A.iushrn(1);var M=g.cmp(A);if(M<0){var O=g;g=A,A=O}else if(M===0||A.cmpn(1)===0)break;g.isub(A)}while(!0);return A.iushln(S)},u.prototype.invm=function(l){return this.egcd(l).a.umod(l)},u.prototype.isEven=function(){return(this.words[0]&1)===0},u.prototype.isOdd=function(){return(this.words[0]&1)===1},u.prototype.andln=function(l){return this.words[0]&l},u.prototype.bincn=function(l){s(typeof l=="number");var g=l%26,A=(l-g)/26,S=1<<g;if(this.length<=A)return this._expand(A+1),this.words[A]|=S,this;for(var M=S,O=A;M!==0&&O<this.length;O++){var q=this.words[O]|0;q+=M,M=q>>>26,q&=67108863,this.words[O]=q}return M!==0&&(this.words[O]=M,this.length++),this},u.prototype.isZero=function(){return this.length===1&&this.words[0]===0},u.prototype.cmpn=function(l){var g=l<0;if(this.negative!==0&&!g)return-1;if(this.negative===0&&g)return 1;this._strip();var A;if(this.length>1)A=1;else{g&&(l=-l),s(l<=67108863,"Number is too big");var S=this.words[0]|0;A=S===l?0:S<l?-1:1}return this.negative!==0?-A|0:A},u.prototype.cmp=function(l){if(this.negative!==0&&l.negative===0)return-1;if(this.negative===0&&l.negative!==0)return 1;var g=this.ucmp(l);return this.negative!==0?-g|0:g},u.prototype.ucmp=function(l){if(this.length>l.length)return 1;if(this.length<l.length)return-1;for(var g=0,A=this.length-1;A>=0;A--){var S=this.words[A]|0,M=l.words[A]|0;if(S!==M){S<M?g=-1:S>M&&(g=1);break}}return g},u.prototype.gtn=function(l){return this.cmpn(l)===1},u.prototype.gt=function(l){return this.cmp(l)===1},u.prototype.gten=function(l){return this.cmpn(l)>=0},u.prototype.gte=function(l){return this.cmp(l)>=0},u.prototype.ltn=function(l){return this.cmpn(l)===-1},u.prototype.lt=function(l){return this.cmp(l)===-1},u.prototype.lten=function(l){return this.cmpn(l)<=0},u.prototype.lte=function(l){return this.cmp(l)<=0},u.prototype.eqn=function(l){return this.cmpn(l)===0},u.prototype.eq=function(l){return this.cmp(l)===0},u.red=function(l){return new qe(l)},u.prototype.toRed=function(l){return s(!this.red,"Already a number in reduction context"),s(this.negative===0,"red works only with positives"),l.convertTo(this)._forceRed(l)},u.prototype.fromRed=function(){return s(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},u.prototype._forceRed=function(l){return this.red=l,this},u.prototype.forceRed=function(l){return s(!this.red,"Already a number in reduction context"),this._forceRed(l)},u.prototype.redAdd=function(l){return s(this.red,"redAdd works only with red numbers"),this.red.add(this,l)},u.prototype.redIAdd=function(l){return s(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,l)},u.prototype.redSub=function(l){return s(this.red,"redSub works only with red numbers"),this.red.sub(this,l)},u.prototype.redISub=function(l){return s(this.red,"redISub works only with red numbers"),this.red.isub(this,l)},u.prototype.redShl=function(l){return s(this.red,"redShl works only with red numbers"),this.red.shl(this,l)},u.prototype.redMul=function(l){return s(this.red,"redMul works only with red numbers"),this.red._verify2(this,l),this.red.mul(this,l)},u.prototype.redIMul=function(l){return s(this.red,"redMul works only with red numbers"),this.red._verify2(this,l),this.red.imul(this,l)},u.prototype.redSqr=function(){return s(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},u.prototype.redISqr=function(){return s(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},u.prototype.redSqrt=function(){return s(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},u.prototype.redInvm=function(){return s(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},u.prototype.redNeg=function(){return s(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},u.prototype.redPow=function(l){return s(this.red&&!l.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,l)};var re={k256:null,p224:null,p192:null,p25519:null};function ue(l,g){this.name=l,this.p=new u(g,16),this.n=this.p.bitLength(),this.k=new u(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}ue.prototype._tmp=function(){var l=new u(null);return l.words=new Array(Math.ceil(this.n/13)),l},ue.prototype.ireduce=function(l){var g=l,A;do this.split(g,this.tmp),g=this.imulK(g),g=g.iadd(this.tmp),A=g.bitLength();while(A>this.n);var S=A<this.n?-1:g.ucmp(this.p);return S===0?(g.words[0]=0,g.length=1):S>0?g.isub(this.p):g.strip!==void 0?g.strip():g._strip(),g},ue.prototype.split=function(l,g){l.iushrn(this.n,0,g)},ue.prototype.imulK=function(l){return l.imul(this.k)};function be(){ue.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}a(be,ue),be.prototype.split=function(l,g){for(var A=4194303,S=Math.min(l.length,9),M=0;M<S;M++)g.words[M]=l.words[M];if(g.length=S,l.length<=9){l.words[0]=0,l.length=1;return}var O=l.words[9];for(g.words[g.length++]=O&A,M=10;M<l.length;M++){var q=l.words[M]|0;l.words[M-10]=(q&A)<<4|O>>>22,O=q}O>>>=22,l.words[M-10]=O,O===0&&l.length>10?l.length-=10:l.length-=9},be.prototype.imulK=function(l){l.words[l.length]=0,l.words[l.length+1]=0,l.length+=2;for(var g=0,A=0;A<l.length;A++){var S=l.words[A]|0;g+=S*977,l.words[A]=g&67108863,g=S*64+(g/67108864|0)}return l.words[l.length-1]===0&&(l.length--,l.words[l.length-1]===0&&l.length--),l};function _e(){ue.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}a(_e,ue);function Ve(){ue.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}a(Ve,ue);function Ht(){ue.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}a(Ht,ue),Ht.prototype.imulK=function(l){for(var g=0,A=0;A<l.length;A++){var S=(l.words[A]|0)*19+g,M=S&67108863;S>>>=26,l.words[A]=M,g=S}return g!==0&&(l.words[l.length++]=g),l},u._prime=function(l){if(re[l])return re[l];var g;if(l==="k256")g=new be;else if(l==="p224")g=new _e;else if(l==="p192")g=new Ve;else if(l==="p25519")g=new Ht;else throw new Error("Unknown prime "+l);return re[l]=g,g};function qe(l){if(typeof l=="string"){var g=u._prime(l);this.m=g.p,this.prime=g}else s(l.gtn(1),"modulus must be greater than 1"),this.m=l,this.prime=null}qe.prototype._verify1=function(l){s(l.negative===0,"red works only with positives"),s(l.red,"red works only with red numbers")},qe.prototype._verify2=function(l,g){s((l.negative|g.negative)===0,"red works only with positives"),s(l.red&&l.red===g.red,"red works only with red numbers")},qe.prototype.imod=function(l){return this.prime?this.prime.ireduce(l)._forceRed(this):(P(l,l.umod(this.m)._forceRed(this)),l)},qe.prototype.neg=function(l){return l.isZero()?l.clone():this.m.sub(l)._forceRed(this)},qe.prototype.add=function(l,g){this._verify2(l,g);var A=l.add(g);return A.cmp(this.m)>=0&&A.isub(this.m),A._forceRed(this)},qe.prototype.iadd=function(l,g){this._verify2(l,g);var A=l.iadd(g);return A.cmp(this.m)>=0&&A.isub(this.m),A},qe.prototype.sub=function(l,g){this._verify2(l,g);var A=l.sub(g);return A.cmpn(0)<0&&A.iadd(this.m),A._forceRed(this)},qe.prototype.isub=function(l,g){this._verify2(l,g);var A=l.isub(g);return A.cmpn(0)<0&&A.iadd(this.m),A},qe.prototype.shl=function(l,g){return this._verify1(l),this.imod(l.ushln(g))},qe.prototype.imul=function(l,g){return this._verify2(l,g),this.imod(l.imul(g))},qe.prototype.mul=function(l,g){return this._verify2(l,g),this.imod(l.mul(g))},qe.prototype.isqr=function(l){return this.imul(l,l.clone())},qe.prototype.sqr=function(l){return this.mul(l,l)},qe.prototype.sqrt=function(l){if(l.isZero())return l.clone();var g=this.m.andln(3);if(s(g%2===1),g===3){var A=this.m.add(new u(1)).iushrn(2);return this.pow(l,A)}for(var S=this.m.subn(1),M=0;!S.isZero()&&S.andln(1)===0;)M++,S.iushrn(1);s(!S.isZero());var O=new u(1).toRed(this),q=O.redNeg(),x=this.m.subn(1).iushrn(1),p=this.m.bitLength();for(p=new u(2*p*p).toRed(this);this.pow(p,x).cmp(q)!==0;)p.redIAdd(q);for(var I=this.pow(p,S),ge=this.pow(l,S.addn(1).iushrn(1)),le=this.pow(l,S),y=M;le.cmp(O)!==0;){for(var K=le,j=0;K.cmp(O)!==0;j++)K=K.redSqr();s(j<y);var Q=this.pow(I,new u(1).iushln(y-j-1));ge=ge.redMul(Q),I=Q.redSqr(),le=le.redMul(I),y=j}return ge},qe.prototype.invm=function(l){var g=l._invmp(this.m);return g.negative!==0?(g.negative=0,this.imod(g).redNeg()):this.imod(g)},qe.prototype.pow=function(l,g){if(g.isZero())return new u(1).toRed(this);if(g.cmpn(1)===0)return l.clone();var A=4,S=new Array(1<<A);S[0]=new u(1).toRed(this),S[1]=l;for(var M=2;M<S.length;M++)S[M]=this.mul(S[M-1],l);var O=S[0],q=0,x=0,p=g.bitLength()%26;for(p===0&&(p=26),M=g.length-1;M>=0;M--){for(var I=g.words[M],ge=p-1;ge>=0;ge--){var le=I>>ge&1;if(O!==S[0]&&(O=this.sqr(O)),le===0&&q===0){x=0;continue}q<<=1,q|=le,x++,!(x!==A&&(M!==0||ge!==0))&&(O=this.mul(O,S[q]),x=0,q=0)}p=26}return O},qe.prototype.convertTo=function(l){var g=l.umod(this.m);return g===l?g.clone():g},qe.prototype.convertFrom=function(l){var g=l.clone();return g.red=null,g},u.mont=function(l){return new kt(l)};function kt(l){qe.call(this,l),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new u(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}a(kt,qe),kt.prototype.convertTo=function(l){return this.imod(l.ushln(this.shift))},kt.prototype.convertFrom=function(l){var g=this.imod(l.mul(this.rinv));return g.red=null,g},kt.prototype.imul=function(l,g){if(l.isZero()||g.isZero())return l.words[0]=0,l.length=1,l;var A=l.imul(g),S=A.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=A.isub(S).iushrn(this.shift),O=M;return M.cmp(this.m)>=0?O=M.isub(this.m):M.cmpn(0)<0&&(O=M.iadd(this.m)),O._forceRed(this)},kt.prototype.mul=function(l,g){if(l.isZero()||g.isZero())return new u(0)._forceRed(this);var A=l.mul(g),S=A.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=A.isub(S).iushrn(this.shift),O=M;return M.cmp(this.m)>=0?O=M.isub(this.m):M.cmpn(0)<0&&(O=M.iadd(this.m)),O._forceRed(this)},kt.prototype.invm=function(l){var g=this.imod(l._invmp(this.m).mul(this.r2));return g._forceRed(this)}})(r,bh)})(Ch);var Ie=Ch.exports;const Oh="bignumber/5.7.0";var Po=Ie.BN;const Mi=new xe(Oh),$a={},Fh=9007199254740991;function vg(r){return r!=null&&(St.isBigNumber(r)||typeof r=="number"&&r%1===0||typeof r=="string"&&!!r.match(/^-?[0-9]+$/)||yr(r)||typeof r=="bigint"||Qn(r))}let Dh=!1;class St{constructor(e,t){e!==$a&&Mi.throwError("cannot call constructor directly; use BigNumber.from",xe.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=t,this._isBigNumber=!0,Object.freeze(this)}fromTwos(e){return hr(Fe(this).fromTwos(e))}toTwos(e){return hr(Fe(this).toTwos(e))}abs(){return this._hex[0]==="-"?St.from(this._hex.substring(1)):this}add(e){return hr(Fe(this).add(Fe(e)))}sub(e){return hr(Fe(this).sub(Fe(e)))}div(e){return St.from(e).isZero()&&Pr("division-by-zero","div"),hr(Fe(this).div(Fe(e)))}mul(e){return hr(Fe(this).mul(Fe(e)))}mod(e){const t=Fe(e);return t.isNeg()&&Pr("division-by-zero","mod"),hr(Fe(this).umod(t))}pow(e){const t=Fe(e);return t.isNeg()&&Pr("negative-power","pow"),hr(Fe(this).pow(t))}and(e){const t=Fe(e);return(this.isNegative()||t.isNeg())&&Pr("unbound-bitwise-result","and"),hr(Fe(this).and(t))}or(e){const t=Fe(e);return(this.isNegative()||t.isNeg())&&Pr("unbound-bitwise-result","or"),hr(Fe(this).or(t))}xor(e){const t=Fe(e);return(this.isNegative()||t.isNeg())&&Pr("unbound-bitwise-result","xor"),hr(Fe(this).xor(t))}mask(e){return(this.isNegative()||e<0)&&Pr("negative-width","mask"),hr(Fe(this).maskn(e))}shl(e){return(this.isNegative()||e<0)&&Pr("negative-width","shl"),hr(Fe(this).shln(e))}shr(e){return(this.isNegative()||e<0)&&Pr("negative-width","shr"),hr(Fe(this).shrn(e))}eq(e){return Fe(this).eq(Fe(e))}lt(e){return Fe(this).lt(Fe(e))}lte(e){return Fe(this).lte(Fe(e))}gt(e){return Fe(this).gt(Fe(e))}gte(e){return Fe(this).gte(Fe(e))}isNegative(){return this._hex[0]==="-"}isZero(){return Fe(this).isZero()}toNumber(){try{return Fe(this).toNumber()}catch{Pr("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch{}return Mi.throwError("this platform does not support BigInt",xe.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(arguments[0]===10?Dh||(Dh=!0,Mi.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):arguments[0]===16?Mi.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",xe.errors.UNEXPECTED_ARGUMENT,{}):Mi.throwError("BigNumber.toString does not accept parameters",xe.errors.UNEXPECTED_ARGUMENT,{})),Fe(this).toString(10)}toHexString(){return this._hex}toJSON(e){return{type:"BigNumber",hex:this.toHexString()}}static from(e){if(e instanceof St)return e;if(typeof e=="string")return e.match(/^-?0x[0-9a-f]+$/i)?new St($a,Cs(e)):e.match(/^-?[0-9]+$/)?new St($a,Cs(new Po(e))):Mi.throwArgumentError("invalid BigNumber string","value",e);if(typeof e=="number")return e%1&&Pr("underflow","BigNumber.from",e),(e>=Fh||e<=-Fh)&&Pr("overflow","BigNumber.from",e),St.from(String(e));const t=e;if(typeof t=="bigint")return St.from(t.toString());if(Qn(t))return St.from(rr(t));if(t)if(t.toHexString){const s=t.toHexString();if(typeof s=="string")return St.from(s)}else{let s=t._hex;if(s==null&&t.type==="BigNumber"&&(s=t.hex),typeof s=="string"&&(yr(s)||s[0]==="-"&&yr(s.substring(1))))return St.from(s)}return Mi.throwArgumentError("invalid BigNumber value","value",e)}static isBigNumber(e){return!!(e&&e._isBigNumber)}}function Cs(r){if(typeof r!="string")return Cs(r.toString(16));if(r[0]==="-")return r=r.substring(1),r[0]==="-"&&Mi.throwArgumentError("invalid hex","value",r),r=Cs(r),r==="0x00"?r:"-"+r;if(r.substring(0,2)!=="0x"&&(r="0x"+r),r==="0x")return"0x00";for(r.length%2&&(r="0x0"+r.substring(2));r.length>4&&r.substring(0,4)==="0x00";)r="0x"+r.substring(4);return r}function hr(r){return St.from(Cs(r))}function Fe(r){const e=St.from(r).toHexString();return e[0]==="-"?new Po("-"+e.substring(3),16):new Po(e.substring(2),16)}function Pr(r,e,t){const s={fault:r,operation:e};return t!=null&&(s.value=t),Mi.throwError(r,xe.errors.NUMERIC_FAULT,s)}function yg(r){return new Po(r,36).toString(16)}const ir=new xe(Oh),Os={},Th=St.from(0),qh=St.from(-1);function Bh(r,e,t,s){const a={fault:e,operation:t};return s!==void 0&&(a.value=s),ir.throwError(r,xe.errors.NUMERIC_FAULT,a)}let Fs="0";for(;Fs.length<256;)Fs+=Fs;function Ja(r){if(typeof r!="number")try{r=St.from(r).toNumber()}catch{}return typeof r=="number"&&r>=0&&r<=256&&!(r%1)?"1"+Fs.substring(0,r):ir.throwArgumentError("invalid decimal size","decimals",r)}function Qa(r,e){e==null&&(e=0);const t=Ja(e);r=St.from(r);const s=r.lt(Th);s&&(r=r.mul(qh));let a=r.mod(t).toString();for(;a.length<t.length-1;)a="0"+a;a=a.match(/^([0-9]*[1-9]|0)(0*)/)[1];const u=r.div(t).toString();return t.length===1?r=u:r=u+"."+a,s&&(r="-"+r),r}function Ri(r,e){e==null&&(e=0);const t=Ja(e);(typeof r!="string"||!r.match(/^-?[0-9.]+$/))&&ir.throwArgumentError("invalid decimal value","value",r);const s=r.substring(0,1)==="-";s&&(r=r.substring(1)),r==="."&&ir.throwArgumentError("missing value","value",r);const a=r.split(".");a.length>2&&ir.throwArgumentError("too many decimal points","value",r);let u=a[0],f=a[1];for(u||(u="0"),f||(f="0");f[f.length-1]==="0";)f=f.substring(0,f.length-1);for(f.length>t.length-1&&Bh("fractional component exceeds decimals","underflow","parseFixed"),f===""&&(f="0");f.length<t.length-1;)f+="0";const m=St.from(u),b=St.from(f);let w=m.mul(t).add(b);return s&&(w=w.mul(qh)),w}class Gn{constructor(e,t,s,a){e!==Os&&ir.throwError("cannot use FixedFormat constructor; use FixedFormat.from",xe.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.signed=t,this.width=s,this.decimals=a,this.name=(t?"":"u")+"fixed"+String(s)+"x"+String(a),this._multiplier=Ja(a),Object.freeze(this)}static from(e){if(e instanceof Gn)return e;typeof e=="number"&&(e=`fixed128x${e}`);let t=!0,s=128,a=18;if(typeof e=="string"){if(e!=="fixed")if(e==="ufixed")t=!1;else{const u=e.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);u||ir.throwArgumentError("invalid fixed format","format",e),t=u[1]!=="u",s=parseInt(u[2]),a=parseInt(u[3])}}else if(e){const u=(f,m,b)=>e[f]==null?b:(typeof e[f]!==m&&ir.throwArgumentError("invalid fixed format ("+f+" not "+m+")","format."+f,e[f]),e[f]);t=u("signed","boolean",t),s=u("width","number",s),a=u("decimals","number",a)}return s%8&&ir.throwArgumentError("invalid fixed format width (not byte aligned)","format.width",s),a>80&&ir.throwArgumentError("invalid fixed format (decimals too large)","format.decimals",a),new Gn(Os,t,s,a)}}class Jt{constructor(e,t,s,a){e!==Os&&ir.throwError("cannot use FixedNumber constructor; use FixedNumber.from",xe.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.format=a,this._hex=t,this._value=s,this._isFixedNumber=!0,Object.freeze(this)}_checkFormat(e){this.format.name!==e.format.name&&ir.throwArgumentError("incompatible format; use fixedNumber.toFormat","other",e)}addUnsafe(e){this._checkFormat(e);const t=Ri(this._value,this.format.decimals),s=Ri(e._value,e.format.decimals);return Jt.fromValue(t.add(s),this.format.decimals,this.format)}subUnsafe(e){this._checkFormat(e);const t=Ri(this._value,this.format.decimals),s=Ri(e._value,e.format.decimals);return Jt.fromValue(t.sub(s),this.format.decimals,this.format)}mulUnsafe(e){this._checkFormat(e);const t=Ri(this._value,this.format.decimals),s=Ri(e._value,e.format.decimals);return Jt.fromValue(t.mul(s).div(this.format._multiplier),this.format.decimals,this.format)}divUnsafe(e){this._checkFormat(e);const t=Ri(this._value,this.format.decimals),s=Ri(e._value,e.format.decimals);return Jt.fromValue(t.mul(this.format._multiplier).div(s),this.format.decimals,this.format)}floor(){const e=this.toString().split(".");e.length===1&&e.push("0");let t=Jt.from(e[0],this.format);const s=!e[1].match(/^(0*)$/);return this.isNegative()&&s&&(t=t.subUnsafe(kh.toFormat(t.format))),t}ceiling(){const e=this.toString().split(".");e.length===1&&e.push("0");let t=Jt.from(e[0],this.format);const s=!e[1].match(/^(0*)$/);return!this.isNegative()&&s&&(t=t.addUnsafe(kh.toFormat(t.format))),t}round(e){e==null&&(e=0);const t=this.toString().split(".");if(t.length===1&&t.push("0"),(e<0||e>80||e%1)&&ir.throwArgumentError("invalid decimal count","decimals",e),t[1].length<=e)return this;const s=Jt.from("1"+Fs.substring(0,e),this.format),a=wg.toFormat(this.format);return this.mulUnsafe(s).addUnsafe(a).floor().divUnsafe(s)}isZero(){return this._value==="0.0"||this._value==="0"}isNegative(){return this._value[0]==="-"}toString(){return this._value}toHexString(e){if(e==null)return this._hex;e%8&&ir.throwArgumentError("invalid byte width","width",e);const t=St.from(this._hex).fromTwos(this.format.width).toTwos(e).toHexString();return ri(t,e/8)}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return Jt.fromString(this._value,e)}static fromValue(e,t,s){return s==null&&t!=null&&!vg(t)&&(s=t,t=null),t==null&&(t=0),s==null&&(s="fixed"),Jt.fromString(Qa(e,t),Gn.from(s))}static fromString(e,t){t==null&&(t="fixed");const s=Gn.from(t),a=Ri(e,s.decimals);!s.signed&&a.lt(Th)&&Bh("unsigned value cannot be negative","overflow","value",e);let u=null;s.signed?u=a.toTwos(s.width).toHexString():(u=a.toHexString(),u=ri(u,s.width/8));const f=Qa(a,s.decimals);return new Jt(Os,u,f,s)}static fromBytes(e,t){t==null&&(t="fixed");const s=Gn.from(t);if(Ct(e).length>s.width/8)throw new Error("overflow");let a=St.from(e);s.signed&&(a=a.fromTwos(s.width));const u=a.toTwos((s.signed?0:1)+s.width).toHexString(),f=Qa(a,s.decimals);return new Jt(Os,u,f,s)}static from(e,t){if(typeof e=="string")return Jt.fromString(e,t);if(Qn(e))return Jt.fromBytes(e,t);try{return Jt.fromValue(e,0,t)}catch(s){if(s.code!==xe.errors.INVALID_ARGUMENT)throw s}return ir.throwArgumentError("invalid FixedNumber value","value",e)}static isFixedNumber(e){return!!(e&&e._isFixedNumber)}}const kh=Jt.from(1),wg=Jt.from("0.5"),bg="strings/5.7.0",Uh=new xe(bg);var Mo;(function(r){r.current="",r.NFC="NFC",r.NFD="NFD",r.NFKC="NFKC",r.NFKD="NFKD"})(Mo||(Mo={}));var Yn;(function(r){r.UNEXPECTED_CONTINUE="unexpected continuation byte",r.BAD_PREFIX="bad codepoint prefix",r.OVERRUN="string overrun",r.MISSING_CONTINUE="missing continuation byte",r.OUT_OF_RANGE="out of UTF-8 range",r.UTF16_SURROGATE="UTF-16 surrogate",r.OVERLONG="overlong representation"})(Yn||(Yn={}));function _g(r,e,t,s,a){return Uh.throwArgumentError(`invalid codepoint at offset ${e}; ${r}`,"bytes",t)}function jh(r,e,t,s,a){if(r===Yn.BAD_PREFIX||r===Yn.UNEXPECTED_CONTINUE){let u=0;for(let f=e+1;f<t.length&&t[f]>>6===2;f++)u++;return u}return r===Yn.OVERRUN?t.length-e-1:0}function Ag(r,e,t,s,a){return r===Yn.OVERLONG?(s.push(a),0):(s.push(65533),jh(r,e,t))}Object.freeze({error:_g,ignore:jh,replace:Ag});function Ga(r,e=Mo.current){e!=Mo.current&&(Uh.checkNormalize(),r=r.normalize(e));let t=[];for(let s=0;s<r.length;s++){const a=r.charCodeAt(s);if(a<128)t.push(a);else if(a<2048)t.push(a>>6|192),t.push(a&63|128);else if((a&64512)==55296){s++;const u=r.charCodeAt(s);if(s>=r.length||(u&64512)!==56320)throw new Error("invalid utf-8 string");const f=65536+((a&1023)<<10)+(u&1023);t.push(f>>18|240),t.push(f>>12&63|128),t.push(f>>6&63|128),t.push(f&63|128)}else t.push(a>>12|224),t.push(a>>6&63|128),t.push(a&63|128)}return Ct(t)}function Eg(r){if(r.length%4!==0)throw new Error("bad data");let e=[];for(let t=0;t<r.length;t+=4)e.push(parseInt(r.substring(t,t+4),16));return e}function Ya(r,e){e||(e=function(a){return[parseInt(a,16)]});let t=0,s={};return r.split(",").forEach(a=>{let u=a.split(":");t+=parseInt(u[0],16),s[t]=e(u[1])}),s}function zh(r){let e=0;return r.split(",").map(t=>{let s=t.split("-");s.length===1?s[1]="0":s[1]===""&&(s[1]="1");let a=e+parseInt(s[0],16);return e=parseInt(s[1],16),{l:a,h:e}})}zh("221,13-1b,5f-,40-10,51-f,11-3,3-3,2-2,2-4,8,2,15,2d,28-8,88,48,27-,3-5,11-20,27-,8,28,3-5,12,18,b-a,1c-4,6-16,2-d,2-2,2,1b-4,17-9,8f-,10,f,1f-2,1c-34,33-14e,4,36-,13-,6-2,1a-f,4,9-,3-,17,8,2-2,5-,2,8-,3-,4-8,2-3,3,6-,16-6,2-,7-3,3-,17,8,3,3,3-,2,6-3,3-,4-a,5,2-6,10-b,4,8,2,4,17,8,3,6-,b,4,4-,2-e,2-4,b-10,4,9-,3-,17,8,3-,5-,9-2,3-,4-7,3-3,3,4-3,c-10,3,7-2,4,5-2,3,2,3-2,3-2,4-2,9,4-3,6-2,4,5-8,2-e,d-d,4,9,4,18,b,6-3,8,4,5-6,3-8,3-3,b-11,3,9,4,18,b,6-3,8,4,5-6,3-6,2,3-3,b-11,3,9,4,18,11-3,7-,4,5-8,2-7,3-3,b-11,3,13-2,19,a,2-,8-2,2-3,7,2,9-11,4-b,3b-3,1e-24,3,2-,3,2-,2-5,5,8,4,2,2-,3,e,4-,6,2,7-,b-,3-21,49,23-5,1c-3,9,25,10-,2-2f,23,6,3,8-2,5-5,1b-45,27-9,2a-,2-3,5b-4,45-4,53-5,8,40,2,5-,8,2,5-,28,2,5-,20,2,5-,8,2,5-,8,8,18,20,2,5-,8,28,14-5,1d-22,56-b,277-8,1e-2,52-e,e,8-a,18-8,15-b,e,4,3-b,5e-2,b-15,10,b-5,59-7,2b-555,9d-3,5b-5,17-,7-,27-,7-,9,2,2,2,20-,36,10,f-,7,14-,4,a,54-3,2-6,6-5,9-,1c-10,13-1d,1c-14,3c-,10-6,32-b,240-30,28-18,c-14,a0,115-,3,66-,b-76,5,5-,1d,24,2,5-2,2,8-,35-2,19,f-10,1d-3,311-37f,1b,5a-b,d7-19,d-3,41,57-,68-4,29-3,5f,29-37,2e-2,25-c,2c-2,4e-3,30,78-3,64-,20,19b7-49,51a7-59,48e-2,38-738,2ba5-5b,222f-,3c-94,8-b,6-4,1b,6,2,3,3,6d-20,16e-f,41-,37-7,2e-2,11-f,5-b,18-,b,14,5-3,6,88-,2,bf-2,7-,7-,7-,4-2,8,8-9,8-2ff,20,5-b,1c-b4,27-,27-cbb1,f7-9,28-2,b5-221,56,48,3-,2-,3-,5,d,2,5,3,42,5-,9,8,1d,5,6,2-2,8,153-3,123-3,33-27fd,a6da-5128,21f-5df,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3,2-1d,61-ff7d"),"ad,34f,1806,180b,180c,180d,200b,200c,200d,2060,feff".split(",").map(r=>parseInt(r,16)),Ya("b5:3bc,c3:ff,7:73,2:253,5:254,3:256,1:257,5:259,1:25b,3:260,1:263,2:269,1:268,5:26f,1:272,2:275,7:280,3:283,5:288,3:28a,1:28b,5:292,3f:195,1:1bf,29:19e,125:3b9,8b:3b2,1:3b8,1:3c5,3:3c6,1:3c0,1a:3ba,1:3c1,1:3c3,2:3b8,1:3b5,1bc9:3b9,1c:1f76,1:1f77,f:1f7a,1:1f7b,d:1f78,1:1f79,1:1f7c,1:1f7d,107:63,5:25b,4:68,1:68,1:68,3:69,1:69,1:6c,3:6e,4:70,1:71,1:72,1:72,1:72,7:7a,2:3c9,2:7a,2:6b,1:e5,1:62,1:63,3:65,1:66,2:6d,b:3b3,1:3c0,6:64,1b574:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3"),Ya("179:1,2:1,2:1,5:1,2:1,a:4f,a:1,8:1,2:1,2:1,3:1,5:1,3:1,4:1,2:1,3:1,4:1,8:2,1:1,2:2,1:1,2:2,27:2,195:26,2:25,1:25,1:25,2:40,2:3f,1:3f,33:1,11:-6,1:-9,1ac7:-3a,6d:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,b:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,c:-8,2:-8,2:-8,2:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,49:-8,1:-8,1:-4a,1:-4a,d:-56,1:-56,1:-56,1:-56,d:-8,1:-8,f:-8,1:-8,3:-7"),Ya("df:00730073,51:00690307,19:02BC006E,a7:006A030C,18a:002003B9,16:03B903080301,20:03C503080301,1d7:05650582,190f:00680331,1:00740308,1:0077030A,1:0079030A,1:006102BE,b6:03C50313,2:03C503130300,2:03C503130301,2:03C503130342,2a:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,3:1F7003B9,1:03B103B9,1:03AC03B9,2:03B10342,1:03B1034203B9,5:03B103B9,6:1F7403B9,1:03B703B9,1:03AE03B9,2:03B70342,1:03B7034203B9,5:03B703B9,6:03B903080300,1:03B903080301,3:03B90342,1:03B903080342,b:03C503080300,1:03C503080301,1:03C10313,2:03C50342,1:03C503080342,b:1F7C03B9,1:03C903B9,1:03CE03B9,2:03C90342,1:03C9034203B9,5:03C903B9,ac:00720073,5b:00B00063,6:00B00066,d:006E006F,a:0073006D,1:00740065006C,1:0074006D,124f:006800700061,2:00610075,2:006F0076,b:00700061,1:006E0061,1:03BC0061,1:006D0061,1:006B0061,1:006B0062,1:006D0062,1:00670062,3:00700066,1:006E0066,1:03BC0066,4:0068007A,1:006B0068007A,1:006D0068007A,1:00670068007A,1:00740068007A,15:00700061,1:006B00700061,1:006D00700061,1:006700700061,8:00700076,1:006E0076,1:03BC0076,1:006D0076,1:006B0076,1:006D0076,1:00700077,1:006E0077,1:03BC0077,1:006D0077,1:006B0077,1:006D0077,1:006B03C9,1:006D03C9,2:00620071,3:00632215006B0067,1:0063006F002E,1:00640062,1:00670079,2:00680070,2:006B006B,1:006B006D,9:00700068,2:00700070006D,1:00700072,2:00730076,1:00770062,c723:00660066,1:00660069,1:0066006C,1:006600660069,1:00660066006C,1:00730074,1:00730074,d:05740576,1:05740565,1:0574056B,1:057E0576,1:0574056D",Eg),zh("80-20,2a0-,39c,32,f71,18e,7f2-f,19-7,30-4,7-5,f81-b,5,a800-20ff,4d1-1f,110,fa-6,d174-7,2e84-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,2,1f-5f,ff7f-20001");const Lh="hash/5.7.0";function Ig(r){r=atob(r);const e=[];for(let t=0;t<r.length;t++)e.push(r.charCodeAt(t));return Ct(e)}function Kh(r,e){e==null&&(e=1);const t=[],s=t.forEach,a=function(u,f){s.call(u,function(m){f>0&&Array.isArray(m)?a(m,f-1):t.push(m)})};return a(r,e),t}function Sg(r){const e={};for(let t=0;t<r.length;t++){const s=r[t];e[s[0]]=s[1]}return e}function xg(r){let e=0;function t(){return r[e++]<<8|r[e++]}let s=t(),a=1,u=[0,1];for(let re=1;re<s;re++)u.push(a+=t());let f=t(),m=e;e+=f;let b=0,w=0;function P(){return b==0&&(w=w<<8|r[e++],b=8),w>>--b&1}const R=31,F=Math.pow(2,R),B=F>>>1,k=B>>1,L=F-1;let H=0;for(let re=0;re<R;re++)H=H<<1|P();let ee=[],pe=0,de=F;for(;;){let re=Math.floor(((H-pe+1)*a-1)/de),ue=0,be=s;for(;be-ue>1;){let Ht=ue+be>>>1;re<u[Ht]?be=Ht:ue=Ht}if(ue==0)break;ee.push(ue);let _e=pe+Math.floor(de*u[ue]/a),Ve=pe+Math.floor(de*u[ue+1]/a)-1;for(;!((_e^Ve)&B);)H=H<<1&L|P(),_e=_e<<1&L,Ve=Ve<<1&L|1;for(;_e&~Ve&k;)H=H&B|H<<1&L>>>1|P(),_e=_e<<1^B,Ve=(Ve^B)<<1|B|1;pe=_e,de=1+Ve-_e}let oe=s-4;return ee.map(re=>{switch(re-oe){case 3:return oe+65792+(r[m++]<<16|r[m++]<<8|r[m++]);case 2:return oe+256+(r[m++]<<8|r[m++]);case 1:return oe+r[m++];default:return re-1}})}function Pg(r){let e=0;return()=>r[e++]}function Mg(r){return Pg(xg(r))}function Rg(r){return r&1?~r>>1:r>>1}function Ng(r,e){let t=Array(r);for(let s=0;s<r;s++)t[s]=1+e();return t}function Hh(r,e){let t=Array(r);for(let s=0,a=-1;s<r;s++)t[s]=a+=1+e();return t}function Cg(r,e){let t=Array(r);for(let s=0,a=0;s<r;s++)t[s]=a+=Rg(e());return t}function Ro(r,e){let t=Hh(r(),r),s=r(),a=Hh(s,r),u=Ng(s,r);for(let f=0;f<s;f++)for(let m=0;m<u[f];m++)t.push(a[f]+m);return e?t.map(f=>e[f]):t}function Og(r){let e=[];for(;;){let t=r();if(t==0)break;e.push(Dg(t,r))}for(;;){let t=r()-1;if(t<0)break;e.push(Tg(t,r))}return Sg(Kh(e))}function Fg(r){let e=[];for(;;){let t=r();if(t==0)break;e.push(t)}return e}function Vh(r,e,t){let s=Array(r).fill(void 0).map(()=>[]);for(let a=0;a<e;a++)Cg(r,t).forEach((u,f)=>s[f].push(u));return s}function Dg(r,e){let t=1+e(),s=e(),a=Fg(e),u=Vh(a.length,1+r,e);return Kh(u.map((f,m)=>{const b=f[0],w=f.slice(1);return Array(a[m]).fill(void 0).map((P,R)=>{let F=R*s;return[b+R*t,w.map(B=>B+F)]})}))}function Tg(r,e){let t=1+e();return Vh(t,1+r,e).map(s=>[s[0],s.slice(1)])}function qg(r){let e=Ro(r).sort((s,a)=>s-a);return t();function t(){let s=[];for(;;){let w=Ro(r,e);if(w.length==0)break;s.push({set:new Set(w),node:t()})}s.sort((w,P)=>P.set.size-w.set.size);let a=r(),u=a%3;a=a/3|0;let f=!!(a&1);a>>=1;let m=a==1,b=a==2;return{branches:s,valid:u,fe0f:f,save:m,check:b}}}function Bg(){return Mg(Ig("AEQF2AO2DEsA2wIrAGsBRABxAN8AZwCcAEwAqgA0AGwAUgByADcATAAVAFYAIQAyACEAKAAYAFgAGwAjABQAMAAmADIAFAAfABQAKwATACoADgAbAA8AHQAYABoAGQAxADgALAAoADwAEwA9ABMAGgARAA4ADwAWABMAFgAIAA8AHgQXBYMA5BHJAS8JtAYoAe4AExozi0UAH21tAaMnBT8CrnIyhrMDhRgDygIBUAEHcoFHUPe8AXBjAewCjgDQR8IICIcEcQLwATXCDgzvHwBmBoHNAqsBdBcUAykgDhAMShskMgo8AY8jqAQfAUAfHw8BDw87MioGlCIPBwZCa4ELatMAAMspJVgsDl8AIhckSg8XAHdvTwBcIQEiDT4OPhUqbyECAEoAS34Aej8Ybx83JgT/Xw8gHxZ/7w8RICxPHA9vBw+Pfw8PHwAPFv+fAsAvCc8vEr8ivwD/EQ8Bol8OEBa/A78hrwAPCU8vESNvvwWfHwNfAVoDHr+ZAAED34YaAdJPAK7PLwSEgDLHAGo1Pz8Pvx9fUwMrpb8O/58VTzAPIBoXIyQJNF8hpwIVAT8YGAUADDNBaX3RAMomJCg9EhUeA29MABsZBTMNJipjOhc19gcIDR8bBwQHEggCWi6DIgLuAQYA+BAFCha3A5XiAEsqM7UFFgFLhAMjFTMYE1Klnw74nRVBG/ASCm0BYRN/BrsU3VoWy+S0vV8LQx+vN8gF2AC2AK5EAWwApgYDKmAAroQ0NDQ0AT+OCg7wAAIHRAbpNgVcBV0APTA5BfbPFgMLzcYL/QqqA82eBALKCjQCjqYCht0/k2+OAsXQAoP3ASTKDgDw6ACKAUYCMpIKJpRaAE4A5womABzZvs0REEKiACIQAd5QdAECAj4Ywg/wGqY2AVgAYADYvAoCGAEubA0gvAY2ALAAbpbvqpyEAGAEpgQAJgAG7gAgAEACmghUFwCqAMpAINQIwC4DthRAAPcycKgApoIdABwBfCisABoATwBqASIAvhnSBP8aH/ECeAKXAq40NjgDBTwFYQU6AXs3oABgAD4XNgmcCY1eCl5tIFZeUqGgyoNHABgAEQAaABNwWQAmABMATPMa3T34ADldyprmM1M2XociUQgLzvwAXT3xABgAEQAaABNwIGFAnADD8AAgAD4BBJWzaCcIAIEBFMAWwKoAAdq9BWAF5wLQpALEtQAKUSGkahR4GnJM+gsAwCgeFAiUAECQ0BQuL8AAIAAAADKeIheclvFqQAAETr4iAMxIARMgAMIoHhQIAn0E0pDQFC4HhznoAAAAIAI2C0/4lvFqQAAETgBJJwYCAy4ABgYAFAA8MBKYEH4eRhTkAjYeFcgACAYAeABsOqyQ5gRwDayqugEgaIIAtgoACgDmEABmBAWGme5OBJJA2m4cDeoAmITWAXwrMgOgAGwBCh6CBXYF1Tzg1wKAAFdiuABRAFwAXQBsAG8AdgBrAHYAbwCEAHEwfxQBVE5TEQADVFhTBwBDANILAqcCzgLTApQCrQL6vAAMAL8APLhNBKkE6glGKTAU4Dr4N2EYEwBCkABKk8rHAbYBmwIoAiU4Ajf/Aq4CowCAANIChzgaNBsCsTgeODcFXrgClQKdAqQBiQGYAqsCsjTsNHsfNPA0ixsAWTWiOAMFPDQSNCk2BDZHNow2TTZUNhk28Jk9VzI3QkEoAoICoQKwAqcAQAAxBV4FXbS9BW47YkIXP1ciUqs05DS/FwABUwJW11e6nHuYZmSh/RAYA8oMKvZ8KASoUAJYWAJ6ILAsAZSoqjpgA0ocBIhmDgDWAAawRDQoAAcuAj5iAHABZiR2AIgiHgCaAU68ACxuHAG0ygM8MiZIAlgBdF4GagJqAPZOHAMuBgoATkYAsABiAHgAMLoGDPj0HpKEBAAOJgAuALggTAHWAeAMEDbd20Uege0ADwAWADkAQgA9OHd+2MUQZBBhBgNNDkxxPxUQArEPqwvqERoM1irQ090ANK4H8ANYB/ADWANYB/AH8ANYB/ADWANYA1gDWBwP8B/YxRBkD00EcgWTBZAE2wiIJk4RhgctCNdUEnQjHEwDSgEBIypJITuYMxAlR0wRTQgIATZHbKx9PQNMMbBU+pCnA9AyVDlxBgMedhKlAC8PeCE1uk6DekxxpQpQT7NX9wBFBgASqwAS5gBJDSgAUCwGPQBI4zTYABNGAE2bAE3KAExdGABKaAbgAFBXAFCOAFBJABI2SWdObALDOq0//QomCZhvwHdTBkIQHCemEPgMNAG2ATwN7kvZBPIGPATKH34ZGg/OlZ0Ipi3eDO4m5C6igFsj9iqEBe5L9TzeC05RaQ9aC2YJ5DpkgU8DIgEOIowK3g06CG4Q9ArKbA3mEUYHOgPWSZsApgcCCxIdNhW2JhFirQsKOXgG/Br3C5AmsBMqev0F1BoiBk4BKhsAANAu6IWxWjJcHU9gBgQLJiPIFKlQIQ0mQLh4SRocBxYlqgKSQ3FKiFE3HpQh9zw+DWcuFFF9B/Y8BhlQC4I8n0asRQ8R0z6OPUkiSkwtBDaALDAnjAnQD4YMunxzAVoJIgmyDHITMhEYN8YIOgcaLpclJxYIIkaWYJsE+KAD9BPSAwwFQAlCBxQDthwuEy8VKgUOgSXYAvQ21i60ApBWgQEYBcwPJh/gEFFH4Q7qCJwCZgOEJewALhUiABginAhEZABgj9lTBi7MCMhqbSN1A2gU6GIRdAeSDlgHqBw0FcAc4nDJXgyGCSiksAlcAXYJmgFgBOQICjVcjKEgQmdUi1kYnCBiQUBd/QIyDGYVoES+h3kCjA9sEhwBNgF0BzoNAgJ4Ee4RbBCWCOyGBTW2M/k6JgRQIYQgEgooA1BszwsoJvoM+WoBpBJjAw00PnfvZ6xgtyUX/gcaMsZBYSHyC5NPzgydGsIYQ1QvGeUHwAP0GvQn60FYBgADpAQUOk4z7wS+C2oIjAlAAEoOpBgH2BhrCnKM0QEyjAG4mgNYkoQCcJAGOAcMAGgMiAV65gAeAqgIpAAGANADWAA6Aq4HngAaAIZCAT4DKDABIuYCkAOUCDLMAZYwAfQqBBzEDBYA+DhuSwLDsgKAa2ajBd5ZAo8CSjYBTiYEBk9IUgOwcuIA3ABMBhTgSAEWrEvMG+REAeBwLADIAPwABjYHBkIBzgH0bgC4AWALMgmjtLYBTuoqAIQAFmwB2AKKAN4ANgCA8gFUAE4FWvoF1AJQSgESMhksWGIBvAMgATQBDgB6BsyOpsoIIARuB9QCEBwV4gLvLwe2AgMi4BPOQsYCvd9WADIXUu5eZwqoCqdeaAC0YTQHMnM9UQAPH6k+yAdy/BZIiQImSwBQ5gBQQzSaNTFWSTYBpwGqKQK38AFtqwBI/wK37gK3rQK3sAK6280C0gK33AK3zxAAUEIAUD9SklKDArekArw5AEQAzAHCO147WTteO1k7XjtZO147WTteO1kDmChYI03AVU0oJqkKbV9GYewMpw3VRMk6ShPcYFJgMxPJLbgUwhXPJVcZPhq9JwYl5VUKDwUt1GYxCC00dhe9AEApaYNCY4ceMQpMHOhTklT5LRwAskujM7ANrRsWREEFSHXuYisWDwojAmSCAmJDXE6wXDchAqH4AmiZAmYKAp+FOBwMAmY8AmYnBG8EgAN/FAN+kzkHOXgYOYM6JCQCbB4CMjc4CwJtyAJtr/CLADRoRiwBaADfAOIASwYHmQyOAP8MwwAOtgJ3MAJ2o0ACeUxEAni7Hl3cRa9G9AJ8QAJ6yQJ9CgJ88UgBSH5kJQAsFklZSlwWGErNAtECAtDNSygDiFADh+dExpEzAvKiXQQDA69Lz0wuJgTQTU1NsAKLQAKK2cIcCB5EaAa4Ao44Ao5dQZiCAo7aAo5deVG1UzYLUtVUhgKT/AKTDQDqAB1VH1WwVdEHLBwplocy4nhnRTw6ApegAu+zWCKpAFomApaQApZ9nQCqWa1aCoJOADwClrYClk9cRVzSApnMApllXMtdCBoCnJw5wzqeApwXAp+cAp65iwAeEDIrEAKd8gKekwC2PmE1YfACntQCoG8BqgKeoCACnk+mY8lkKCYsAiewAiZ/AqD8AqBN2AKmMAKlzwKoAAB+AqfzaH1osgAESmodatICrOQCrK8CrWgCrQMCVx4CVd0CseLYAx9PbJgCsr4OArLpGGzhbWRtSWADJc4Ctl08QG6RAylGArhfArlIFgK5K3hwN3DiAr0aAy2zAzISAr6JcgMDM3ICvhtzI3NQAsPMAsMFc4N0TDZGdOEDPKgDPJsDPcACxX0CxkgCxhGKAshqUgLIRQLJUALJLwJkngLd03h6YniveSZL0QMYpGcDAmH1GfSVJXsMXpNevBICz2wCz20wTFTT9BSgAMeuAs90ASrrA04TfkwGAtwoAtuLAtJQA1JdA1NgAQIDVY2AikABzBfuYUZ2AILPg44C2sgC2d+EEYRKpz0DhqYAMANkD4ZyWvoAVgLfZgLeuXR4AuIw7RUB8zEoAfScAfLTiALr9ALpcXoAAur6AurlAPpIAboC7ooC652Wq5cEAu5AA4XhmHpw4XGiAvMEAGoDjheZlAL3FAORbwOSiAL3mQL52gL4Z5odmqy8OJsfA52EAv77ARwAOp8dn7QDBY4DpmsDptoA0sYDBmuhiaIGCgMMSgFgASACtgNGAJwEgLpoBgC8BGzAEowcggCEDC6kdjoAJAM0C5IKRoABZCgiAIzw3AYBLACkfng9ogigkgNmWAN6AEQCvrkEVqTGAwCsBRbAA+4iQkMCHR072jI2PTbUNsk2RjY5NvA23TZKNiU3EDcZN5I+RTxDRTBCJkK5VBYKFhZfwQCWygU3AJBRHpu+OytgNxa61A40GMsYjsn7BVwFXQVcBV0FaAVdBVwFXQVcBV0FXAVdBVwFXUsaCNyKAK4AAQUHBwKU7oICoW1e7jAEzgPxA+YDwgCkBFDAwADABKzAAOxFLhitA1UFTDeyPkM+bj51QkRCuwTQWWQ8X+0AWBYzsACNA8xwzAGm7EZ/QisoCTAbLDs6fnLfb8H2GccsbgFw13M1HAVkBW/Jxsm9CNRO8E8FDD0FBQw9FkcClOYCoMFegpDfADgcMiA2AJQACB8AsigKAIzIEAJKeBIApY5yPZQIAKQiHb4fvj5BKSRPQrZCOz0oXyxgOywfKAnGbgMClQaCAkILXgdeCD9IIGUgQj5fPoY+dT52Ao5CM0dAX9BTVG9SDzFwWTQAbxBzJF/lOEIQQglCCkKJIAls5AcClQICoKPMODEFxhi6KSAbiyfIRrMjtCgdWCAkPlFBIitCsEJRzAbMAV/OEyQzDg0OAQQEJ36i328/Mk9AybDJsQlq3tDRApUKAkFzXf1d/j9uALYP6hCoFgCTGD8kPsFKQiobrm0+zj0KSD8kPnVCRBwMDyJRTHFgMTJa5rwXQiQ2YfI/JD7BMEJEHGINTw4TOFlIRzwJO0icMQpyPyQ+wzJCRBv6DVgnKB01NgUKj2bwYzMqCoBkznBgEF+zYDIocwRIX+NgHj4HICNfh2C4CwdwFWpTG/lgUhYGAwRfv2Ts8mAaXzVgml/XYIJfuWC4HI1gUF9pYJZgMR6ilQHMAOwLAlDRefC0in4AXAEJA6PjCwc0IamOANMMCAECRQDFNRTZBgd+CwQlRA+r6+gLBDEFBnwUBXgKATIArwAGRAAHA3cDdAN2A3kDdwN9A3oDdQN7A30DfAN4A3oDfQAYEAAlAtYASwMAUAFsAHcKAHcAmgB3AHUAdQB2AHVu8UgAygDAAHcAdQB1AHYAdQALCgB3AAsAmgB3AAsCOwB3AAtu8UgAygDAAHgKAJoAdwB3AHUAdQB2AHUAeAB1AHUAdgB1bvFIAMoAwAALCgCaAHcACwB3AAsCOwB3AAtu8UgAygDAAH4ACwGgALcBpwC6AahdAu0COwLtbvFIAMoAwAALCgCaAu0ACwLtAAsCOwLtAAtu8UgAygDAA24ACwNvAAu0VsQAAzsAABCkjUIpAAsAUIusOggWcgMeBxVsGwL67U/2HlzmWOEeOgALASvuAAseAfpKUpnpGgYJDCIZM6YyARUE9ThqAD5iXQgnAJYJPnOzw0ZAEZxEKsIAkA4DhAHnTAIDxxUDK0lxCQlPYgIvIQVYJQBVqE1GakUAKGYiDToSBA1EtAYAXQJYAIF8GgMHRyAAIAjOe9YncekRAA0KACUrjwE7Ayc6AAYWAqaiKG4McEcqANoN3+Mg9TwCBhIkuCny+JwUQ29L008JluRxu3K+oAdqiHOqFH0AG5SUIfUJ5SxCGfxdipRzqTmT4V5Zb+r1Uo4Vm+NqSSEl2mNvR2JhIa8SpYO6ntdwFXHCWTCK8f2+Hxo7uiG3drDycAuKIMP5bhi06ACnqArH1rz4Rqg//lm6SgJGEVbF9xJHISaR6HxqxSnkw6shDnelHKNEfGUXSJRJ1GcsmtJw25xrZMDK9gXSm1/YMkdX4/6NKYOdtk/NQ3/NnDASjTc3fPjIjW/5sVfVObX2oTDWkr1dF9f3kxBsD3/3aQO8hPfRz+e0uEiJqt1161griu7gz8hDDwtpy+F+BWtefnKHZPAxcZoWbnznhJpy0e842j36bcNzGnIEusgGX0a8ZxsnjcSsPDZ09yZ36fCQbriHeQ72JRMILNl6ePPf2HWoVwgWAm1fb3V2sAY0+B6rAXqSwPBgseVmoqsBTSrm91+XasMYYySI8eeRxH3ZvHkMz3BQ5aJ3iUVbYPNM3/7emRtjlsMgv/9VyTsyt/mK+8fgWeT6SoFaclXqn42dAIsvAarF5vNNWHzKSkKQ/8Hfk5ZWK7r9yliOsooyBjRhfkHP4Q2DkWXQi6FG/9r/IwbmkV5T7JSopHKn1pJwm9tb5Ot0oyN1Z2mPpKXHTxx2nlK08fKk1hEYA8WgVVWL5lgx0iTv+KdojJeU23ZDjmiubXOxVXJKKi2Wjuh2HLZOFLiSC7Tls5SMh4f+Pj6xUSrNjFqLGehRNB8lC0QSLNmkJJx/wSG3MnjE9T1CkPwJI0wH2lfzwETIiVqUxg0dfu5q39Gt+hwdcxkhhNvQ4TyrBceof3Mhs/IxFci1HmHr4FMZgXEEczPiGCx0HRwzAqDq2j9AVm1kwN0mRVLWLylgtoPNapF5cY4Y1wJh/e0BBwZj44YgZrDNqvD/9Hv7GFYdUQeDJuQ3EWI4HaKqavU1XjC/n41kT4L79kqGq0kLhdTZvgP3TA3fS0ozVz+5piZsoOtIvBUFoMKbNcmBL6YxxaUAusHB38XrS8dQMnQwJfUUkpRoGr5AUeWicvBTzyK9g77+yCkf5PAysL7r/JjcZgrbvRpMW9iyaxZvKO6ceZN2EwIxKwVFPuvFuiEPGCoagbMo+SpydLrXqBzNCDGFCrO/rkcwa2xhokQZ5CdZ0AsU3JfSqJ6n5I14YA+P/uAgfhPU84Tlw7cEFfp7AEE8ey4sP12PTt4Cods1GRgDOB5xvyiR5m+Bx8O5nBCNctU8BevfV5A08x6RHd5jcwPTMDSZJOedIZ1cGQ704lxbAzqZOP05ZxaOghzSdvFBHYqomATARyAADK4elP8Ly3IrUZKfWh23Xy20uBUmLS4Pfagu9+oyVa2iPgqRP3F2CTUsvJ7+RYnN8fFZbU/HVvxvcFFDKkiTqV5UBZ3Gz54JAKByi9hkKMZJvuGgcSYXFmw08UyoQyVdfTD1/dMkCHXcTGAKeROgArsvmRrQTLUOXioOHGK2QkjHuoYFgXciZoTJd6Fs5q1QX1G+p/e26hYsEf7QZD1nnIyl/SFkNtYYmmBhpBrxl9WbY0YpHWRuw2Ll/tj9mD8P4snVzJl4F9J+1arVeTb9E5r2ILH04qStjxQNwn3m4YNqxmaNbLAqW2TN6LidwuJRqS+NXbtqxoeDXpxeGWmxzSkWxjkyCkX4NQRme6q5SAcC+M7+9ETfA/EwrzQajKakCwYyeunP6ZFlxU2oMEn1Pz31zeStW74G406ZJFCl1wAXIoUKkWotYEpOuXB1uVNxJ63dpJEqfxBeptwIHNrPz8BllZoIcBoXwgfJ+8VAUnVPvRvexnw0Ma/WiGYuJO5y8QTvEYBigFmhUxY5RqzE8OcywN/8m4UYrlaniJO75XQ6KSo9+tWHlu+hMi0UVdiKQp7NelnoZUzNaIyBPVeOwK6GNp+FfHuPOoyhaWuNvTYFkvxscMQWDh+zeFCFkgwbXftiV23ywJ4+uwRqmg9k3KzwIQpzppt8DBBOMbrqwQM5Gb05sEwdKzMiAqOloaA/lr0KA+1pr0/+HiWoiIjHA/wir2nIuS3PeU/ji3O6ZwoxcR1SZ9FhtLC5S0FIzFhbBWcGVP/KpxOPSiUoAdWUpqKH++6Scz507iCcxYI6rdMBICPJZea7OcmeFw5mObJSiqpjg2UoWNIs+cFhyDSt6geV5qgi3FunmwwDoGSMgerFOZGX1m0dMCYo5XOruxO063dwENK9DbnVM9wYFREzh4vyU1WYYJ/LRRp6oxgjqP/X5a8/4Af6p6NWkQferzBmXme0zY/4nwMJm/wd1tIqSwGz+E3xPEAOoZlJit3XddD7/BT1pllzOx+8bmQtANQ/S6fZexc6qi3W+Q2xcmXTUhuS5mpHQRvcxZUN0S5+PL9lXWUAaRZhEH8hTdAcuNMMCuVNKTEGtSUKNi3O6KhSaTzck8csZ2vWRZ+d7mW8c4IKwXIYd25S/zIftPkwPzufjEvOHWVD1m+FjpDVUTV0DGDuHj6QnaEwLu/dEgdLQOg9E1Sro9XHJ8ykLAwtPu+pxqKDuFexqON1sKQm7rwbE1E68UCfA/erovrTCG+DBSNg0l4goDQvZN6uNlbyLpcZAwj2UclycvLpIZMgv4yRlpb3YuMftozorbcGVHt/VeDV3+Fdf1TP0iuaCsPi2G4XeGhsyF1ubVDxkoJhmniQ0/jSg/eYML9KLfnCFgISWkp91eauR3IQvED0nAPXK+6hPCYs+n3+hCZbiskmVMG2da+0EsZPonUeIY8EbfusQXjsK/eFDaosbPjEfQS0RKG7yj5GG69M7MeO1HmiUYocgygJHL6M1qzUDDwUSmr99V7Sdr2F3JjQAJY+F0yH33Iv3+C9M38eML7gTgmNu/r2bUMiPvpYbZ6v1/IaESirBHNa7mPKn4dEmYg7v/+HQgPN1G79jBQ1+soydfDC2r+h2Bl/KIc5KjMK7OH6nb1jLsNf0EHVe2KBiE51ox636uyG6Lho0t3J34L5QY/ilE3mikaF4HKXG1mG1rCevT1Vv6GavltxoQe/bMrpZvRggnBxSEPEeEzkEdOxTnPXHVjUYdw8JYvjB/o7Eegc3Ma+NUxLLnsK0kJlinPmUHzHGtrk5+CAbVzFOBqpyy3QVUnzTDfC/0XD94/okH+OB+i7g9lolhWIjSnfIb+Eq43ZXOWmwvjyV/qqD+t0e+7mTEM74qP/Ozt8nmC7mRpyu63OB4KnUzFc074SqoyPUAgM+/TJGFo6T44EHnQU4X4z6qannVqgw/U7zCpwcmXV1AubIrvOmkKHazJAR55ePjp5tLBsN8vAqs3NAHdcEHOR2xQ0lsNAFzSUuxFQCFYvXLZJdOj9p4fNq6p0HBGUik2YzaI4xySy91KzhQ0+q1hjxvImRwPRf76tChlRkhRCi74NXZ9qUNeIwP+s5p+3m5nwPdNOHgSLD79n7O9m1n1uDHiMntq4nkYwV5OZ1ENbXxFd4PgrlvavZsyUO4MqYlqqn1O8W/I1dEZq5dXhrbETLaZIbC2Kj/Aa/QM+fqUOHdf0tXAQ1huZ3cmWECWSXy/43j35+Mvq9xws7JKseriZ1pEWKc8qlzNrGPUGcVgOa9cPJYIJsGnJTAUsEcDOEVULO5x0rXBijc1lgXEzQQKhROf8zIV82w8eswc78YX11KYLWQRcgHNJElBxfXr72lS2RBSl07qTKorO2uUDZr3sFhYsvnhLZn0A94KRzJ/7DEGIAhW5ZWFpL8gEwu1aLA9MuWZzNwl8Oze9Y+bX+v9gywRVnoB5I/8kXTXU3141yRLYrIOOz6SOnyHNy4SieqzkBXharjfjqq1q6tklaEbA8Qfm2DaIPs7OTq/nvJBjKfO2H9bH2cCMh1+5gspfycu8f/cuuRmtDjyqZ7uCIMyjdV3a+p3fqmXsRx4C8lujezIFHnQiVTXLXuI1XrwN3+siYYj2HHTvESUx8DlOTXpak9qFRK+L3mgJ1WsD7F4cu1aJoFoYQnu+wGDMOjJM3kiBQWHCcvhJ/HRdxodOQp45YZaOTA22Nb4XKCVxqkbwMYFhzYQYIAnCW8FW14uf98jhUG2zrKhQQ0q0CEq0t5nXyvUyvR8DvD69LU+g3i+HFWQMQ8PqZuHD+sNKAV0+M6EJC0szq7rEr7B5bQ8BcNHzvDMc9eqB5ZCQdTf80Obn4uzjwpYU7SISdtV0QGa9D3Wrh2BDQtpBKxaNFV+/Cy2P/Sv+8s7Ud0Fd74X4+o/TNztWgETUapy+majNQ68Lq3ee0ZO48VEbTZYiH1Co4OlfWef82RWeyUXo7woM03PyapGfikTnQinoNq5z5veLpeMV3HCAMTaZmA1oGLAn7XS3XYsz+XK7VMQsc4XKrmDXOLU/pSXVNUq8dIqTba///3x6LiLS6xs1xuCAYSfcQ3+rQgmu7uvf3THKt5Ooo97TqcbRqxx7EASizaQCBQllG/rYxVapMLgtLbZS64w1MDBMXX+PQpBKNwqUKOf2DDRDUXQf9EhOS0Qj4nTmlA8dzSLz/G1d+Ud8MTy/6ghhdiLpeerGY/UlDOfiuqFsMUU5/UYlP+BAmgRLuNpvrUaLlVkrqDievNVEAwF+4CoM1MZTmjxjJMsKJq+u8Zd7tNCUFy6LiyYXRJQ4VyvEQFFaCGKsxIwQkk7EzZ6LTJq2hUuPhvAW+gQnSG6J+MszC+7QCRHcnqDdyNRJ6T9xyS87A6MDutbzKGvGktpbXqtzWtXb9HsfK2cBMomjN9a4y+TaJLnXxAeX/HWzmf4cR4vALt/P4w4qgKY04ml4ZdLOinFYS6cup3G/1ie4+t1eOnpBNlqGqs75ilzkT4+DsZQxNvaSKJ//6zIbbk/M7LOhFmRc/1R+kBtz7JFGdZm/COotIdvQoXpTqP/1uqEUmCb/QWoGLMwO5ANcHzxdY48IGP5+J+zKOTBFZ4Pid+GTM+Wq12MV/H86xEJptBa6T+p3kgpwLedManBHC2GgNrFpoN2xnrMz9WFWX/8/ygSBkavq2Uv7FdCsLEYLu9LLIvAU0bNRDtzYl+/vXmjpIvuJFYjmI0im6QEYqnIeMsNjXG4vIutIGHijeAG/9EDBozKV5cldkHbLxHh25vT+ZEzbhXlqvpzKJwcEgfNwLAKFeo0/pvEE10XDB+EXRTXtSzJozQKFFAJhMxYkVaCW+E9AL7tMeU8acxidHqzb6lX4691UsDpy/LLRmT+epgW56+5Cw8tB4kMUv6s9lh3eRKbyGs+H/4mQMaYzPTf2OOdokEn+zzgvoD3FqNKk8QqGAXVsqcGdXrT62fSPkR2vROFi68A6se86UxRUk4cajfPyCC4G5wDhD+zNq4jodQ4u4n/m37Lr36n4LIAAsVr02dFi9AiwA81MYs2rm4eDlDNmdMRvEKRHfBwW5DdMNp0jPFZMeARqF/wL4XBfd+EMLBfMzpH5GH6NaW+1vrvMdg+VxDzatk3MXgO3ro3P/DpcC6+Mo4MySJhKJhSR01SGGGp5hPWmrrUgrv3lDnP+HhcI3nt3YqBoVAVTBAQT5iuhTg8nvPtd8ZeYj6w1x6RqGUBrSku7+N1+BaasZvjTk64RoIDlL8brpEcJx3OmY7jLoZsswdtmhfC/G21llXhITOwmvRDDeTTPbyASOa16cF5/A1fZAidJpqju3wYAy9avPR1ya6eNp9K8XYrrtuxlqi+bDKwlfrYdR0RRiKRVTLOH85+ZY7XSmzRpfZBJjaTa81VDcJHpZnZnSQLASGYW9l51ZV/h7eVzTi3Hv6hUsgc/51AqJRTkpbFVLXXszoBL8nBX0u/0jBLT8nH+fJePbrwURT58OY+UieRjd1vs04w0VG5VN2U6MoGZkQzKN/ptz0Q366dxoTGmj7i1NQGHi9GgnquXFYdrCfZBmeb7s0T6yrdlZH5cZuwHFyIJ/kAtGsTg0xH5taAAq44BAk1CPk9KVVbqQzrCUiFdF/6gtlPQ8bHHc1G1W92MXGZ5HEHftyLYs8mbD/9xYRUWkHmlM0zC2ilJlnNgV4bfALpQghxOUoZL7VTqtCHIaQSXm+YUMnpkXybnV+A6xlm2CVy8fn0Xlm2XRa0+zzOa21JWWmixfiPMSCZ7qA4rS93VN3pkpF1s5TonQjisHf7iU9ZGvUPOAKZcR1pbeVf/Ul7OhepGCaId9wOtqo7pJ7yLcBZ0pFkOF28y4zEI/kcUNmutBHaQpBdNM8vjCS6HZRokkeo88TBAjGyG7SR+6vUgTcyK9Imalj0kuxz0wmK+byQU11AiJFk/ya5dNduRClcnU64yGu/ieWSeOos1t3ep+RPIWQ2pyTYVbZltTbsb7NiwSi3AV+8KLWk7LxCnfZUetEM8ThnsSoGH38/nyAwFguJp8FjvlHtcWZuU4hPva0rHfr0UhOOJ/F6vS62FW7KzkmRll2HEc7oUq4fyi5T70Vl7YVIfsPHUCdHesf9Lk7WNVWO75JDkYbMI8TOW8JKVtLY9d6UJRITO8oKo0xS+o99Yy04iniGHAaGj88kEWgwv0OrHdY/nr76DOGNS59hXCGXzTKUvDl9iKpLSWYN1lxIeyywdNpTkhay74w2jFT6NS8qkjo5CxA1yfSYwp6AJIZNKIeEK5PJAW7ORgWgwp0VgzYpqovMrWxbu+DGZ6Lhie1RAqpzm8VUzKJOH3mCzWuTOLsN3VT/dv2eeYe9UjbR8YTBsLz7q60VN1sU51k+um1f8JxD5pPhbhSC8rRaB454tmh6YUWrJI3+GWY0qeWioj/tbkYITOkJaeuGt4JrJvHA+l0Gu7kY7XOaa05alMnRWVCXqFgLIwSY4uF59Ue5SU4QKuc/HamDxbr0x6csCetXGoP7Qn1Bk/J9DsynO/UD6iZ1Hyrz+jit0hDCwi/E9OjgKTbB3ZQKQ/0ZOvevfNHG0NK4Aj3Cp7NpRk07RT1i/S0EL93Ag8GRgKI9CfpajKyK6+Jj/PI1KO5/85VAwz2AwzP8FTBb075IxCXv6T9RVvWT2tUaqxDS92zrGUbWzUYk9mSs82pECH+fkqsDt93VW++4YsR/dHCYcQSYTO/KaBMDj9LSD/J/+z20Kq8XvZUAIHtm9hRPP3ItbuAu2Hm5lkPs92pd7kCxgRs0xOVBnZ13ccdA0aunrwv9SdqElJRC3g+oCu+nXyCgmXUs9yMjTMAIHfxZV+aPKcZeUBWt057Xo85Ks1Ir5gzEHCWqZEhrLZMuF11ziGtFQUds/EESajhagzcKsxamcSZxGth4UII+adPhQkUnx2WyN+4YWR+r3f8MnkyGFuR4zjzxJS8WsQYR5PTyRaD9ixa6Mh741nBHbzfjXHskGDq179xaRNrCIB1z1xRfWfjqw2pHc1zk9xlPpL8sQWAIuETZZhbnmL54rceXVNRvUiKrrqIkeogsl0XXb17ylNb0f4GA9Wd44vffEG8FSZGHEL2fbaTGRcSiCeA8PmA/f6Hz8HCS76fXUHwgwkzSwlI71ekZ7Fapmlk/KC+Hs8hUcw3N2LN5LhkVYyizYFl/uPeVP5lsoJHhhfWvvSWruCUW1ZcJOeuTbrDgywJ/qG07gZJplnTvLcYdNaH0KMYOYMGX+rB4NGPFmQsNaIwlWrfCezxre8zXBrsMT+edVLbLqN1BqB76JH4BvZTqUIMfGwPGEn+EnmTV86fPBaYbFL3DFEhjB45CewkXEAtJxk4/Ms2pPXnaRqdky0HOYdcUcE2zcXq4vaIvW2/v0nHFJH2XXe22ueDmq/18XGtELSq85j9X8q0tcNSSKJIX8FTuJF/Pf8j5PhqG2u+osvsLxYrvvfeVJL+4tkcXcr9JV7v0ERmj/X6fM3NC4j6dS1+9Umr2oPavqiAydTZPLMNRGY23LO9zAVDly7jD+70G5TPPLdhRIl4WxcYjLnM+SNcJ26FOrkrISUtPObIz5Zb3AG612krnpy15RMW+1cQjlnWFI6538qky9axd2oJmHIHP08KyP0ubGO+TQNOYuv2uh17yCIvR8VcStw7o1g0NM60sk+8Tq7YfIBJrtp53GkvzXH7OA0p8/n/u1satf/VJhtR1l8Wa6Gmaug7haSpaCaYQax6ta0mkutlb+eAOSG1aobM81D9A4iS1RRlzBBoVX6tU1S6WE2N9ORY6DfeLRC4l9Rvr5h95XDWB2mR1d4WFudpsgVYwiTwT31ljskD8ZyDOlm5DkGh9N/UB/0AI5Xvb8ZBmai2hQ4BWMqFwYnzxwB26YHSOv9WgY3JXnvoN+2R4rqGVh/LLDMtpFP+SpMGJNWvbIl5SOodbCczW2RKleksPoUeGEzrjtKHVdtZA+kfqO+rVx/iclCqwoopepvJpSTDjT+b9GWylGRF8EDbGlw6eUzmJM95Ovoz+kwLX3c2fTjFeYEsE7vUZm3mqdGJuKh2w9/QGSaqRHs99aScGOdDqkFcACoqdbBoQqqjamhH6Q9ng39JCg3lrGJwd50Qk9ovnqBTr8MME7Ps2wiVfygUmPoUBJJfJWX5Nda0nuncbFkA=="))}const No=Bg();new Set(Ro(No)),new Set(Ro(No)),Og(No),qg(No),new xe(Lh),new Uint8Array(32).fill(0);const kg=`Ethereum Signed Message:
`;function $h(r){return typeof r=="string"&&(r=Ga(r)),Va(lg([Ga(kg),Ga(String(r.length)),r]))}const Ug="rlp/5.7.0";new xe(Ug);const jg="address/5.7.0",Ds=new xe(jg);function Jh(r){yr(r,20)||Ds.throwArgumentError("invalid address","address",r),r=r.toLowerCase();const e=r.substring(2).split(""),t=new Uint8Array(40);for(let a=0;a<40;a++)t[a]=e[a].charCodeAt(0);const s=Ct(Va(t));for(let a=0;a<40;a+=2)s[a>>1]>>4>=8&&(e[a]=e[a].toUpperCase()),(s[a>>1]&15)>=8&&(e[a+1]=e[a+1].toUpperCase());return"0x"+e.join("")}const zg=9007199254740991;function Lg(r){return Math.log10?Math.log10(r):Math.log(r)/Math.LN10}const Wa={};for(let r=0;r<10;r++)Wa[String(r)]=String(r);for(let r=0;r<26;r++)Wa[String.fromCharCode(65+r)]=String(10+r);const Qh=Math.floor(Lg(zg));function Kg(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let e=r.split("").map(s=>Wa[s]).join("");for(;e.length>=Qh;){let s=e.substring(0,Qh);e=parseInt(s,10)%97+e.substring(s.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}function Hg(r){let e=null;if(typeof r!="string"&&Ds.throwArgumentError("invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/))r.substring(0,2)!=="0x"&&(r="0x"+r),e=Jh(r),r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&e!==r&&Ds.throwArgumentError("bad address checksum","address",r);else if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(r.substring(2,4)!==Kg(r)&&Ds.throwArgumentError("bad icap checksum","address",r),e=yg(r.substring(4));e.length<40;)e="0"+e;e=Jh("0x"+e)}else Ds.throwArgumentError("invalid address","address",r);return e}const Vg="properties/5.7.0";new xe(Vg);function Ts(r,e,t){Object.defineProperty(r,e,{enumerable:!0,value:t,writable:!1})}new xe(Lh),new Uint8Array(32).fill(0),St.from(-1);const $g=St.from(0),Jg=St.from(1);St.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),ri(Jg.toHexString(),32),ri($g.toHexString(),32);var ii={},De={},qs=Gh;function Gh(r,e){if(!r)throw new Error(e||"Assertion failed")}Gh.equal=function(r,e,t){if(r!=e)throw new Error(t||"Assertion failed: "+r+" != "+e)};var Za={exports:{}};typeof Object.create=="function"?Za.exports=function(r,e){e&&(r.super_=e,r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:Za.exports=function(r,e){if(e){r.super_=e;var t=function(){};t.prototype=e.prototype,r.prototype=new t,r.prototype.constructor=r}};var Qg=qs,Gg=Za.exports;De.inherits=Gg;function Yg(r,e){return(r.charCodeAt(e)&64512)!==55296||e<0||e+1>=r.length?!1:(r.charCodeAt(e+1)&64512)===56320}function Wg(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r=="string")if(e){if(e==="hex")for(r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!==0&&(r="0"+r),a=0;a<r.length;a+=2)t.push(parseInt(r[a]+r[a+1],16))}else for(var s=0,a=0;a<r.length;a++){var u=r.charCodeAt(a);u<128?t[s++]=u:u<2048?(t[s++]=u>>6|192,t[s++]=u&63|128):Yg(r,a)?(u=65536+((u&1023)<<10)+(r.charCodeAt(++a)&1023),t[s++]=u>>18|240,t[s++]=u>>12&63|128,t[s++]=u>>6&63|128,t[s++]=u&63|128):(t[s++]=u>>12|224,t[s++]=u>>6&63|128,t[s++]=u&63|128)}else for(a=0;a<r.length;a++)t[a]=r[a]|0;return t}De.toArray=Wg;function Zg(r){for(var e="",t=0;t<r.length;t++)e+=Wh(r[t].toString(16));return e}De.toHex=Zg;function Yh(r){var e=r>>>24|r>>>8&65280|r<<8&16711680|(r&255)<<24;return e>>>0}De.htonl=Yh;function Xg(r,e){for(var t="",s=0;s<r.length;s++){var a=r[s];e==="little"&&(a=Yh(a)),t+=Zh(a.toString(16))}return t}De.toHex32=Xg;function Wh(r){return r.length===1?"0"+r:r}De.zero2=Wh;function Zh(r){return r.length===7?"0"+r:r.length===6?"00"+r:r.length===5?"000"+r:r.length===4?"0000"+r:r.length===3?"00000"+r:r.length===2?"000000"+r:r.length===1?"0000000"+r:r}De.zero8=Zh;function e1(r,e,t,s){var a=t-e;Qg(a%4===0);for(var u=new Array(a/4),f=0,m=e;f<u.length;f++,m+=4){var b;s==="big"?b=r[m]<<24|r[m+1]<<16|r[m+2]<<8|r[m+3]:b=r[m+3]<<24|r[m+2]<<16|r[m+1]<<8|r[m],u[f]=b>>>0}return u}De.join32=e1;function t1(r,e){for(var t=new Array(r.length*4),s=0,a=0;s<r.length;s++,a+=4){var u=r[s];e==="big"?(t[a]=u>>>24,t[a+1]=u>>>16&255,t[a+2]=u>>>8&255,t[a+3]=u&255):(t[a+3]=u>>>24,t[a+2]=u>>>16&255,t[a+1]=u>>>8&255,t[a]=u&255)}return t}De.split32=t1;function r1(r,e){return r>>>e|r<<32-e}De.rotr32=r1;function i1(r,e){return r<<e|r>>>32-e}De.rotl32=i1;function n1(r,e){return r+e>>>0}De.sum32=n1;function s1(r,e,t){return r+e+t>>>0}De.sum32_3=s1;function o1(r,e,t,s){return r+e+t+s>>>0}De.sum32_4=o1;function a1(r,e,t,s,a){return r+e+t+s+a>>>0}De.sum32_5=a1;function c1(r,e,t,s){var a=r[e],u=r[e+1],f=s+u>>>0,m=(f<s?1:0)+t+a;r[e]=m>>>0,r[e+1]=f}De.sum64=c1;function u1(r,e,t,s){var a=e+s>>>0,u=(a<e?1:0)+r+t;return u>>>0}De.sum64_hi=u1;function h1(r,e,t,s){var a=e+s;return a>>>0}De.sum64_lo=h1;function l1(r,e,t,s,a,u,f,m){var b=0,w=e;w=w+s>>>0,b+=w<e?1:0,w=w+u>>>0,b+=w<u?1:0,w=w+m>>>0,b+=w<m?1:0;var P=r+t+a+f+b;return P>>>0}De.sum64_4_hi=l1;function f1(r,e,t,s,a,u,f,m){var b=e+s+u+m;return b>>>0}De.sum64_4_lo=f1;function d1(r,e,t,s,a,u,f,m,b,w){var P=0,R=e;R=R+s>>>0,P+=R<e?1:0,R=R+u>>>0,P+=R<u?1:0,R=R+m>>>0,P+=R<m?1:0,R=R+w>>>0,P+=R<w?1:0;var F=r+t+a+f+b+P;return F>>>0}De.sum64_5_hi=d1;function p1(r,e,t,s,a,u,f,m,b,w){var P=e+s+u+m+w;return P>>>0}De.sum64_5_lo=p1;function g1(r,e,t){var s=e<<32-t|r>>>t;return s>>>0}De.rotr64_hi=g1;function m1(r,e,t){var s=r<<32-t|e>>>t;return s>>>0}De.rotr64_lo=m1;function v1(r,e,t){return r>>>t}De.shr64_hi=v1;function y1(r,e,t){var s=r<<32-t|e>>>t;return s>>>0}De.shr64_lo=y1;var Wn={},Xh=De,w1=qs;function Co(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}Wn.BlockHash=Co,Co.prototype.update=function(r,e){if(r=Xh.toArray(r,e),this.pending?this.pending=this.pending.concat(r):this.pending=r,this.pendingTotal+=r.length,this.pending.length>=this._delta8){r=this.pending;var t=r.length%this._delta8;this.pending=r.slice(r.length-t,r.length),this.pending.length===0&&(this.pending=null),r=Xh.join32(r,0,r.length-t,this.endian);for(var s=0;s<r.length;s+=this._delta32)this._update(r,s,s+this._delta32)}return this},Co.prototype.digest=function(r){return this.update(this._pad()),w1(this.pending===null),this._digest(r)},Co.prototype._pad=function(){var r=this.pendingTotal,e=this._delta8,t=e-(r+this.padLength)%e,s=new Array(t+this.padLength);s[0]=128;for(var a=1;a<t;a++)s[a]=0;if(r<<=3,this.endian==="big"){for(var u=8;u<this.padLength;u++)s[a++]=0;s[a++]=0,s[a++]=0,s[a++]=0,s[a++]=0,s[a++]=r>>>24&255,s[a++]=r>>>16&255,s[a++]=r>>>8&255,s[a++]=r&255}else for(s[a++]=r&255,s[a++]=r>>>8&255,s[a++]=r>>>16&255,s[a++]=r>>>24&255,s[a++]=0,s[a++]=0,s[a++]=0,s[a++]=0,u=8;u<this.padLength;u++)s[a++]=0;return s};var Zn={},ni={},b1=De,si=b1.rotr32;function _1(r,e,t,s){if(r===0)return el(e,t,s);if(r===1||r===3)return rl(e,t,s);if(r===2)return tl(e,t,s)}ni.ft_1=_1;function el(r,e,t){return r&e^~r&t}ni.ch32=el;function tl(r,e,t){return r&e^r&t^e&t}ni.maj32=tl;function rl(r,e,t){return r^e^t}ni.p32=rl;function A1(r){return si(r,2)^si(r,13)^si(r,22)}ni.s0_256=A1;function E1(r){return si(r,6)^si(r,11)^si(r,25)}ni.s1_256=E1;function I1(r){return si(r,7)^si(r,18)^r>>>3}ni.g0_256=I1;function S1(r){return si(r,17)^si(r,19)^r>>>10}ni.g1_256=S1;var Xn=De,x1=Wn,P1=ni,Xa=Xn.rotl32,Bs=Xn.sum32,M1=Xn.sum32_5,R1=P1.ft_1,il=x1.BlockHash,N1=[1518500249,1859775393,2400959708,3395469782];function oi(){if(!(this instanceof oi))return new oi;il.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}Xn.inherits(oi,il);var C1=oi;oi.blockSize=512,oi.outSize=160,oi.hmacStrength=80,oi.padLength=64,oi.prototype._update=function(r,e){for(var t=this.W,s=0;s<16;s++)t[s]=r[e+s];for(;s<t.length;s++)t[s]=Xa(t[s-3]^t[s-8]^t[s-14]^t[s-16],1);var a=this.h[0],u=this.h[1],f=this.h[2],m=this.h[3],b=this.h[4];for(s=0;s<t.length;s++){var w=~~(s/20),P=M1(Xa(a,5),R1(w,u,f,m),b,t[s],N1[w]);b=m,m=f,f=Xa(u,30),u=a,a=P}this.h[0]=Bs(this.h[0],a),this.h[1]=Bs(this.h[1],u),this.h[2]=Bs(this.h[2],f),this.h[3]=Bs(this.h[3],m),this.h[4]=Bs(this.h[4],b)},oi.prototype._digest=function(r){return r==="hex"?Xn.toHex32(this.h,"big"):Xn.split32(this.h,"big")};var es=De,O1=Wn,ts=ni,F1=qs,Kr=es.sum32,D1=es.sum32_4,T1=es.sum32_5,q1=ts.ch32,B1=ts.maj32,k1=ts.s0_256,U1=ts.s1_256,j1=ts.g0_256,z1=ts.g1_256,nl=O1.BlockHash,L1=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function ai(){if(!(this instanceof ai))return new ai;nl.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=L1,this.W=new Array(64)}es.inherits(ai,nl);var sl=ai;ai.blockSize=512,ai.outSize=256,ai.hmacStrength=192,ai.padLength=64,ai.prototype._update=function(r,e){for(var t=this.W,s=0;s<16;s++)t[s]=r[e+s];for(;s<t.length;s++)t[s]=D1(z1(t[s-2]),t[s-7],j1(t[s-15]),t[s-16]);var a=this.h[0],u=this.h[1],f=this.h[2],m=this.h[3],b=this.h[4],w=this.h[5],P=this.h[6],R=this.h[7];for(F1(this.k.length===t.length),s=0;s<t.length;s++){var F=T1(R,U1(b),q1(b,w,P),this.k[s],t[s]),B=Kr(k1(a),B1(a,u,f));R=P,P=w,w=b,b=Kr(m,F),m=f,f=u,u=a,a=Kr(F,B)}this.h[0]=Kr(this.h[0],a),this.h[1]=Kr(this.h[1],u),this.h[2]=Kr(this.h[2],f),this.h[3]=Kr(this.h[3],m),this.h[4]=Kr(this.h[4],b),this.h[5]=Kr(this.h[5],w),this.h[6]=Kr(this.h[6],P),this.h[7]=Kr(this.h[7],R)},ai.prototype._digest=function(r){return r==="hex"?es.toHex32(this.h,"big"):es.split32(this.h,"big")};var ec=De,ol=sl;function Ni(){if(!(this instanceof Ni))return new Ni;ol.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}ec.inherits(Ni,ol);var K1=Ni;Ni.blockSize=512,Ni.outSize=224,Ni.hmacStrength=192,Ni.padLength=64,Ni.prototype._digest=function(r){return r==="hex"?ec.toHex32(this.h.slice(0,7),"big"):ec.split32(this.h.slice(0,7),"big")};var lr=De,H1=Wn,V1=qs,ci=lr.rotr64_hi,ui=lr.rotr64_lo,al=lr.shr64_hi,cl=lr.shr64_lo,en=lr.sum64,tc=lr.sum64_hi,rc=lr.sum64_lo,$1=lr.sum64_4_hi,J1=lr.sum64_4_lo,Q1=lr.sum64_5_hi,G1=lr.sum64_5_lo,ul=H1.BlockHash,Y1=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Hr(){if(!(this instanceof Hr))return new Hr;ul.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=Y1,this.W=new Array(160)}lr.inherits(Hr,ul);var hl=Hr;Hr.blockSize=1024,Hr.outSize=512,Hr.hmacStrength=192,Hr.padLength=128,Hr.prototype._prepareBlock=function(r,e){for(var t=this.W,s=0;s<32;s++)t[s]=r[e+s];for(;s<t.length;s+=2){var a=am(t[s-4],t[s-3]),u=cm(t[s-4],t[s-3]),f=t[s-14],m=t[s-13],b=sm(t[s-30],t[s-29]),w=om(t[s-30],t[s-29]),P=t[s-32],R=t[s-31];t[s]=$1(a,u,f,m,b,w,P,R),t[s+1]=J1(a,u,f,m,b,w,P,R)}},Hr.prototype._update=function(r,e){this._prepareBlock(r,e);var t=this.W,s=this.h[0],a=this.h[1],u=this.h[2],f=this.h[3],m=this.h[4],b=this.h[5],w=this.h[6],P=this.h[7],R=this.h[8],F=this.h[9],B=this.h[10],k=this.h[11],L=this.h[12],H=this.h[13],ee=this.h[14],pe=this.h[15];V1(this.k.length===t.length);for(var de=0;de<t.length;de+=2){var oe=ee,re=pe,ue=im(R,F),be=nm(R,F),_e=W1(R,F,B,k,L),Ve=Z1(R,F,B,k,L,H),Ht=this.k[de],qe=this.k[de+1],kt=t[de],l=t[de+1],g=Q1(oe,re,ue,be,_e,Ve,Ht,qe,kt,l),A=G1(oe,re,ue,be,_e,Ve,Ht,qe,kt,l);oe=tm(s,a),re=rm(s,a),ue=X1(s,a,u,f,m),be=em(s,a,u,f,m,b);var S=tc(oe,re,ue,be),M=rc(oe,re,ue,be);ee=L,pe=H,L=B,H=k,B=R,k=F,R=tc(w,P,g,A),F=rc(P,P,g,A),w=m,P=b,m=u,b=f,u=s,f=a,s=tc(g,A,S,M),a=rc(g,A,S,M)}en(this.h,0,s,a),en(this.h,2,u,f),en(this.h,4,m,b),en(this.h,6,w,P),en(this.h,8,R,F),en(this.h,10,B,k),en(this.h,12,L,H),en(this.h,14,ee,pe)},Hr.prototype._digest=function(r){return r==="hex"?lr.toHex32(this.h,"big"):lr.split32(this.h,"big")};function W1(r,e,t,s,a){var u=r&t^~r&a;return u<0&&(u+=4294967296),u}function Z1(r,e,t,s,a,u){var f=e&s^~e&u;return f<0&&(f+=4294967296),f}function X1(r,e,t,s,a){var u=r&t^r&a^t&a;return u<0&&(u+=4294967296),u}function em(r,e,t,s,a,u){var f=e&s^e&u^s&u;return f<0&&(f+=4294967296),f}function tm(r,e){var t=ci(r,e,28),s=ci(e,r,2),a=ci(e,r,7),u=t^s^a;return u<0&&(u+=4294967296),u}function rm(r,e){var t=ui(r,e,28),s=ui(e,r,2),a=ui(e,r,7),u=t^s^a;return u<0&&(u+=4294967296),u}function im(r,e){var t=ci(r,e,14),s=ci(r,e,18),a=ci(e,r,9),u=t^s^a;return u<0&&(u+=4294967296),u}function nm(r,e){var t=ui(r,e,14),s=ui(r,e,18),a=ui(e,r,9),u=t^s^a;return u<0&&(u+=4294967296),u}function sm(r,e){var t=ci(r,e,1),s=ci(r,e,8),a=al(r,e,7),u=t^s^a;return u<0&&(u+=4294967296),u}function om(r,e){var t=ui(r,e,1),s=ui(r,e,8),a=cl(r,e,7),u=t^s^a;return u<0&&(u+=4294967296),u}function am(r,e){var t=ci(r,e,19),s=ci(e,r,29),a=al(r,e,6),u=t^s^a;return u<0&&(u+=4294967296),u}function cm(r,e){var t=ui(r,e,19),s=ui(e,r,29),a=cl(r,e,6),u=t^s^a;return u<0&&(u+=4294967296),u}var ic=De,ll=hl;function Ci(){if(!(this instanceof Ci))return new Ci;ll.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}ic.inherits(Ci,ll);var um=Ci;Ci.blockSize=1024,Ci.outSize=384,Ci.hmacStrength=192,Ci.padLength=128,Ci.prototype._digest=function(r){return r==="hex"?ic.toHex32(this.h.slice(0,12),"big"):ic.split32(this.h.slice(0,12),"big")},Zn.sha1=C1,Zn.sha224=K1,Zn.sha256=sl,Zn.sha384=um,Zn.sha512=hl;var fl={},An=De,hm=Wn,Oo=An.rotl32,dl=An.sum32,ks=An.sum32_3,pl=An.sum32_4,gl=hm.BlockHash;function hi(){if(!(this instanceof hi))return new hi;gl.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}An.inherits(hi,gl),fl.ripemd160=hi,hi.blockSize=512,hi.outSize=160,hi.hmacStrength=192,hi.padLength=64,hi.prototype._update=function(r,e){for(var t=this.h[0],s=this.h[1],a=this.h[2],u=this.h[3],f=this.h[4],m=t,b=s,w=a,P=u,R=f,F=0;F<80;F++){var B=dl(Oo(pl(t,ml(F,s,a,u),r[dm[F]+e],lm(F)),gm[F]),f);t=f,f=u,u=Oo(a,10),a=s,s=B,B=dl(Oo(pl(m,ml(79-F,b,w,P),r[pm[F]+e],fm(F)),mm[F]),R),m=R,R=P,P=Oo(w,10),w=b,b=B}B=ks(this.h[1],a,P),this.h[1]=ks(this.h[2],u,R),this.h[2]=ks(this.h[3],f,m),this.h[3]=ks(this.h[4],t,b),this.h[4]=ks(this.h[0],s,w),this.h[0]=B},hi.prototype._digest=function(r){return r==="hex"?An.toHex32(this.h,"little"):An.split32(this.h,"little")};function ml(r,e,t,s){return r<=15?e^t^s:r<=31?e&t|~e&s:r<=47?(e|~t)^s:r<=63?e&s|t&~s:e^(t|~s)}function lm(r){return r<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838}function fm(r){return r<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0}var dm=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],pm=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],gm=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],mm=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],vm=De,ym=qs;function rs(r,e,t){if(!(this instanceof rs))return new rs(r,e,t);this.Hash=r,this.blockSize=r.blockSize/8,this.outSize=r.outSize/8,this.inner=null,this.outer=null,this._init(vm.toArray(e,t))}var wm=rs;rs.prototype._init=function(r){r.length>this.blockSize&&(r=new this.Hash().update(r).digest()),ym(r.length<=this.blockSize);for(var e=r.length;e<this.blockSize;e++)r.push(0);for(e=0;e<r.length;e++)r[e]^=54;for(this.inner=new this.Hash().update(r),e=0;e<r.length;e++)r[e]^=106;this.outer=new this.Hash().update(r)},rs.prototype.update=function(r,e){return this.inner.update(r,e),this},rs.prototype.digest=function(r){return this.outer.update(this.inner.digest()),this.outer.digest(r)},function(r){var e=r;e.utils=De,e.common=Wn,e.sha=Zn,e.ripemd=fl,e.hmac=wm,e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160}(ii);function is(r,e,t){return t={path:e,exports:{},require:function(s,a){return bm(s,a??t.path)}},r(t,t.exports),t.exports}function bm(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var nc=vl;function vl(r,e){if(!r)throw new Error(e||"Assertion failed")}vl.equal=function(r,e,t){if(r!=e)throw new Error(t||"Assertion failed: "+r+" != "+e)};var Vr=is(function(r,e){var t=e;function s(f,m){if(Array.isArray(f))return f.slice();if(!f)return[];var b=[];if(typeof f!="string"){for(var w=0;w<f.length;w++)b[w]=f[w]|0;return b}if(m==="hex"){f=f.replace(/[^a-z0-9]+/ig,""),f.length%2!==0&&(f="0"+f);for(var w=0;w<f.length;w+=2)b.push(parseInt(f[w]+f[w+1],16))}else for(var w=0;w<f.length;w++){var P=f.charCodeAt(w),R=P>>8,F=P&255;R?b.push(R,F):b.push(F)}return b}t.toArray=s;function a(f){return f.length===1?"0"+f:f}t.zero2=a;function u(f){for(var m="",b=0;b<f.length;b++)m+=a(f[b].toString(16));return m}t.toHex=u,t.encode=function(f,m){return m==="hex"?u(f):f}}),wr=is(function(r,e){var t=e;t.assert=nc,t.toArray=Vr.toArray,t.zero2=Vr.zero2,t.toHex=Vr.toHex,t.encode=Vr.encode;function s(b,w,P){var R=new Array(Math.max(b.bitLength(),P)+1);R.fill(0);for(var F=1<<w+1,B=b.clone(),k=0;k<R.length;k++){var L,H=B.andln(F-1);B.isOdd()?(H>(F>>1)-1?L=(F>>1)-H:L=H,B.isubn(L)):L=0,R[k]=L,B.iushrn(1)}return R}t.getNAF=s;function a(b,w){var P=[[],[]];b=b.clone(),w=w.clone();for(var R=0,F=0,B;b.cmpn(-R)>0||w.cmpn(-F)>0;){var k=b.andln(3)+R&3,L=w.andln(3)+F&3;k===3&&(k=-1),L===3&&(L=-1);var H;k&1?(B=b.andln(7)+R&7,(B===3||B===5)&&L===2?H=-k:H=k):H=0,P[0].push(H);var ee;L&1?(B=w.andln(7)+F&7,(B===3||B===5)&&k===2?ee=-L:ee=L):ee=0,P[1].push(ee),2*R===H+1&&(R=1-R),2*F===ee+1&&(F=1-F),b.iushrn(1),w.iushrn(1)}return P}t.getJSF=a;function u(b,w,P){var R="_"+w;b.prototype[w]=function(){return this[R]!==void 0?this[R]:this[R]=P.call(this)}}t.cachedProperty=u;function f(b){return typeof b=="string"?t.toArray(b,"hex"):b}t.parseBytes=f;function m(b){return new Ie(b,"hex","le")}t.intFromLE=m}),Fo=wr.getNAF,_m=wr.getJSF,Do=wr.assert;function tn(r,e){this.type=r,this.p=new Ie(e.p,16),this.red=e.prime?Ie.red(e.prime):Ie.mont(this.p),this.zero=new Ie(0).toRed(this.red),this.one=new Ie(1).toRed(this.red),this.two=new Ie(2).toRed(this.red),this.n=e.n&&new Ie(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var En=tn;tn.prototype.point=function(){throw new Error("Not implemented")},tn.prototype.validate=function(){throw new Error("Not implemented")},tn.prototype._fixedNafMul=function(r,e){Do(r.precomputed);var t=r._getDoubles(),s=Fo(e,1,this._bitLength),a=(1<<t.step+1)-(t.step%2===0?2:1);a/=3;var u=[],f,m;for(f=0;f<s.length;f+=t.step){m=0;for(var b=f+t.step-1;b>=f;b--)m=(m<<1)+s[b];u.push(m)}for(var w=this.jpoint(null,null,null),P=this.jpoint(null,null,null),R=a;R>0;R--){for(f=0;f<u.length;f++)m=u[f],m===R?P=P.mixedAdd(t.points[f]):m===-R&&(P=P.mixedAdd(t.points[f].neg()));w=w.add(P)}return w.toP()},tn.prototype._wnafMul=function(r,e){var t=4,s=r._getNAFPoints(t);t=s.wnd;for(var a=s.points,u=Fo(e,t,this._bitLength),f=this.jpoint(null,null,null),m=u.length-1;m>=0;m--){for(var b=0;m>=0&&u[m]===0;m--)b++;if(m>=0&&b++,f=f.dblp(b),m<0)break;var w=u[m];Do(w!==0),r.type==="affine"?w>0?f=f.mixedAdd(a[w-1>>1]):f=f.mixedAdd(a[-w-1>>1].neg()):w>0?f=f.add(a[w-1>>1]):f=f.add(a[-w-1>>1].neg())}return r.type==="affine"?f.toP():f},tn.prototype._wnafMulAdd=function(r,e,t,s,a){var u=this._wnafT1,f=this._wnafT2,m=this._wnafT3,b=0,w,P,R;for(w=0;w<s;w++){R=e[w];var F=R._getNAFPoints(r);u[w]=F.wnd,f[w]=F.points}for(w=s-1;w>=1;w-=2){var B=w-1,k=w;if(u[B]!==1||u[k]!==1){m[B]=Fo(t[B],u[B],this._bitLength),m[k]=Fo(t[k],u[k],this._bitLength),b=Math.max(m[B].length,b),b=Math.max(m[k].length,b);continue}var L=[e[B],null,null,e[k]];e[B].y.cmp(e[k].y)===0?(L[1]=e[B].add(e[k]),L[2]=e[B].toJ().mixedAdd(e[k].neg())):e[B].y.cmp(e[k].y.redNeg())===0?(L[1]=e[B].toJ().mixedAdd(e[k]),L[2]=e[B].add(e[k].neg())):(L[1]=e[B].toJ().mixedAdd(e[k]),L[2]=e[B].toJ().mixedAdd(e[k].neg()));var H=[-3,-1,-5,-7,0,7,5,1,3],ee=_m(t[B],t[k]);for(b=Math.max(ee[0].length,b),m[B]=new Array(b),m[k]=new Array(b),P=0;P<b;P++){var pe=ee[0][P]|0,de=ee[1][P]|0;m[B][P]=H[(pe+1)*3+(de+1)],m[k][P]=0,f[B]=L}}var oe=this.jpoint(null,null,null),re=this._wnafT4;for(w=b;w>=0;w--){for(var ue=0;w>=0;){var be=!0;for(P=0;P<s;P++)re[P]=m[P][w]|0,re[P]!==0&&(be=!1);if(!be)break;ue++,w--}if(w>=0&&ue++,oe=oe.dblp(ue),w<0)break;for(P=0;P<s;P++){var _e=re[P];_e!==0&&(_e>0?R=f[P][_e-1>>1]:_e<0&&(R=f[P][-_e-1>>1].neg()),R.type==="affine"?oe=oe.mixedAdd(R):oe=oe.add(R))}}for(w=0;w<s;w++)f[w]=null;return a?oe:oe.toP()};function Mr(r,e){this.curve=r,this.type=e,this.precomputed=null}tn.BasePoint=Mr,Mr.prototype.eq=function(){throw new Error("Not implemented")},Mr.prototype.validate=function(){return this.curve.validate(this)},tn.prototype.decodePoint=function(r,e){r=wr.toArray(r,e);var t=this.p.byteLength();if((r[0]===4||r[0]===6||r[0]===7)&&r.length-1===2*t){r[0]===6?Do(r[r.length-1]%2===0):r[0]===7&&Do(r[r.length-1]%2===1);var s=this.point(r.slice(1,1+t),r.slice(1+t,1+2*t));return s}else if((r[0]===2||r[0]===3)&&r.length-1===t)return this.pointFromX(r.slice(1,1+t),r[0]===3);throw new Error("Unknown point format")},Mr.prototype.encodeCompressed=function(r){return this.encode(r,!0)},Mr.prototype._encode=function(r){var e=this.curve.p.byteLength(),t=this.getX().toArray("be",e);return r?[this.getY().isEven()?2:3].concat(t):[4].concat(t,this.getY().toArray("be",e))},Mr.prototype.encode=function(r,e){return wr.encode(this._encode(e),r)},Mr.prototype.precompute=function(r){if(this.precomputed)return this;var e={doubles:null,naf:null,beta:null};return e.naf=this._getNAFPoints(8),e.doubles=this._getDoubles(4,r),e.beta=this._getBeta(),this.precomputed=e,this},Mr.prototype._hasDoubles=function(r){if(!this.precomputed)return!1;var e=this.precomputed.doubles;return e?e.points.length>=Math.ceil((r.bitLength()+1)/e.step):!1},Mr.prototype._getDoubles=function(r,e){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var t=[this],s=this,a=0;a<e;a+=r){for(var u=0;u<r;u++)s=s.dbl();t.push(s)}return{step:r,points:t}},Mr.prototype._getNAFPoints=function(r){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var e=[this],t=(1<<r)-1,s=t===1?null:this.dbl(),a=1;a<t;a++)e[a]=e[a-1].add(s);return{wnd:r,points:e}},Mr.prototype._getBeta=function(){return null},Mr.prototype.dblp=function(r){for(var e=this,t=0;t<r;t++)e=e.dbl();return e};var sc=is(function(r){typeof Object.create=="function"?r.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:r.exports=function(e,t){if(t){e.super_=t;var s=function(){};s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e}}}),Am=wr.assert;function Rr(r){En.call(this,"short",r),this.a=new Ie(r.a,16).toRed(this.red),this.b=new Ie(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}sc(Rr,En);var Em=Rr;Rr.prototype._getEndomorphism=function(r){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var e,t;if(r.beta)e=new Ie(r.beta,16).toRed(this.red);else{var s=this._getEndoRoots(this.p);e=s[0].cmp(s[1])<0?s[0]:s[1],e=e.toRed(this.red)}if(r.lambda)t=new Ie(r.lambda,16);else{var a=this._getEndoRoots(this.n);this.g.mul(a[0]).x.cmp(this.g.x.redMul(e))===0?t=a[0]:(t=a[1],Am(this.g.mul(t).x.cmp(this.g.x.redMul(e))===0))}var u;return r.basis?u=r.basis.map(function(f){return{a:new Ie(f.a,16),b:new Ie(f.b,16)}}):u=this._getEndoBasis(t),{beta:e,lambda:t,basis:u}}},Rr.prototype._getEndoRoots=function(r){var e=r===this.p?this.red:Ie.mont(r),t=new Ie(2).toRed(e).redInvm(),s=t.redNeg(),a=new Ie(3).toRed(e).redNeg().redSqrt().redMul(t),u=s.redAdd(a).fromRed(),f=s.redSub(a).fromRed();return[u,f]},Rr.prototype._getEndoBasis=function(r){for(var e=this.n.ushrn(Math.floor(this.n.bitLength()/2)),t=r,s=this.n.clone(),a=new Ie(1),u=new Ie(0),f=new Ie(0),m=new Ie(1),b,w,P,R,F,B,k,L=0,H,ee;t.cmpn(0)!==0;){var pe=s.div(t);H=s.sub(pe.mul(t)),ee=f.sub(pe.mul(a));var de=m.sub(pe.mul(u));if(!P&&H.cmp(e)<0)b=k.neg(),w=a,P=H.neg(),R=ee;else if(P&&++L===2)break;k=H,s=t,t=H,f=a,a=ee,m=u,u=de}F=H.neg(),B=ee;var oe=P.sqr().add(R.sqr()),re=F.sqr().add(B.sqr());return re.cmp(oe)>=0&&(F=b,B=w),P.negative&&(P=P.neg(),R=R.neg()),F.negative&&(F=F.neg(),B=B.neg()),[{a:P,b:R},{a:F,b:B}]},Rr.prototype._endoSplit=function(r){var e=this.endo.basis,t=e[0],s=e[1],a=s.b.mul(r).divRound(this.n),u=t.b.neg().mul(r).divRound(this.n),f=a.mul(t.a),m=u.mul(s.a),b=a.mul(t.b),w=u.mul(s.b),P=r.sub(f).sub(m),R=b.add(w).neg();return{k1:P,k2:R}},Rr.prototype.pointFromX=function(r,e){r=new Ie(r,16),r.red||(r=r.toRed(this.red));var t=r.redSqr().redMul(r).redIAdd(r.redMul(this.a)).redIAdd(this.b),s=t.redSqrt();if(s.redSqr().redSub(t).cmp(this.zero)!==0)throw new Error("invalid point");var a=s.fromRed().isOdd();return(e&&!a||!e&&a)&&(s=s.redNeg()),this.point(r,s)},Rr.prototype.validate=function(r){if(r.inf)return!0;var e=r.x,t=r.y,s=this.a.redMul(e),a=e.redSqr().redMul(e).redIAdd(s).redIAdd(this.b);return t.redSqr().redISub(a).cmpn(0)===0},Rr.prototype._endoWnafMulAdd=function(r,e,t){for(var s=this._endoWnafT1,a=this._endoWnafT2,u=0;u<r.length;u++){var f=this._endoSplit(e[u]),m=r[u],b=m._getBeta();f.k1.negative&&(f.k1.ineg(),m=m.neg(!0)),f.k2.negative&&(f.k2.ineg(),b=b.neg(!0)),s[u*2]=m,s[u*2+1]=b,a[u*2]=f.k1,a[u*2+1]=f.k2}for(var w=this._wnafMulAdd(1,s,a,u*2,t),P=0;P<u*2;P++)s[P]=null,a[P]=null;return w};function Kt(r,e,t,s){En.BasePoint.call(this,r,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Ie(e,16),this.y=new Ie(t,16),s&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}sc(Kt,En.BasePoint),Rr.prototype.point=function(r,e,t){return new Kt(this,r,e,t)},Rr.prototype.pointFromJSON=function(r,e){return Kt.fromJSON(this,r,e)},Kt.prototype._getBeta=function(){if(this.curve.endo){var r=this.precomputed;if(r&&r.beta)return r.beta;var e=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(r){var t=this.curve,s=function(a){return t.point(a.x.redMul(t.endo.beta),a.y)};r.beta=e,e.precomputed={beta:null,naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(s)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(s)}}}return e}},Kt.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},Kt.fromJSON=function(r,e,t){typeof e=="string"&&(e=JSON.parse(e));var s=r.point(e[0],e[1],t);if(!e[2])return s;function a(f){return r.point(f[0],f[1],t)}var u=e[2];return s.precomputed={beta:null,doubles:u.doubles&&{step:u.doubles.step,points:[s].concat(u.doubles.points.map(a))},naf:u.naf&&{wnd:u.naf.wnd,points:[s].concat(u.naf.points.map(a))}},s},Kt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},Kt.prototype.isInfinity=function(){return this.inf},Kt.prototype.add=function(r){if(this.inf)return r;if(r.inf)return this;if(this.eq(r))return this.dbl();if(this.neg().eq(r))return this.curve.point(null,null);if(this.x.cmp(r.x)===0)return this.curve.point(null,null);var e=this.y.redSub(r.y);e.cmpn(0)!==0&&(e=e.redMul(this.x.redSub(r.x).redInvm()));var t=e.redSqr().redISub(this.x).redISub(r.x),s=e.redMul(this.x.redSub(t)).redISub(this.y);return this.curve.point(t,s)},Kt.prototype.dbl=function(){if(this.inf)return this;var r=this.y.redAdd(this.y);if(r.cmpn(0)===0)return this.curve.point(null,null);var e=this.curve.a,t=this.x.redSqr(),s=r.redInvm(),a=t.redAdd(t).redIAdd(t).redIAdd(e).redMul(s),u=a.redSqr().redISub(this.x.redAdd(this.x)),f=a.redMul(this.x.redSub(u)).redISub(this.y);return this.curve.point(u,f)},Kt.prototype.getX=function(){return this.x.fromRed()},Kt.prototype.getY=function(){return this.y.fromRed()},Kt.prototype.mul=function(r){return r=new Ie(r,16),this.isInfinity()?this:this._hasDoubles(r)?this.curve._fixedNafMul(this,r):this.curve.endo?this.curve._endoWnafMulAdd([this],[r]):this.curve._wnafMul(this,r)},Kt.prototype.mulAdd=function(r,e,t){var s=[this,e],a=[r,t];return this.curve.endo?this.curve._endoWnafMulAdd(s,a):this.curve._wnafMulAdd(1,s,a,2)},Kt.prototype.jmulAdd=function(r,e,t){var s=[this,e],a=[r,t];return this.curve.endo?this.curve._endoWnafMulAdd(s,a,!0):this.curve._wnafMulAdd(1,s,a,2,!0)},Kt.prototype.eq=function(r){return this===r||this.inf===r.inf&&(this.inf||this.x.cmp(r.x)===0&&this.y.cmp(r.y)===0)},Kt.prototype.neg=function(r){if(this.inf)return this;var e=this.curve.point(this.x,this.y.redNeg());if(r&&this.precomputed){var t=this.precomputed,s=function(a){return a.neg()};e.precomputed={naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(s)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(s)}}}return e},Kt.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var r=this.curve.jpoint(this.x,this.y,this.curve.one);return r};function Qt(r,e,t,s){En.BasePoint.call(this,r,"jacobian"),e===null&&t===null&&s===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Ie(0)):(this.x=new Ie(e,16),this.y=new Ie(t,16),this.z=new Ie(s,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}sc(Qt,En.BasePoint),Rr.prototype.jpoint=function(r,e,t){return new Qt(this,r,e,t)},Qt.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var r=this.z.redInvm(),e=r.redSqr(),t=this.x.redMul(e),s=this.y.redMul(e).redMul(r);return this.curve.point(t,s)},Qt.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},Qt.prototype.add=function(r){if(this.isInfinity())return r;if(r.isInfinity())return this;var e=r.z.redSqr(),t=this.z.redSqr(),s=this.x.redMul(e),a=r.x.redMul(t),u=this.y.redMul(e.redMul(r.z)),f=r.y.redMul(t.redMul(this.z)),m=s.redSub(a),b=u.redSub(f);if(m.cmpn(0)===0)return b.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var w=m.redSqr(),P=w.redMul(m),R=s.redMul(w),F=b.redSqr().redIAdd(P).redISub(R).redISub(R),B=b.redMul(R.redISub(F)).redISub(u.redMul(P)),k=this.z.redMul(r.z).redMul(m);return this.curve.jpoint(F,B,k)},Qt.prototype.mixedAdd=function(r){if(this.isInfinity())return r.toJ();if(r.isInfinity())return this;var e=this.z.redSqr(),t=this.x,s=r.x.redMul(e),a=this.y,u=r.y.redMul(e).redMul(this.z),f=t.redSub(s),m=a.redSub(u);if(f.cmpn(0)===0)return m.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var b=f.redSqr(),w=b.redMul(f),P=t.redMul(b),R=m.redSqr().redIAdd(w).redISub(P).redISub(P),F=m.redMul(P.redISub(R)).redISub(a.redMul(w)),B=this.z.redMul(f);return this.curve.jpoint(R,F,B)},Qt.prototype.dblp=function(r){if(r===0)return this;if(this.isInfinity())return this;if(!r)return this.dbl();var e;if(this.curve.zeroA||this.curve.threeA){var t=this;for(e=0;e<r;e++)t=t.dbl();return t}var s=this.curve.a,a=this.curve.tinv,u=this.x,f=this.y,m=this.z,b=m.redSqr().redSqr(),w=f.redAdd(f);for(e=0;e<r;e++){var P=u.redSqr(),R=w.redSqr(),F=R.redSqr(),B=P.redAdd(P).redIAdd(P).redIAdd(s.redMul(b)),k=u.redMul(R),L=B.redSqr().redISub(k.redAdd(k)),H=k.redISub(L),ee=B.redMul(H);ee=ee.redIAdd(ee).redISub(F);var pe=w.redMul(m);e+1<r&&(b=b.redMul(F)),u=L,m=pe,w=ee}return this.curve.jpoint(u,w.redMul(a),m)},Qt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},Qt.prototype._zeroDbl=function(){var r,e,t;if(this.zOne){var s=this.x.redSqr(),a=this.y.redSqr(),u=a.redSqr(),f=this.x.redAdd(a).redSqr().redISub(s).redISub(u);f=f.redIAdd(f);var m=s.redAdd(s).redIAdd(s),b=m.redSqr().redISub(f).redISub(f),w=u.redIAdd(u);w=w.redIAdd(w),w=w.redIAdd(w),r=b,e=m.redMul(f.redISub(b)).redISub(w),t=this.y.redAdd(this.y)}else{var P=this.x.redSqr(),R=this.y.redSqr(),F=R.redSqr(),B=this.x.redAdd(R).redSqr().redISub(P).redISub(F);B=B.redIAdd(B);var k=P.redAdd(P).redIAdd(P),L=k.redSqr(),H=F.redIAdd(F);H=H.redIAdd(H),H=H.redIAdd(H),r=L.redISub(B).redISub(B),e=k.redMul(B.redISub(r)).redISub(H),t=this.y.redMul(this.z),t=t.redIAdd(t)}return this.curve.jpoint(r,e,t)},Qt.prototype._threeDbl=function(){var r,e,t;if(this.zOne){var s=this.x.redSqr(),a=this.y.redSqr(),u=a.redSqr(),f=this.x.redAdd(a).redSqr().redISub(s).redISub(u);f=f.redIAdd(f);var m=s.redAdd(s).redIAdd(s).redIAdd(this.curve.a),b=m.redSqr().redISub(f).redISub(f);r=b;var w=u.redIAdd(u);w=w.redIAdd(w),w=w.redIAdd(w),e=m.redMul(f.redISub(b)).redISub(w),t=this.y.redAdd(this.y)}else{var P=this.z.redSqr(),R=this.y.redSqr(),F=this.x.redMul(R),B=this.x.redSub(P).redMul(this.x.redAdd(P));B=B.redAdd(B).redIAdd(B);var k=F.redIAdd(F);k=k.redIAdd(k);var L=k.redAdd(k);r=B.redSqr().redISub(L),t=this.y.redAdd(this.z).redSqr().redISub(R).redISub(P);var H=R.redSqr();H=H.redIAdd(H),H=H.redIAdd(H),H=H.redIAdd(H),e=B.redMul(k.redISub(r)).redISub(H)}return this.curve.jpoint(r,e,t)},Qt.prototype._dbl=function(){var r=this.curve.a,e=this.x,t=this.y,s=this.z,a=s.redSqr().redSqr(),u=e.redSqr(),f=t.redSqr(),m=u.redAdd(u).redIAdd(u).redIAdd(r.redMul(a)),b=e.redAdd(e);b=b.redIAdd(b);var w=b.redMul(f),P=m.redSqr().redISub(w.redAdd(w)),R=w.redISub(P),F=f.redSqr();F=F.redIAdd(F),F=F.redIAdd(F),F=F.redIAdd(F);var B=m.redMul(R).redISub(F),k=t.redAdd(t).redMul(s);return this.curve.jpoint(P,B,k)},Qt.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var r=this.x.redSqr(),e=this.y.redSqr(),t=this.z.redSqr(),s=e.redSqr(),a=r.redAdd(r).redIAdd(r),u=a.redSqr(),f=this.x.redAdd(e).redSqr().redISub(r).redISub(s);f=f.redIAdd(f),f=f.redAdd(f).redIAdd(f),f=f.redISub(u);var m=f.redSqr(),b=s.redIAdd(s);b=b.redIAdd(b),b=b.redIAdd(b),b=b.redIAdd(b);var w=a.redIAdd(f).redSqr().redISub(u).redISub(m).redISub(b),P=e.redMul(w);P=P.redIAdd(P),P=P.redIAdd(P);var R=this.x.redMul(m).redISub(P);R=R.redIAdd(R),R=R.redIAdd(R);var F=this.y.redMul(w.redMul(b.redISub(w)).redISub(f.redMul(m)));F=F.redIAdd(F),F=F.redIAdd(F),F=F.redIAdd(F);var B=this.z.redAdd(f).redSqr().redISub(t).redISub(m);return this.curve.jpoint(R,F,B)},Qt.prototype.mul=function(r,e){return r=new Ie(r,e),this.curve._wnafMul(this,r)},Qt.prototype.eq=function(r){if(r.type==="affine")return this.eq(r.toJ());if(this===r)return!0;var e=this.z.redSqr(),t=r.z.redSqr();if(this.x.redMul(t).redISub(r.x.redMul(e)).cmpn(0)!==0)return!1;var s=e.redMul(this.z),a=t.redMul(r.z);return this.y.redMul(a).redISub(r.y.redMul(s)).cmpn(0)===0},Qt.prototype.eqXToP=function(r){var e=this.z.redSqr(),t=r.toRed(this.curve.red).redMul(e);if(this.x.cmp(t)===0)return!0;for(var s=r.clone(),a=this.curve.redN.redMul(e);;){if(s.iadd(this.curve.n),s.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(a),this.x.cmp(t)===0)return!0}},Qt.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},Qt.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var To=is(function(r,e){var t=e;t.base=En,t.short=Em,t.mont=null,t.edwards=null}),qo=is(function(r,e){var t=e,s=wr.assert;function a(m){m.type==="short"?this.curve=new To.short(m):m.type==="edwards"?this.curve=new To.edwards(m):this.curve=new To.mont(m),this.g=this.curve.g,this.n=this.curve.n,this.hash=m.hash,s(this.g.validate(),"Invalid curve"),s(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}t.PresetCurve=a;function u(m,b){Object.defineProperty(t,m,{configurable:!0,enumerable:!0,get:function(){var w=new a(b);return Object.defineProperty(t,m,{configurable:!0,enumerable:!0,value:w}),w}})}u("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:ii.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),u("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:ii.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),u("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:ii.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),u("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:ii.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),u("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:ii.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),u("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:ii.sha256,gRed:!1,g:["9"]}),u("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:ii.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var f;try{f=null.crash()}catch{f=void 0}u("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:ii.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",f]})});function rn(r){if(!(this instanceof rn))return new rn(r);this.hash=r.hash,this.predResist=!!r.predResist,this.outLen=this.hash.outSize,this.minEntropy=r.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=Vr.toArray(r.entropy,r.entropyEnc||"hex"),t=Vr.toArray(r.nonce,r.nonceEnc||"hex"),s=Vr.toArray(r.pers,r.persEnc||"hex");nc(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,t,s)}var yl=rn;rn.prototype._init=function(r,e,t){var s=r.concat(e).concat(t);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var a=0;a<this.V.length;a++)this.K[a]=0,this.V[a]=1;this._update(s),this._reseed=1,this.reseedInterval=281474976710656},rn.prototype._hmac=function(){return new ii.hmac(this.hash,this.K)},rn.prototype._update=function(r){var e=this._hmac().update(this.V).update([0]);r&&(e=e.update(r)),this.K=e.digest(),this.V=this._hmac().update(this.V).digest(),r&&(this.K=this._hmac().update(this.V).update([1]).update(r).digest(),this.V=this._hmac().update(this.V).digest())},rn.prototype.reseed=function(r,e,t,s){typeof e!="string"&&(s=t,t=e,e=null),r=Vr.toArray(r,e),t=Vr.toArray(t,s),nc(r.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(r.concat(t||[])),this._reseed=1},rn.prototype.generate=function(r,e,t,s){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof e!="string"&&(s=t,t=e,e=null),t&&(t=Vr.toArray(t,s||"hex"),this._update(t));for(var a=[];a.length<r;)this.V=this._hmac().update(this.V).digest(),a=a.concat(this.V);var u=a.slice(0,r);return this._update(t),this._reseed++,Vr.encode(u,e)};var oc=wr.assert;function Xt(r,e){this.ec=r,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var ac=Xt;Xt.fromPublic=function(r,e,t){return e instanceof Xt?e:new Xt(r,{pub:e,pubEnc:t})},Xt.fromPrivate=function(r,e,t){return e instanceof Xt?e:new Xt(r,{priv:e,privEnc:t})},Xt.prototype.validate=function(){var r=this.getPublic();return r.isInfinity()?{result:!1,reason:"Invalid public key"}:r.validate()?r.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},Xt.prototype.getPublic=function(r,e){return typeof r=="string"&&(e=r,r=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),e?this.pub.encode(e,r):this.pub},Xt.prototype.getPrivate=function(r){return r==="hex"?this.priv.toString(16,2):this.priv},Xt.prototype._importPrivate=function(r,e){this.priv=new Ie(r,e||16),this.priv=this.priv.umod(this.ec.curve.n)},Xt.prototype._importPublic=function(r,e){if(r.x||r.y){this.ec.curve.type==="mont"?oc(r.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&oc(r.x&&r.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(r.x,r.y);return}this.pub=this.ec.curve.decodePoint(r,e)},Xt.prototype.derive=function(r){return r.validate()||oc(r.validate(),"public point not validated"),r.mul(this.priv).getX()},Xt.prototype.sign=function(r,e,t){return this.ec.sign(r,this,e,t)},Xt.prototype.verify=function(r,e){return this.ec.verify(r,e,this)},Xt.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var Im=wr.assert;function Bo(r,e){if(r instanceof Bo)return r;this._importDER(r,e)||(Im(r.r&&r.s,"Signature without r or s"),this.r=new Ie(r.r,16),this.s=new Ie(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}var ko=Bo;function Sm(){this.place=0}function cc(r,e){var t=r[e.place++];if(!(t&128))return t;var s=t&15;if(s===0||s>4)return!1;for(var a=0,u=0,f=e.place;u<s;u++,f++)a<<=8,a|=r[f],a>>>=0;return a<=127?!1:(e.place=f,a)}function wl(r){for(var e=0,t=r.length-1;!r[e]&&!(r[e+1]&128)&&e<t;)e++;return e===0?r:r.slice(e)}Bo.prototype._importDER=function(r,e){r=wr.toArray(r,e);var t=new Sm;if(r[t.place++]!==48)return!1;var s=cc(r,t);if(s===!1||s+t.place!==r.length||r[t.place++]!==2)return!1;var a=cc(r,t);if(a===!1)return!1;var u=r.slice(t.place,a+t.place);if(t.place+=a,r[t.place++]!==2)return!1;var f=cc(r,t);if(f===!1||r.length!==f+t.place)return!1;var m=r.slice(t.place,f+t.place);if(u[0]===0)if(u[1]&128)u=u.slice(1);else return!1;if(m[0]===0)if(m[1]&128)m=m.slice(1);else return!1;return this.r=new Ie(u),this.s=new Ie(m),this.recoveryParam=null,!0};function uc(r,e){if(e<128){r.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(r.push(t|128);--t;)r.push(e>>>(t<<3)&255);r.push(e)}Bo.prototype.toDER=function(r){var e=this.r.toArray(),t=this.s.toArray();for(e[0]&128&&(e=[0].concat(e)),t[0]&128&&(t=[0].concat(t)),e=wl(e),t=wl(t);!t[0]&&!(t[1]&128);)t=t.slice(1);var s=[2];uc(s,e.length),s=s.concat(e),s.push(2),uc(s,t.length);var a=s.concat(t),u=[48];return uc(u,a.length),u=u.concat(a),wr.encode(u,r)};var xm=function(){throw new Error("unsupported")},bl=wr.assert;function Nr(r){if(!(this instanceof Nr))return new Nr(r);typeof r=="string"&&(bl(Object.prototype.hasOwnProperty.call(qo,r),"Unknown curve "+r),r=qo[r]),r instanceof qo.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}var Pm=Nr;Nr.prototype.keyPair=function(r){return new ac(this,r)},Nr.prototype.keyFromPrivate=function(r,e){return ac.fromPrivate(this,r,e)},Nr.prototype.keyFromPublic=function(r,e){return ac.fromPublic(this,r,e)},Nr.prototype.genKeyPair=function(r){r||(r={});for(var e=new yl({hash:this.hash,pers:r.pers,persEnc:r.persEnc||"utf8",entropy:r.entropy||xm(this.hash.hmacStrength),entropyEnc:r.entropy&&r.entropyEnc||"utf8",nonce:this.n.toArray()}),t=this.n.byteLength(),s=this.n.sub(new Ie(2));;){var a=new Ie(e.generate(t));if(!(a.cmp(s)>0))return a.iaddn(1),this.keyFromPrivate(a)}},Nr.prototype._truncateToN=function(r,e){var t=r.byteLength()*8-this.n.bitLength();return t>0&&(r=r.ushrn(t)),!e&&r.cmp(this.n)>=0?r.sub(this.n):r},Nr.prototype.sign=function(r,e,t,s){typeof t=="object"&&(s=t,t=null),s||(s={}),e=this.keyFromPrivate(e,t),r=this._truncateToN(new Ie(r,16));for(var a=this.n.byteLength(),u=e.getPrivate().toArray("be",a),f=r.toArray("be",a),m=new yl({hash:this.hash,entropy:u,nonce:f,pers:s.pers,persEnc:s.persEnc||"utf8"}),b=this.n.sub(new Ie(1)),w=0;;w++){var P=s.k?s.k(w):new Ie(m.generate(this.n.byteLength()));if(P=this._truncateToN(P,!0),!(P.cmpn(1)<=0||P.cmp(b)>=0)){var R=this.g.mul(P);if(!R.isInfinity()){var F=R.getX(),B=F.umod(this.n);if(B.cmpn(0)!==0){var k=P.invm(this.n).mul(B.mul(e.getPrivate()).iadd(r));if(k=k.umod(this.n),k.cmpn(0)!==0){var L=(R.getY().isOdd()?1:0)|(F.cmp(B)!==0?2:0);return s.canonical&&k.cmp(this.nh)>0&&(k=this.n.sub(k),L^=1),new ko({r:B,s:k,recoveryParam:L})}}}}}},Nr.prototype.verify=function(r,e,t,s){r=this._truncateToN(new Ie(r,16)),t=this.keyFromPublic(t,s),e=new ko(e,"hex");var a=e.r,u=e.s;if(a.cmpn(1)<0||a.cmp(this.n)>=0||u.cmpn(1)<0||u.cmp(this.n)>=0)return!1;var f=u.invm(this.n),m=f.mul(r).umod(this.n),b=f.mul(a).umod(this.n),w;return this.curve._maxwellTrick?(w=this.g.jmulAdd(m,t.getPublic(),b),w.isInfinity()?!1:w.eqXToP(a)):(w=this.g.mulAdd(m,t.getPublic(),b),w.isInfinity()?!1:w.getX().umod(this.n).cmp(a)===0)},Nr.prototype.recoverPubKey=function(r,e,t,s){bl((3&t)===t,"The recovery param is more than two bits"),e=new ko(e,s);var a=this.n,u=new Ie(r),f=e.r,m=e.s,b=t&1,w=t>>1;if(f.cmp(this.curve.p.umod(this.curve.n))>=0&&w)throw new Error("Unable to find sencond key candinate");w?f=this.curve.pointFromX(f.add(this.curve.n),b):f=this.curve.pointFromX(f,b);var P=e.r.invm(a),R=a.sub(u).mul(P).umod(a),F=m.mul(P).umod(a);return this.g.mulAdd(R,f,F)},Nr.prototype.getKeyRecoveryParam=function(r,e,t,s){if(e=new ko(e,s),e.recoveryParam!==null)return e.recoveryParam;for(var a=0;a<4;a++){var u;try{u=this.recoverPubKey(r,e,a)}catch{continue}if(u.eq(t))return a}throw new Error("Unable to find valid recovery factor")};var Mm=is(function(r,e){var t=e;t.version="6.5.4",t.utils=wr,t.rand=function(){throw new Error("unsupported")},t.curve=To,t.curves=qo,t.ec=Pm,t.eddsa=null}),Rm=Mm.ec;const Nm="signing-key/5.7.0",hc=new xe(Nm);let lc=null;function li(){return lc||(lc=new Rm("secp256k1")),lc}class Cm{constructor(e){Ts(this,"curve","secp256k1"),Ts(this,"privateKey",rr(e)),dg(this.privateKey)!==32&&hc.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const t=li().keyFromPrivate(Ct(this.privateKey));Ts(this,"publicKey","0x"+t.getPublic(!1,"hex")),Ts(this,"compressedPublicKey","0x"+t.getPublic(!0,"hex")),Ts(this,"_isSigningKey",!0)}_addPoint(e){const t=li().keyFromPublic(Ct(this.publicKey)),s=li().keyFromPublic(Ct(e));return"0x"+t.pub.add(s.pub).encodeCompressed("hex")}signDigest(e){const t=li().keyFromPrivate(Ct(this.privateKey)),s=Ct(e);s.length!==32&&hc.throwArgumentError("bad digest length","digest",e);const a=t.sign(s,{canonical:!0});return Nh({recoveryParam:a.recoveryParam,r:ri("0x"+a.r.toString(16),32),s:ri("0x"+a.s.toString(16),32)})}computeSharedSecret(e){const t=li().keyFromPrivate(Ct(this.privateKey)),s=li().keyFromPublic(Ct(_l(e)));return ri("0x"+t.derive(s.getPublic()).toString(16),32)}static isSigningKey(e){return!!(e&&e._isSigningKey)}}function Om(r,e){const t=Nh(e),s={r:Ct(t.r),s:Ct(t.s)};return"0x"+li().recoverPubKey(Ct(r),s,t.recoveryParam).encode("hex",!1)}function _l(r,e){const t=Ct(r);if(t.length===32){const s=new Cm(t);return e?"0x"+li().keyFromPrivate(t).getPublic(!0,"hex"):s.publicKey}else{if(t.length===33)return e?rr(t):"0x"+li().keyFromPublic(t).getPublic(!1,"hex");if(t.length===65)return e?"0x"+li().keyFromPublic(t).getPublic(!0,"hex"):rr(t)}return hc.throwArgumentError("invalid public or private key","key","[REDACTED]")}const Fm="transactions/5.7.0";new xe(Fm);var Al;(function(r){r[r.legacy=0]="legacy",r[r.eip2930=1]="eip2930",r[r.eip1559=2]="eip1559"})(Al||(Al={}));function Dm(r){const e=_l(r);return Hg(Rh(Va(Rh(e,1)),12))}function Tm(r,e){return Dm(Om(Ct(r),e))}const qm="https://rpc.walletconnect.com/v1";async function Bm(r,e,t,s,a,u){switch(t.t){case"eip191":return km(r,e,t.s);case"eip1271":return await Um(r,e,t.s,s,a,u);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}function km(r,e,t){return Tm($h(e),t).toLowerCase()===r.toLowerCase()}async function Um(r,e,t,s,a,u){try{const f="0x1626ba7e",m="0000000000000000000000000000000000000000000000000000000000000040",b="0000000000000000000000000000000000000000000000000000000000000041",w=t.substring(2),P=$h(e).substring(2),R=f+P+m+b+w,F=await fetch(`${u||qm}/?chainId=${s}&projectId=${a}`,{method:"POST",body:JSON.stringify({id:jm(),jsonrpc:"2.0",method:"eth_call",params:[{to:r,data:R},"latest"]})}),{result:B}=await F.json();return B?B.slice(0,f.length).toLowerCase()===f.toLowerCase():!1}catch(f){return console.error("isValidEip1271Signature: ",f),!1}}function jm(){return Date.now()+Math.floor(Math.random()*1e3)}var zm=Object.defineProperty,Lm=Object.defineProperties,Km=Object.getOwnPropertyDescriptors,El=Object.getOwnPropertySymbols,Hm=Object.prototype.hasOwnProperty,Vm=Object.prototype.propertyIsEnumerable,Il=(r,e,t)=>e in r?zm(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,fc=(r,e)=>{for(var t in e||(e={}))Hm.call(e,t)&&Il(r,t,e[t]);if(El)for(var t of El(e))Vm.call(e,t)&&Il(r,t,e[t]);return r},Sl=(r,e)=>Lm(r,Km(e));const $m="did:pkh:",dc=r=>r==null?void 0:r.split(":"),xl=r=>{const e=r&&dc(r);if(e)return r.includes($m)?e[3]:e[1]},Pl=r=>{const e=r&&dc(r);if(e)return e[2]+":"+e[3]},Uo=r=>{const e=r&&dc(r);if(e)return e.pop()};async function Ml(r){const{cacao:e,projectId:t}=r,{s,p:a}=e,u=Rl(a,a.iss),f=Uo(a.iss);return await Bm(f,u,s,xl(a.iss),t)}const Rl=(r,e)=>{const t=`${r.domain} wants you to sign in with your Ethereum account:`,s=Uo(e);if(!r.aud&&!r.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let a=r.statement||void 0;const u=`URI: ${r.aud||r.uri}`,f=`Version: ${r.version}`,m=`Chain ID: ${xl(e)}`,b=`Nonce: ${r.nonce}`,w=`Issued At: ${r.iat}`,P=r.exp?`Expiration Time: ${r.exp}`:void 0,R=r.nbf?`Not Before: ${r.nbf}`:void 0,F=r.requestId?`Request ID: ${r.requestId}`:void 0,B=r.resources?`Resources:${r.resources.map(L=>`
- ${L}`).join("")}`:void 0,k=ns(r.resources);if(k){const L=In(k);a=Ol(a,L)}return[t,s,"",a,"",u,f,m,b,w,P,R,F,B].filter(L=>L!=null).join(`
`)};function wI(r,e,t){return t.includes("did:pkh:")||(t=`did:pkh:${t}`),{h:{t:"caip122"},p:{iss:t,domain:r.domain,aud:r.aud,version:r.version,nonce:r.nonce,iat:r.iat,statement:r.statement,requestId:r.requestId,resources:r.resources,nbf:r.nbf,exp:r.exp},s:e}}function bI(r){var e;const{authPayload:t,chains:s,methods:a}=r,u=t.statement||"";if(!(s!=null&&s.length))return t;const f=t.chains,m=wh(f,s);if(!(m!=null&&m.length))throw new Error("No supported chains");const b=Jm(t.resources);if(!b)return t;Oi(b);const w=Qm(b,"eip155");let P=(t==null?void 0:t.resources)||[];if(w!=null&&w.length){const R=Gm(w),F=wh(R,a);if(!(F!=null&&F.length))throw new Error(`Supported methods don't satisfy the requested: ${JSON.stringify(R)}, supported: ${JSON.stringify(a)}`);const B=Nl("request",F,{chains:m}),k=Xm(b,"eip155",B);P=((e=t==null?void 0:t.resources)==null?void 0:e.slice(0,-1))||[],P.push(pc(k))}return Sl(fc({},t),{statement:iv(u,ns(P)),chains:m,resources:t!=null&&t.resources||P.length>0?P:void 0})}function Jm(r){const e=ns(r);if(e&&Cl(e))return In(e)}function _I(r,e){var t;return(t=r==null?void 0:r.att)==null?void 0:t.hasOwnProperty(e)}function Qm(r,e){var t,s;return(t=r==null?void 0:r.att)!=null&&t[e]?Object.keys((s=r==null?void 0:r.att)==null?void 0:s[e]):[]}function AI(r){return(r==null?void 0:r.map(e=>Object.keys(e)))||[]}function Gm(r){return(r==null?void 0:r.map(e=>{var t;return(t=e.split("/"))==null?void 0:t[1]}))||[]}function Ym(r){return ch.from(JSON.stringify(r)).toString("base64")}function Wm(r){return JSON.parse(ch.from(r,"base64").toString("utf-8"))}function Oi(r){if(!r)throw new Error("No recap provided, value is undefined");if(!r.att)throw new Error("No `att` property found");const e=Object.keys(r.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{const s=r.att[t];if(Array.isArray(s))throw new Error(`Resource must be an object: ${t}`);if(typeof s!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(s).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(s).forEach(a=>{const u=s[a];if(!Array.isArray(u))throw new Error(`Ability limits ${a} must be an array of objects, found: ${u}`);if(!u.length)throw new Error(`Value of ${a} is empty array, must be an array with objects`);u.forEach(f=>{if(typeof f!="object")throw new Error(`Ability limits (${a}) must be an array of objects, found: ${f}`)})})})}function Zm(r,e,t,s={}){return t==null||t.sort((a,u)=>a.localeCompare(u)),{att:{[r]:Nl(e,t,s)}}}function Xm(r,e,t){var s;return r.att[e]=fc({},t),((s=Object.keys(r.att))==null?void 0:s.sort((a,u)=>a.localeCompare(u))).reduce((a,u)=>(a.att[u]=r.att[u],a),{att:{}})}function Nl(r,e,t={}){e=e==null?void 0:e.sort((a,u)=>a.localeCompare(u));const s=e.map(a=>({[`${r}/${a}`]:[t]}));return Object.assign({},...s)}function pc(r){return Oi(r),`urn:recap:${Ym(r).replace(/=/g,"")}`}function In(r){const e=Wm(r.replace("urn:recap:",""));return Oi(e),e}function ev(r,e,t){const s=Zm(r,e,t);return pc(s)}function Cl(r){return r&&r.includes("urn:recap:")}function tv(r,e){const t=In(r),s=In(e),a=rv(t,s);return pc(a)}function rv(r,e){Oi(r),Oi(e);const t=Object.keys(r.att).concat(Object.keys(e.att)).sort((a,u)=>a.localeCompare(u)),s={att:{}};return t.forEach(a=>{var u,f;Object.keys(((u=r.att)==null?void 0:u[a])||{}).concat(Object.keys(((f=e.att)==null?void 0:f[a])||{})).sort((m,b)=>m.localeCompare(b)).forEach(m=>{var b,w;s.att[a]=Sl(fc({},s.att[a]),{[m]:((b=r.att[a])==null?void 0:b[m])||((w=e.att[a])==null?void 0:w[m])})})}),s}function Ol(r="",e){Oi(e);const t="I further authorize the stated URI to perform the following actions on my behalf: ";if(r.includes(t))return r;const s=[];let a=0;Object.keys(e.att).forEach(m=>{const b=Object.keys(e.att[m]).map(R=>({ability:R.split("/")[0],action:R.split("/")[1]}));b.sort((R,F)=>R.action.localeCompare(F.action));const w={};b.forEach(R=>{w[R.ability]||(w[R.ability]=[]),w[R.ability].push(R.action)});const P=Object.keys(w).map(R=>(a++,`(${a}) '${R}': '${w[R].join("', '")}' for '${m}'.`));s.push(P.join(", ").replace(".,","."))});const u=s.join(" "),f=`${t}${u}`;return`${r?r+" ":""}${f}`}function Fl(r){var e;const t=In(r);Oi(t);const s=(e=t.att)==null?void 0:e.eip155;return s?Object.keys(s).map(a=>a.split("/")[1]):[]}function Dl(r){const e=In(r);Oi(e);const t=[];return Object.values(e.att).forEach(s=>{Object.values(s).forEach(a=>{var u;(u=a==null?void 0:a[0])!=null&&u.chains&&t.push(a[0].chains)})}),[...new Set(t.flat())]}function iv(r,e){if(!e)return r;const t=In(e);return Oi(t),Ol(r,t)}function ns(r){if(!r)return;const e=r==null?void 0:r[r.length-1];return Cl(e)?e:void 0}const Tl="base10",nr="base16",gc="base64pad",mc="utf8",ql=0,Fi=1,nv=0,Bl=1,vc=12,yc=32;function sv(){const r=Xu.Au();return{privateKey:(0,Pt.BB)(r.secretKey,nr),publicKey:(0,Pt.BB)(r.publicKey,nr)}}function wc(){const r=(0,Zu.randomBytes)(yc);return(0,Pt.BB)(r,nr)}function ov(r,e){const t=Xu.gi((0,Pt.mL)(r,nr),(0,Pt.mL)(e,nr),!0),s=new R0.t(Ua.mE,t).expand(yc);return(0,Pt.BB)(s,nr)}function jo(r){const e=(0,Ua.vp)((0,Pt.mL)(r,nr));return(0,Pt.BB)(e,nr)}function Sn(r){const e=(0,Ua.vp)((0,Pt.mL)(r,mc));return(0,Pt.BB)(e,nr)}function av(r){return(0,Pt.mL)(`${r}`,Tl)}function Us(r){return Number((0,Pt.BB)(r,Tl))}function cv(r){const e=av(typeof r.type<"u"?r.type:ql);if(Us(e)===Fi&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?(0,Pt.mL)(r.senderPublicKey,nr):void 0,s=typeof r.iv<"u"?(0,Pt.mL)(r.iv,nr):(0,Zu.randomBytes)(vc),a=new Wu.OK((0,Pt.mL)(r.symKey,nr)).seal(s,(0,Pt.mL)(r.message,mc));return hv({type:e,sealed:a,iv:s,senderPublicKey:t})}function uv(r){const e=new Wu.OK((0,Pt.mL)(r.symKey,nr)),{sealed:t,iv:s}=zo(r.encoded),a=e.open(s,t);if(a===null)throw new Error("Failed to decrypt");return(0,Pt.BB)(a,mc)}function hv(r){if(Us(r.type)===Fi){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return(0,Pt.BB)((0,Pt.zo)([r.type,r.senderPublicKey,r.iv,r.sealed]),gc)}return(0,Pt.BB)((0,Pt.zo)([r.type,r.iv,r.sealed]),gc)}function zo(r){const e=(0,Pt.mL)(r,gc),t=e.slice(nv,Bl),s=Bl;if(Us(t)===Fi){const m=s+yc,b=m+vc,w=e.slice(s,m),P=e.slice(m,b),R=e.slice(b);return{type:t,sealed:R,iv:P,senderPublicKey:w}}const a=s+vc,u=e.slice(s,a),f=e.slice(a);return{type:t,sealed:f,iv:u}}function lv(r,e){const t=zo(r);return kl({type:Us(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?(0,Pt.BB)(t.senderPublicKey,nr):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function kl(r){const e=(r==null?void 0:r.type)||ql;if(e===Fi){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function Ul(r){return r.type===Fi&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}const fv="irn";function bc(r){return(r==null?void 0:r.relay)||{protocol:fv}}function js(r){const e=F0[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}var dv=Object.defineProperty,pv=Object.defineProperties,gv=Object.getOwnPropertyDescriptors,jl=Object.getOwnPropertySymbols,mv=Object.prototype.hasOwnProperty,vv=Object.prototype.propertyIsEnumerable,zl=(r,e,t)=>e in r?dv(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ll=(r,e)=>{for(var t in e||(e={}))mv.call(e,t)&&zl(r,t,e[t]);if(jl)for(var t of jl(e))vv.call(e,t)&&zl(r,t,e[t]);return r},yv=(r,e)=>pv(r,gv(e));function wv(r,e="-"){const t={},s="relay"+e;return Object.keys(r).forEach(a=>{if(a.startsWith(s)){const u=a.replace(s,""),f=r[a];t[u]=f}}),t}function Kl(r){r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,s=r.substring(0,e),a=r.substring(e+1,t).split("@"),u=typeof t<"u"?r.substring(t):"",f=Ao.parse(u),m=typeof f.methods=="string"?f.methods.split(","):void 0;return{protocol:s,topic:bv(a[0]),version:parseInt(a[1],10),symKey:f.symKey,relay:wv(f),methods:m,expiryTimestamp:f.expiryTimestamp?parseInt(f.expiryTimestamp,10):void 0}}function bv(r){return r.startsWith("//")?r.substring(2):r}function _v(r,e="-"){const t="relay",s={};return Object.keys(r).forEach(a=>{const u=t+e+a;r[a]&&(s[u]=r[a])}),s}function Av(r){return`${r.protocol}:${r.topic}@${r.version}?`+Ao.stringify(Ll(yv(Ll({symKey:r.symKey},_v(r.relay)),{expiryTimestamp:r.expiryTimestamp}),r.methods?{methods:r.methods.join(",")}:{}))}var Ev=Object.defineProperty,Iv=Object.defineProperties,Sv=Object.getOwnPropertyDescriptors,Hl=Object.getOwnPropertySymbols,xv=Object.prototype.hasOwnProperty,Pv=Object.prototype.propertyIsEnumerable,Vl=(r,e,t)=>e in r?Ev(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Mv=(r,e)=>{for(var t in e||(e={}))xv.call(e,t)&&Vl(r,t,e[t]);if(Hl)for(var t of Hl(e))Pv.call(e,t)&&Vl(r,t,e[t]);return r},Rv=(r,e)=>Iv(r,Sv(e));function ss(r){const e=[];return r.forEach(t=>{const[s,a]=t.split(":");e.push(`${s}:${a}`)}),e}function Nv(r){const e=[];return Object.values(r).forEach(t=>{e.push(...ss(t.accounts))}),e}function Cv(r,e){const t=[];return Object.values(r).forEach(s=>{ss(s.accounts).includes(e)&&t.push(...s.methods)}),t}function Ov(r,e){const t=[];return Object.values(r).forEach(s=>{ss(s.accounts).includes(e)&&t.push(...s.events)}),t}function EI(r,e){const t=Ho(r,e);if(t)throw new Error(t.message);const s={};for(const[a,u]of Object.entries(r))s[a]={methods:u.methods,events:u.events,chains:u.accounts.map(f=>`${f.split(":")[0]}:${f.split(":")[1]}`)};return s}function II(r){const{proposal:{requiredNamespaces:e,optionalNamespaces:t={}},supportedNamespaces:s}=r,a=$l(e),u=$l(t),f={};Object.keys(s).forEach(w=>{const P=s[w].chains,R=s[w].methods,F=s[w].events,B=s[w].accounts;P.forEach(k=>{if(!B.some(L=>L.includes(k)))throw new Error(`No accounts provided for chain ${k} in namespace ${w}`)}),f[w]={chains:P,methods:R,events:F,accounts:B}});const m=Ac(e,f,"approve()");if(m)throw new Error(m.message);const b={};return!Object.keys(e).length&&!Object.keys(t).length?f:(Object.keys(a).forEach(w=>{const P=s[w].chains.filter(k=>{var L,H;return(H=(L=a[w])==null?void 0:L.chains)==null?void 0:H.includes(k)}),R=s[w].methods.filter(k=>{var L,H;return(H=(L=a[w])==null?void 0:L.methods)==null?void 0:H.includes(k)}),F=s[w].events.filter(k=>{var L,H;return(H=(L=a[w])==null?void 0:L.events)==null?void 0:H.includes(k)}),B=P.map(k=>s[w].accounts.filter(L=>L.includes(`${k}:`))).flat();b[w]={chains:P,methods:R,events:F,accounts:B}}),Object.keys(u).forEach(w=>{var P,R,F,B,k,L;if(!s[w])return;const H=(R=(P=u[w])==null?void 0:P.chains)==null?void 0:R.filter(oe=>s[w].chains.includes(oe)),ee=s[w].methods.filter(oe=>{var re,ue;return(ue=(re=u[w])==null?void 0:re.methods)==null?void 0:ue.includes(oe)}),pe=s[w].events.filter(oe=>{var re,ue;return(ue=(re=u[w])==null?void 0:re.events)==null?void 0:ue.includes(oe)}),de=H==null?void 0:H.map(oe=>s[w].accounts.filter(re=>re.includes(`${oe}:`))).flat();b[w]={chains:zr((F=b[w])==null?void 0:F.chains,H),methods:zr((B=b[w])==null?void 0:B.methods,ee),events:zr((k=b[w])==null?void 0:k.events,pe),accounts:zr((L=b[w])==null?void 0:L.accounts,de)}}),b)}function Lo(r){return r.includes(":")}function os(r){return Lo(r)?r.split(":")[0]:r}function $l(r){var e,t,s;const a={};if(!as(r))return a;for(const[u,f]of Object.entries(r)){const m=Lo(u)?[u]:f.chains,b=f.methods||[],w=f.events||[],P=os(u);a[P]=Rv(Mv({},a[P]),{chains:zr(m,(e=a[P])==null?void 0:e.chains),methods:zr(b,(t=a[P])==null?void 0:t.methods),events:zr(w,(s=a[P])==null?void 0:s.events)})}return a}function Fv(r){const e={};return r==null||r.forEach(t=>{const[s,a]=t.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[]}),e[s].accounts.push(t),e[s].chains.push(`${s}:${a}`)}),e}function Jl(r,e){e=e.map(s=>s.replace("did:pkh:",""));const t=Fv(e);for(const[s,a]of Object.entries(t))a.methods?a.methods=zr(a.methods,r):a.methods=r,a.events=["chainChanged","accountsChanged"];return t}const Dv={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Tv={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Y(r,e){const{message:t,code:s}=Tv[r];return{message:e?`${t} ${e}`:t,code:s}}function rt(r,e){const{message:t,code:s}=Dv[r];return{message:e?`${t} ${e}`:t,code:s}}function xn(r,e){return Array.isArray(r)?typeof e<"u"&&r.length?r.every(e):!0:!1}function as(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function sr(r){return typeof r>"u"}function Tt(r,e){return e&&sr(r)?!0:typeof r=="string"&&!!r.trim().length}function _c(r,e){return e&&sr(r)?!0:typeof r=="number"&&!isNaN(r)}function qv(r,e){const{requiredNamespaces:t}=e,s=Object.keys(r.namespaces),a=Object.keys(t);let u=!0;return bn(a,s)?(s.forEach(f=>{const{accounts:m,methods:b,events:w}=r.namespaces[f],P=ss(m),R=t[f];(!bn(ja(f,R),P)||!bn(R.methods,b)||!bn(R.events,w))&&(u=!1)}),u):!1}function Ko(r){return Tt(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function Bv(r){if(Tt(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&Ko(t)}}return!1}function kv(r){if(Tt(r,!1))try{return typeof new URL(r)<"u"}catch{return!1}return!1}function Uv(r){var e;return(e=r==null?void 0:r.proposer)==null?void 0:e.publicKey}function jv(r){return r==null?void 0:r.topic}function zv(r,e){let t=null;return Tt(r==null?void 0:r.publicKey,!1)||(t=Y("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Ql(r){let e=!0;return xn(r)?r.length&&(e=r.every(t=>Tt(t,!1))):e=!1,e}function Lv(r,e,t){let s=null;return xn(e)&&e.length?e.forEach(a=>{s||Ko(a)||(s=rt("UNSUPPORTED_CHAINS",`${t}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Ko(r)||(s=rt("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function Kv(r,e,t){let s=null;return Object.entries(r).forEach(([a,u])=>{if(s)return;const f=Lv(a,ja(a,u),`${e} ${t}`);f&&(s=f)}),s}function Hv(r,e){let t=null;return xn(r)?r.forEach(s=>{t||Bv(s)||(t=rt("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=rt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function Vv(r,e){let t=null;return Object.values(r).forEach(s=>{if(t)return;const a=Hv(s==null?void 0:s.accounts,`${e} namespace`);a&&(t=a)}),t}function $v(r,e){let t=null;return Ql(r==null?void 0:r.methods)?Ql(r==null?void 0:r.events)||(t=rt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=rt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function Gl(r,e){let t=null;return Object.values(r).forEach(s=>{if(t)return;const a=$v(s,`${e}, namespace`);a&&(t=a)}),t}function Jv(r,e,t){let s=null;if(r&&as(r)){const a=Gl(r,e);a&&(s=a);const u=Kv(r,e,t);u&&(s=u)}else s=Y("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function Ho(r,e){let t=null;if(r&&as(r)){const s=Gl(r,e);s&&(t=s);const a=Vv(r,e);a&&(t=a)}else t=Y("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function Yl(r){return Tt(r.protocol,!0)}function Qv(r,e){let t=!1;return e&&!r?t=!0:r&&xn(r)&&r.length&&r.forEach(s=>{t=Yl(s)}),t}function Gv(r){return typeof r=="number"}function fr(r){return typeof r<"u"&&typeof r!==null}function Yv(r){return!(!r||typeof r!="object"||!r.code||!_c(r.code,!1)||!r.message||!Tt(r.message,!1))}function Wv(r){return!(sr(r)||!Tt(r.method,!1))}function Zv(r){return!(sr(r)||sr(r.result)&&sr(r.error)||!_c(r.id,!1)||!Tt(r.jsonrpc,!1))}function Xv(r){return!(sr(r)||!Tt(r.name,!1))}function Wl(r,e){return!(!Ko(e)||!Nv(r).includes(e))}function ey(r,e,t){return Tt(t,!1)?Cv(r,e).includes(t):!1}function ty(r,e,t){return Tt(t,!1)?Ov(r,e).includes(t):!1}function Ac(r,e,t){let s=null;const a=ry(r),u=iy(e),f=Object.keys(a),m=Object.keys(u),b=Zl(Object.keys(r)),w=Zl(Object.keys(e)),P=b.filter(R=>!w.includes(R));return P.length&&(s=Y("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${P.toString()}
      Received: ${Object.keys(e).toString()}`)),bn(f,m)||(s=Y("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${f.toString()}
      Approved: ${m.toString()}`)),Object.keys(e).forEach(R=>{if(!R.includes(":")||s)return;const F=ss(e[R].accounts);F.includes(R)||(s=Y("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${R}
        Required: ${R}
        Approved: ${F.toString()}`))}),f.forEach(R=>{s||(bn(a[R].methods,u[R].methods)?bn(a[R].events,u[R].events)||(s=Y("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${R}`)):s=Y("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${R}`))}),s}function ry(r){const e={};return Object.keys(r).forEach(t=>{var s;t.includes(":")?e[t]=r[t]:(s=r[t].chains)==null||s.forEach(a=>{e[a]={methods:r[t].methods,events:r[t].events}})}),e}function Zl(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function iy(r){const e={};return Object.keys(r).forEach(t=>{if(t.includes(":"))e[t]=r[t];else{const s=ss(r[t].accounts);s==null||s.forEach(a=>{e[a]={accounts:r[t].accounts.filter(u=>u.includes(`${a}:`)),methods:r[t].methods,events:r[t].events}})}}),e}function ny(r,e){return _c(r,!1)&&r<=e.max&&r>=e.min}function Xl(){const r=Vn();return new Promise(e=>{switch(r){case ur.browser:e(sy());break;case ur.reactNative:e(oy());break;case ur.node:e(ay());break;default:e(!0)}})}function sy(){return Hn()&&(navigator==null?void 0:navigator.onLine)}async function oy(){if(Kn()&&typeof ce.g<"u"&&ce.g!=null&&ce.g.NetInfo){const r=await(ce.g==null?void 0:ce.g.NetInfo.fetch());return r==null?void 0:r.isConnected}return!0}function ay(){return!0}function cy(r){switch(Vn()){case ur.browser:uy(r);break;case ur.reactNative:hy(r);break;case ur.node:break}}function uy(r){!Kn()&&Hn()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function hy(r){var e;Kn()&&typeof ce.g<"u"&&ce.g!=null&&ce.g.NetInfo&&((e=ce.g)==null||e.NetInfo.addEventListener(t=>r(t==null?void 0:t.isConnected)))}const Ec={};class zs{static get(e){return Ec[e]}static set(e,t){Ec[e]=t}static delete(e){delete Ec[e]}}var fi=ce(56390),we=ce(23700),ly=ce(66865),fy=ce(5899),dy=ce.n(fy),py=ce(51538),gy=ce.n(py);function my(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var a=0;a<r.length;a++){var u=r.charAt(a),f=u.charCodeAt(0);if(t[f]!==255)throw new TypeError(u+" is ambiguous");t[f]=a}var m=r.length,b=r.charAt(0),w=Math.log(m)/Math.log(256),P=Math.log(256)/Math.log(m);function R(k){if(k instanceof Uint8Array||(ArrayBuffer.isView(k)?k=new Uint8Array(k.buffer,k.byteOffset,k.byteLength):Array.isArray(k)&&(k=Uint8Array.from(k))),!(k instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(k.length===0)return"";for(var L=0,H=0,ee=0,pe=k.length;ee!==pe&&k[ee]===0;)ee++,L++;for(var de=(pe-ee)*P+1>>>0,oe=new Uint8Array(de);ee!==pe;){for(var re=k[ee],ue=0,be=de-1;(re!==0||ue<H)&&be!==-1;be--,ue++)re+=256*oe[be]>>>0,oe[be]=re%m>>>0,re=re/m>>>0;if(re!==0)throw new Error("Non-zero carry");H=ue,ee++}for(var _e=de-H;_e!==de&&oe[_e]===0;)_e++;for(var Ve=b.repeat(L);_e<de;++_e)Ve+=r.charAt(oe[_e]);return Ve}function F(k){if(typeof k!="string")throw new TypeError("Expected String");if(k.length===0)return new Uint8Array;var L=0;if(k[L]!==" "){for(var H=0,ee=0;k[L]===b;)H++,L++;for(var pe=(k.length-L)*w+1>>>0,de=new Uint8Array(pe);k[L];){var oe=t[k.charCodeAt(L)];if(oe===255)return;for(var re=0,ue=pe-1;(oe!==0||re<ee)&&ue!==-1;ue--,re++)oe+=m*de[ue]>>>0,de[ue]=oe%256>>>0,oe=oe/256>>>0;if(oe!==0)throw new Error("Non-zero carry");ee=re,L++}if(k[L]!==" "){for(var be=pe-ee;be!==pe&&de[be]===0;)be++;for(var _e=new Uint8Array(H+(pe-be)),Ve=H;be!==pe;)_e[Ve++]=de[be++];return _e}}}function B(k){var L=F(k);if(L)return L;throw new Error(`Non-${e} character`)}return{encode:R,decodeUnsafe:F,decode:B}}var vy=my,yy=vy;const ef=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},wy=r=>new TextEncoder().encode(r),by=r=>new TextDecoder().decode(r);class _y{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Ay{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return tf(this,e)}}class Ey{constructor(e){this.decoders=e}or(e){return tf(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const tf=(r,e)=>new Ey({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class Iy{constructor(e,t,s,a){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=a,this.encoder=new _y(e,t,s),this.decoder=new Ay(e,t,a)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Vo=({name:r,prefix:e,encode:t,decode:s})=>new Iy(r,e,t,s),Ls=({prefix:r,name:e,alphabet:t})=>{const{encode:s,decode:a}=yy(t,e);return Vo({prefix:r,name:e,encode:s,decode:u=>ef(a(u))})},Sy=(r,e,t,s)=>{const a={};for(let P=0;P<e.length;++P)a[e[P]]=P;let u=r.length;for(;r[u-1]==="=";)--u;const f=new Uint8Array(u*t/8|0);let m=0,b=0,w=0;for(let P=0;P<u;++P){const R=a[r[P]];if(R===void 0)throw new SyntaxError(`Non-${s} character`);b=b<<t|R,m+=t,m>=8&&(m-=8,f[w++]=255&b>>m)}if(m>=t||255&b<<8-m)throw new SyntaxError("Unexpected end of data");return f},xy=(r,e,t)=>{const s=e[e.length-1]==="=",a=(1<<t)-1;let u="",f=0,m=0;for(let b=0;b<r.length;++b)for(m=m<<8|r[b],f+=8;f>t;)f-=t,u+=e[a&m>>f];if(f&&(u+=e[a&m<<t-f]),s)for(;u.length*t&7;)u+="=";return u},Gt=({name:r,prefix:e,bitsPerChar:t,alphabet:s})=>Vo({prefix:e,name:r,encode(a){return xy(a,s,t)},decode(a){return Sy(a,s,t,r)}}),Py=Vo({prefix:"\0",name:"identity",encode:r=>by(r),decode:r=>wy(r)});var My=Object.freeze({__proto__:null,identity:Py});const Ry=Gt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ny=Object.freeze({__proto__:null,base2:Ry});const Cy=Gt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Oy=Object.freeze({__proto__:null,base8:Cy});const Fy=Ls({prefix:"9",name:"base10",alphabet:"0123456789"});var Dy=Object.freeze({__proto__:null,base10:Fy});const Ty=Gt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),qy=Gt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var By=Object.freeze({__proto__:null,base16:Ty,base16upper:qy});const ky=Gt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Uy=Gt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),jy=Gt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),zy=Gt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ly=Gt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ky=Gt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Hy=Gt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Vy=Gt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$y=Gt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Jy=Object.freeze({__proto__:null,base32:ky,base32upper:Uy,base32pad:jy,base32padupper:zy,base32hex:Ly,base32hexupper:Ky,base32hexpad:Hy,base32hexpadupper:Vy,base32z:$y});const Qy=Ls({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Gy=Ls({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Yy=Object.freeze({__proto__:null,base36:Qy,base36upper:Gy});const Wy=Ls({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Zy=Ls({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Xy=Object.freeze({__proto__:null,base58btc:Wy,base58flickr:Zy});const ew=Gt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),tw=Gt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),rw=Gt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),iw=Gt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var nw=Object.freeze({__proto__:null,base64:ew,base64pad:tw,base64url:rw,base64urlpad:iw});const rf=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),sw=rf.reduce((r,e,t)=>(r[t]=e,r),[]),ow=rf.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function aw(r){return r.reduce((e,t)=>(e+=sw[t],e),"")}function cw(r){const e=[];for(const t of r){const s=ow[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const uw=Vo({prefix:"\u{1F680}",name:"base256emoji",encode:aw,decode:cw});var hw=Object.freeze({__proto__:null,base256emoji:uw}),lw=sf,nf=128,fw=127,dw=~fw,pw=Math.pow(2,31);function sf(r,e,t){e=e||[],t=t||0;for(var s=t;r>=pw;)e[t++]=r&255|nf,r/=128;for(;r&dw;)e[t++]=r&255|nf,r>>>=7;return e[t]=r|0,sf.bytes=t-s+1,e}var gw=Ic,mw=128,of=127;function Ic(r,s){var t=0,s=s||0,a=0,u=s,f,m=r.length;do{if(u>=m)throw Ic.bytes=0,new RangeError("Could not decode varint");f=r[u++],t+=a<28?(f&of)<<a:(f&of)*Math.pow(2,a),a+=7}while(f>=mw);return Ic.bytes=u-s,t}var vw=Math.pow(2,7),yw=Math.pow(2,14),ww=Math.pow(2,21),bw=Math.pow(2,28),_w=Math.pow(2,35),Aw=Math.pow(2,42),Ew=Math.pow(2,49),Iw=Math.pow(2,56),Sw=Math.pow(2,63),xw=function(r){return r<vw?1:r<yw?2:r<ww?3:r<bw?4:r<_w?5:r<Aw?6:r<Ew?7:r<Iw?8:r<Sw?9:10},Pw={encode:lw,decode:gw,encodingLength:xw},af=Pw;const cf=(r,e,t=0)=>(af.encode(r,e,t),e),uf=r=>af.encodingLength(r),Sc=(r,e)=>{const t=e.byteLength,s=uf(r),a=s+uf(t),u=new Uint8Array(a+t);return cf(r,u,0),cf(t,u,s),u.set(e,a),new Mw(r,t,e,u)};class Mw{constructor(e,t,s,a){this.code=e,this.size=t,this.digest=s,this.bytes=a}}const hf=({name:r,code:e,encode:t})=>new Rw(r,e,t);class Rw{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Sc(this.code,t):t.then(s=>Sc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const lf=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),Nw=hf({name:"sha2-256",code:18,encode:lf("SHA-256")}),Cw=hf({name:"sha2-512",code:19,encode:lf("SHA-512")});var Ow=Object.freeze({__proto__:null,sha256:Nw,sha512:Cw});const ff=0,Fw="identity",df=ef;var Dw=Object.freeze({__proto__:null,identity:{code:ff,name:Fw,encode:df,digest:r=>Sc(ff,df(r))}});new TextEncoder,new TextDecoder;const pf={...My,...Ny,...Oy,...Dy,...By,...Jy,...Yy,...Xy,...nw,...hw};({...Ow,...Dw});function Tw(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function gf(r,e,t,s){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:s}}}const mf=gf("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),xc=gf("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=Tw(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),qw={utf8:mf,"utf-8":mf,hex:pf.base16,latin1:xc,ascii:xc,binary:xc,...pf};function Bw(r,e="utf8"){const t=qw[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}const vf="wc",kw=2,Pc="core",nn=`${vf}@2:${Pc}:`,Uw={name:Pc,logger:"error"},jw={database:":memory:"},zw="crypto",yf="client_ed25519_seed",Lw=se.ONE_DAY,Kw="keychain",Hw="0.3",Vw="messages",$w="0.3",Jw=se.SIX_HOURS,Qw="publisher",wf="irn",Gw="error",bf="wss://relay.walletconnect.org",Yw="relayer",dr={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Ww="_subscription",Cr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Zw=.1,PI={database:":memory:"},Xw="2.14.0",eb=1e4,tb="0.3",rb="WALLETCONNECT_CLIENT_ID",di={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},MI=null,ib="subscription",nb="0.3",sb=se.FIVE_SECONDS*1e3,ob="pairing",ab="0.3",RI=null,Ks={wc_pairingDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:se.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:se.ONE_DAY,prompt:!1,tag:0},res:{ttl:se.ONE_DAY,prompt:!1,tag:0}}},cs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},$r={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},cb="history",ub="0.3",hb="expirer",Or={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},lb="0.3",NI=null,Mc="verify-api",fb="https://verify.walletconnect.com",_f="https://verify.walletconnect.org",Hs=_f,db=[fb,_f],pb="echo",gb="https://echo.walletconnect.com";class mb{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=Kw,this.version=Hw,this.initialized=!1,this.storagePrefix=nn,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:u}=Y("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(u)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=(0,Ne.Ep)(t,this.name)}get context(){return(0,Ne.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,gh(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?mh(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}}class vb{constructor(e,t,s){this.core=e,this.logger=t,this.name=zw,this.randomSessionIdentifier=wc(),this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),u=_o.generateKeyPair(a);return _o.encodeIss(u.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=sv();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const u=await this.getClientSeed(),f=_o.generateKeyPair(u),m=this.randomSessionIdentifier,b=Lw;return await _o.signJWT(m,a,b,f)},this.generateSharedKey=(a,u,f)=>{this.isInitialized();const m=this.getPrivateKey(a),b=ov(m,u);return this.setSymKey(b,f)},this.setSymKey=async(a,u)=>{this.isInitialized();const f=u||jo(a);return await this.keychain.set(f,a),f},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,u,f)=>{this.isInitialized();const m=kl(f),b=(0,Yu.u)(u);if(Ul(m)){const F=m.senderPublicKey,B=m.receiverPublicKey;a=await this.generateSharedKey(F,B)}const w=this.getSymKey(a),{type:P,senderPublicKey:R}=m;return cv({type:P,symKey:w,message:b,senderPublicKey:R})},this.decode=async(a,u,f)=>{this.isInitialized();const m=lv(u,f);if(Ul(m)){const b=m.receiverPublicKey,w=m.senderPublicKey;a=await this.generateSharedKey(b,w)}try{const b=this.getSymKey(a),w=uv({symKey:b,encoded:u});return(0,Yu.D)(w)}catch(b){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(b)}},this.getPayloadType=a=>{const u=zo(a);return Us(u.type)},this.getPayloadSenderPublicKey=a=>{const u=zo(a);return u.senderPublicKey?(0,Pt.BB)(u.senderPublicKey,nr):void 0},this.core=e,this.logger=(0,Ne.Ep)(t,this.name),this.keychain=s||new mb(this.core,this.logger)}get context(){return(0,Ne.Fd)(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(yf)}catch{e=wc(),await this.keychain.set(yf,e)}return Bw(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}}class yb extends yo{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=Vw,this.version=$w,this.initialized=!1,this.storagePrefix=nn,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const u=Sn(a);let f=this.messages.get(s);return typeof f>"u"&&(f={}),typeof f[u]<"u"||(f[u]=a,this.messages.set(s,f),await this.persist()),u},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const u=this.get(s),f=Sn(a);return typeof u[f]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=(0,Ne.Ep)(e,this.name),this.core=t}get context(){return(0,Ne.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,gh(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?mh(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}}class wb extends wo{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new ti.EventEmitter,this.name=Qw,this.queue=new Map,this.publishTimeout=(0,se.toMiliseconds)(se.ONE_MINUTE),this.failedPublishTimeout=(0,se.toMiliseconds)(se.ONE_SECOND),this.needsTransportRestart=!1,this.publish=async(s,a,u)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:u}});const m=(u==null?void 0:u.ttl)||Jw,b=bc(u),w=(u==null?void 0:u.prompt)||!1,P=(u==null?void 0:u.tag)||0,R=(u==null?void 0:u.id)||(0,we.getBigIntRpcId)().toString(),F={topic:s,message:a,opts:{ttl:m,relay:b,prompt:w,tag:P,id:R}},B=`Failed to publish payload, please try again. id:${R} tag:${P}`,k=Date.now();let L,H=1;try{for(;L===void 0;){if(Date.now()-k>this.publishTimeout)throw new Error(B);this.logger.trace({id:R,attempts:H},`publisher.publish - attempt ${H}`),L=await await $n(this.rpcPublish(s,a,m,b,w,P,R).catch(ee=>this.logger.warn(ee)),this.publishTimeout,B),H++,L||await new Promise(ee=>setTimeout(ee,this.failedPublishTimeout))}this.relayer.events.emit(dr.publish,F),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{id:R,topic:s,message:a,opts:u}})}catch(ee){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(ee),(f=u==null?void 0:u.internal)!=null&&f.throwOnFailedPublish)throw ee;this.queue.set(R,F)}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=e,this.logger=(0,Ne.Ep)(t,this.name),this.registerEventListeners()}get context(){return(0,Ne.Fd)(this.logger)}rpcPublish(e,t,s,a,u,f,m){var b,w,P,R;const F={method:js(a.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:u,tag:f},id:m};return sr((b=F.params)==null?void 0:b.prompt)&&((w=F.params)==null||delete w.prompt),sr((P=F.params)==null?void 0:P.tag)&&((R=F.params)==null||delete R.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:F}),this.relayer.request(F)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:a}=e;await this.publish(t,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(vn.Lx.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(dr.connection_stalled);return}this.checkQueue()}),this.relayer.on(dr.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class bb{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const a=s.filter(u=>u!==t);if(!a.length){this.map.delete(e);return}this.map.set(e,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var _b=Object.defineProperty,Ab=Object.defineProperties,Eb=Object.getOwnPropertyDescriptors,Af=Object.getOwnPropertySymbols,Ib=Object.prototype.hasOwnProperty,Sb=Object.prototype.propertyIsEnumerable,Ef=(r,e,t)=>e in r?_b(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Vs=(r,e)=>{for(var t in e||(e={}))Ib.call(e,t)&&Ef(r,t,e[t]);if(Af)for(var t of Af(e))Sb.call(e,t)&&Ef(r,t,e[t]);return r},Rc=(r,e)=>Ab(r,Eb(e));class xb extends _0{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new bb,this.events=new ti.EventEmitter,this.name=ib,this.version=nb,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=nn,this.subscribeTimeout=(0,se.toMiliseconds)(se.ONE_MINUTE),this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.pendingBatchMessages=[],this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const u=bc(a),f={topic:s,relay:u};this.pending.set(s,f);const m=await this.rpcSubscribe(s,u);return typeof m=="string"&&(this.onSubscribe(m,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}})),m}catch(u){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(u),u}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>{if(this.topics.includes(s))return!0;const a=`${this.pendingSubscriptionWatchLabel}_${s}`;return await new Promise((u,f)=>{const m=new se.Watch;m.start(a);const b=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(b),m.stop(a),u(!0)),m.elapsed(a)>=sb&&(clearInterval(b),m.stop(a),f(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.start=async()=>{await this.onConnect()},this.stop=async()=>{await this.onDisconnect()},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=(0,Ne.Ep)(t,this.name),this.clientId=""}get context(){return(0,Ne.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async a=>await this.unsubscribeById(e,a,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const a=bc(s);await this.rpcUnsubscribe(e,t,a);const u=rt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,u),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(e,t){const s={method:js(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await $n(this.relayer.request(s).catch(a=>this.logger.warn(a)),this.subscribeTimeout)?Sn(e+this.clientId):null}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(dr.connection_stalled)}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:js(t.protocol).batchSubscribe,params:{topics:e.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await $n(this.relayer.request(s).catch(a=>this.logger.warn(a)),this.subscribeTimeout)}catch{this.relayer.events.emit(dr.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t=e[0].relay,s={method:js(t.protocol).batchFetchMessages,params:{topics:e.map(u=>u.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});let a;try{a=await await $n(this.relayer.request(s).catch(u=>this.logger.warn(u)),this.subscribeTimeout)}catch{this.relayer.events.emit(dr.connection_stalled)}return a}rpcUnsubscribe(e,t,s){const a={method:js(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(e,t){this.setSubscription(e,Rc(Vs({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,Vs({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,Vs({},t)),this.topicMap.set(t.topic,e),this.events.emit(di.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=Y("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(di.deleted,Rc(Vs({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(di.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchFetchMessages(s),await this.batchSubscribe(s)}}this.events.emit(di.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);xn(t)&&this.onBatchSubscribe(t.map((s,a)=>Rc(Vs({},e[a]),{id:s})))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(this.pendingBatchMessages=this.pendingBatchMessages.concat(t.messages))}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||!this.relayer.connected)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e),this.pendingBatchMessages.length&&(await this.relayer.handleBatchMessageEvents(this.pendingBatchMessages),this.pendingBatchMessages=[])}registerEventListeners(){this.relayer.core.heartbeat.on(vn.Lx.pulse,async()=>{await this.checkPending()}),this.events.on(di.created,async e=>{const t=di.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(di.deleted,async e=>{const t=di.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var Pb=Object.defineProperty,If=Object.getOwnPropertySymbols,Mb=Object.prototype.hasOwnProperty,Rb=Object.prototype.propertyIsEnumerable,Sf=(r,e,t)=>e in r?Pb(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Nb=(r,e)=>{for(var t in e||(e={}))Mb.call(e,t)&&Sf(r,t,e[t]);if(If)for(var t of If(e))Rb.call(e,t)&&Sf(r,t,e[t]);return r};class Cb extends jn{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ti.EventEmitter,this.name=Yw,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","stalled","interrupted"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.heartBeatTimeout=(0,se.toMiliseconds)(se.THIRTY_SECONDS+se.ONE_SECOND),this.request=async t=>{var s,a;this.logger.debug("Publishing Request Payload");const u=t.id||(0,we.getBigIntRpcId)().toString();await this.toEstablishConnection();try{const f=this.provider.request(t);this.requestsInFlight.set(u,{promise:f,request:t}),this.logger.trace({id:u,method:t.method,topic:(s=t.params)==null?void 0:s.topic},"relayer.request - attempt to publish...");const m=await new Promise(async(b,w)=>{const P=()=>{w(new Error(`relayer.request - publish interrupted, id: ${u}`))};this.provider.on(Cr.disconnect,P);const R=await f;this.provider.off(Cr.disconnect,P),b(R)});return this.logger.trace({id:u,method:t.method,topic:(a=t.params)==null?void 0:a.topic},"relayer.request - published"),m}catch(f){throw this.logger.debug(`Failed to Publish Request: ${u}`),f}finally{this.requestsInFlight.delete(u)}},this.resetPingTimeout=()=>{if(Ns())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var t,s,a;(a=(s=(t=this.provider)==null?void 0:t.connection)==null?void 0:s.socket)==null||a.terminate()},this.heartBeatTimeout)}catch(t){this.logger.warn(t)}},this.onPayloadHandler=t=>{this.onProviderPayload(t),this.resetPingTimeout()},this.onConnectHandler=()=>{this.logger.trace("relayer connected"),this.startPingTimeout(),this.events.emit(dr.connect)},this.onDisconnectHandler=()=>{this.logger.trace("relayer disconnected"),this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(dr.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Cr.payload,this.onPayloadHandler),this.provider.on(Cr.connect,this.onConnectHandler),this.provider.on(Cr.disconnect,this.onDisconnectHandler),this.provider.on(Cr.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?(0,Ne.Ep)(e.logger,this.name):(0,Ne.gw)((0,Ne.jI)({level:e.logger||Gw})),this.messages=new yb(this.logger,e.core),this.subscriber=new xb(this,this.logger),this.publisher=new wb(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||bf,this.projectId=e.projectId,this.bundleId=V0(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),await this.transportOpen(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&this.subscriber.pending.size===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},eb)}get context(){return(0,Ne.Fd)(this.logger)}get connected(){var e,t,s;return((s=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:s.readyState)===1}get connecting(){var e,t,s;return((s=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:s.readyState)===0}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"",u;const f=m=>{m.topic===e&&(this.subscriber.off(di.created,f),u())};return await Promise.all([new Promise(m=>{u=m,this.subscriber.on(di.created,f)}),new Promise(async m=>{a=await this.subscriber.subscribe(e,t)||a,m()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){if(!this.hasExperiencedNetworkDisruption&&this.connected&&this.requestsInFlight.size>0)try{await Promise.all(Array.from(this.requestsInFlight.values()).map(e=>e.promise))}catch(e){this.logger.warn(e)}this.hasExperiencedNetworkDisruption||this.connected?await $n(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),await this.createProvider(),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;try{await new Promise(async(t,s)=>{const a=()=>{this.provider.off(Cr.disconnect,a),s(new Error("Connection interrupted while trying to subscribe"))};this.provider.on(Cr.disconnect,a),await $n(this.provider.connect(),(0,se.toMiliseconds)(se.ONE_MINUTE),`Socket stalled when trying to connect to ${this.relayUrl}`).catch(u=>{s(u)}),this.subscriber.start().catch(u=>{this.logger.error(u),this.onDisconnectHandler()}),this.hasExperiencedNetworkDisruption=!1,t()})}catch(t){this.logger.error(t);const s=t;if(this.hasExperiencedNetworkDisruption=!0,!this.isConnectionStalled(s.message))throw t}finally{this.connectionAttemptInProgress=!1}}async restartTransport(e){this.connectionAttemptInProgress||(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Xl())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const t=e.sort((s,a)=>s.publishedAt-a.publishedAt);this.logger.trace(`Batch of ${t.length} message events sorted`);for(const s of t)try{await this.onMessageEvent(s)}catch(a){this.logger.warn(a)}this.logger.trace(`Batch of ${t.length} message events processed`)}startPingTimeout(){var e,t,s,a,u;if(Ns())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((u=(a=(s=this.provider)==null?void 0:s.connection)==null?void 0:a.socket)==null||u.once("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(f){this.logger.warn(f)}}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new fi.r(new ly.Z(W0({sdkVersion:Xw,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const a=this.messages.has(t,s);return a&&this.logger.debug(`Ignoring duplicate message: ${s}`),a}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),(0,we.isJsonRpcRequest)(e)){if(!e.method.endsWith(Ww))return;const t=e.params,{topic:s,message:a,publishedAt:u}=t.data,f={topic:s,message:a,publishedAt:u};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Nb({type:"event",event:t.id},f)),this.events.emit(t.id,f),await this.acknowledgePayload(e),await this.onMessageEvent(f)}else(0,we.isJsonRpcResponse)(e)&&this.events.emit(dr.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(dr.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=(0,we.formatJsonRpcResult)(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Cr.payload,this.onPayloadHandler),this.provider.off(Cr.connect,this.onConnectHandler),this.provider.off(Cr.disconnect,this.onDisconnectHandler),this.provider.off(Cr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await Xl();cy(async t=>{e!==t&&(e=t,t?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){await this.subscriber.stop(),this.requestsInFlight.clear(),clearTimeout(this.pingTimeout),this.events.emit(dr.disconnect),this.connectionAttemptInProgress=!1,!this.transportExplicitlyClosed&&setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e))},(0,se.toMiliseconds)(Zw))}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&(this.connectionAttemptInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)}),await this.transportOpen())}}var Ob=Object.defineProperty,xf=Object.getOwnPropertySymbols,Fb=Object.prototype.hasOwnProperty,Db=Object.prototype.propertyIsEnumerable,Pf=(r,e,t)=>e in r?Ob(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Mf=(r,e)=>{for(var t in e||(e={}))Fb.call(e,t)&&Pf(r,t,e[t]);if(xf)for(var t of xf(e))Db.call(e,t)&&Pf(r,t,e[t]);return r};class Pn extends Zi{constructor(e,t,s,a=nn,u=void 0){super(e,t,s,a),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=tb,this.cached=[],this.initialized=!1,this.storagePrefix=nn,this.recentlyDeleted=[],this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!sr(f)?this.map.set(this.getKey(f),f):Uv(f)?this.map.set(f.id,f):jv(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,m)=>{this.isInitialized(),this.map.has(f)?await this.update(f,m):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:m}),this.map.set(f,m),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(m=>Object.keys(f).every(b=>dy()(m[b],f[b]))):this.values),this.update=async(f,m)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:m});const b=Mf(Mf({},this.getData(f)),m);this.map.set(f,b),await this.persist()},this.delete=async(f,m)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:m}),this.map.delete(f),this.addToRecentlyDeleted(f),await this.persist())},this.logger=(0,Ne.Ep)(t,this.name),this.storagePrefix=a,this.getKey=u}get context(){return(0,Ne.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:a}=Y("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(a),new Error(a)}const{message:s}=Y("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Tb{constructor(e,t){this.core=e,this.logger=t,this.name=ob,this.version=ab,this.events=new(Ms()),this.initialized=!1,this.storagePrefix=nn,this.ignoredPayloadTypes=[Fi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async s=>{this.isInitialized();const a=wc(),u=await this.core.crypto.setSymKey(a),f=$t(se.FIVE_MINUTES),m={protocol:wf},b={topic:u,expiry:f,relay:m,active:!1},w=Av({protocol:this.core.protocol,version:this.core.version,topic:u,symKey:a,relay:m,expiryTimestamp:f,methods:s==null?void 0:s.methods});return this.core.expirer.set(u,f),await this.pairings.set(u,b),await this.core.relayer.subscribe(u),{topic:u,uri:w}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:u,relay:f,expiryTimestamp:m,methods:b}=Kl(s.uri);let w;if(this.pairings.keys.includes(a)&&(w=this.pairings.get(a),w.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);const P=m||$t(se.FIVE_MINUTES),R={topic:a,relay:f,expiry:P,active:!1,methods:b};return this.core.expirer.set(a,P),await this.pairings.set(a,R),s.activatePairing&&await this.activate({topic:a}),this.events.emit(cs.create,R),this.core.crypto.keychain.has(a)||await this.core.crypto.setSymKey(u,a),await this.core.relayer.subscribe(a,{relay:f}),R},this.activate=async({topic:s})=>{this.isInitialized();const a=$t(se.THIRTY_DAYS);this.core.expirer.set(s,a),await this.pairings.update(s,{active:!0,expiry:a})},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const u=await this.sendRequest(a,"wc_pairingPing",{}),{done:f,resolve:m,reject:b}=_n();this.events.once(Ce("pairing_ping",u),({error:w})=>{w?b(w):m()}),await f()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",rt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,u)=>{const f=(0,we.formatJsonRpcRequest)(a,u),m=await this.core.crypto.encode(s,f),b=Ks[a].req;return this.core.history.set(s,f),this.core.relayer.publish(s,m,b),f.id},this.sendResult=async(s,a,u)=>{const f=(0,we.formatJsonRpcResult)(s,u),m=await this.core.crypto.encode(a,f),b=await this.core.history.get(a,s),w=Ks[b.request.method].res;await this.core.relayer.publish(a,m,w),await this.core.history.resolve(f)},this.sendError=async(s,a,u)=>{const f=(0,we.formatJsonRpcError)(s,u),m=await this.core.crypto.encode(a,f),b=await this.core.history.get(a,s),w=Ks[b.request.method]?Ks[b.request.method].res:Ks.unregistered_method.res;await this.core.relayer.publish(a,m,w),await this.core.history.resolve(f)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,rt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Xi(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:u}=s;switch(u.method){case"wc_pairingPing":return this.onPairingPingRequest(a,u);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,u);default:return this.onUnknownRpcMethodRequest(a,u)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:u}=s,f=(await this.core.history.get(a,u.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(a,u);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(s,a)=>{const{id:u}=a;try{this.isValidPing({topic:s}),await this.sendResult(u,s,!0),this.events.emit(cs.ping,{id:u,topic:s})}catch(f){await this.sendError(u,s,f),this.logger.error(f)}},this.onPairingPingResponse=(s,a)=>{const{id:u}=a;setTimeout(()=>{(0,we.isJsonRpcResult)(a)?this.events.emit(Ce("pairing_ping",u),{}):(0,we.isJsonRpcError)(a)&&this.events.emit(Ce("pairing_ping",u),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:u}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(cs.delete,{id:u,topic:s})}catch(f){await this.sendError(u,s,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:u,method:f}=a;try{if(this.registeredMethods.includes(f))return;const m=rt("WC_METHOD_UNSUPPORTED",f);await this.sendError(u,s,m),this.logger.error(m)}catch(m){await this.sendError(u,s,m),this.logger.error(m)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(rt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var a;if(!fr(s)){const{message:f}=Y("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(f)}if(!kv(s.uri)){const{message:f}=Y("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(f)}const u=Kl(s.uri);if(!((a=u==null?void 0:u.relay)!=null&&a.protocol)){const{message:f}=Y("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(f)}if(!(u!=null&&u.symKey)){const{message:f}=Y("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(f)}if(u!=null&&u.expiryTimestamp&&(0,se.toMiliseconds)(u==null?void 0:u.expiryTimestamp)<Date.now()){const{message:f}=Y("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(f)}},this.isValidPing=async s=>{if(!fr(s)){const{message:u}=Y("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(u)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!fr(s)){const{message:u}=Y("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(u)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!Tt(s,!1)){const{message:a}=Y("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=Y("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Xi(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=Y("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=e,this.logger=(0,Ne.Ep)(t,this.name),this.pairings=new Pn(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,Ne.Fd)(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(dr.message,async e=>{const{topic:t,message:s}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(t,s);try{(0,we.isJsonRpcRequest)(a)?(this.core.history.set(t,a),this.onRelayEventRequest({topic:t,payload:a})):(0,we.isJsonRpcResponse)(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a}),this.core.history.delete(t,a.id))}catch(u){this.logger.error(u)}})}registerExpirerEvents(){this.core.expirer.on(Or.expired,async e=>{const{topic:t}=yh(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(cs.expire,{topic:t}))})}}class qb extends yn{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new ti.EventEmitter,this.name=cb,this.version=ub,this.cached=[],this.initialized=!1,this.storagePrefix=nn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,u)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:u}),this.records.has(a.id))return;const f={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:u,expiry:$t(se.THIRTY_DAYS)};this.records.set(f.id,f),this.persist(),this.events.emit($r.created,f)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=(0,we.isJsonRpcError)(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.persist(),this.events.emit($r.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(u=>{if(u.topic===s){if(typeof a<"u"&&u.id!==a)return;this.records.delete(u.id),this.events.emit($r.deleted,u)}}),this.persist()},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=(0,Ne.Ep)(t,this.name)}get context(){return(0,Ne.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:(0,we.formatJsonRpcRequest)(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=Y("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit($r.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on($r.created,e=>{const t=$r.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on($r.updated,e=>{const t=$r.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on($r.deleted,e=>{const t=$r.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(vn.Lx.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{(0,se.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit($r.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Bb extends A0{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new ti.EventEmitter,this.name=hb,this.version=lb,this.cached=[],this.initialized=!1,this.storagePrefix=nn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const u=this.formatTarget(s),f={target:u,expiry:a};this.expirations.set(u,f),this.checkExpiry(u,f),this.events.emit(Or.created,{target:u,expiration:f})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),u=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Or.deleted,{target:a,expiration:u})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=(0,Ne.Ep)(t,this.name)}get context(){return(0,Ne.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return tg(e);if(typeof e=="number")return rg(e);const{message:t}=Y("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Or.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=Y("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;(0,se.toMiliseconds)(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Or.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(vn.Lx.pulse,()=>this.checkExpirations()),this.events.on(Or.created,e=>{const t=Or.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Or.expired,e=>{const t=Or.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Or.deleted,e=>{const t=Or.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}}}class kb extends E0{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=Mc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||Kn()||!Hn())return;const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u),this.verifyDisabled=!0}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(s.attestationId,a)},this.fetchAttestation=async(s,a)=>{this.logger.info(`resolving attestation: ${s} from url: ${a}`);const u=this.startAbortTimer(se.ONE_SECOND*5),f=await fetch(`${a}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(u),f.status===200?await f.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const a=u=>{u.data==="verify_ready"&&(this.onInit(),window.removeEventListener("message",a),s())};await Promise.race([new Promise(u=>{const f=document.getElementById(Mc);if(f)return this.iframe=f,this.onInit(),u();window.addEventListener("message",a);const m=document.createElement("iframe");m.id=Mc,m.src=`${this.verifyUrl}/${this.projectId}`,m.style.display="none",document.body.append(m),this.iframe=m,s=u}),new Promise((u,f)=>setTimeout(()=>{window.removeEventListener("message",a),f("verify iframe load timeout")},(0,se.toMiliseconds)(se.FIVE_SECONDS)))])},this.onInit=()=>{this.initialized=!0,this.processQueue()},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let a=s||Hs;return db.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${Hs}`),a=Hs),a},this.logger=(0,Ne.Ep)(t,this.name),this.verifyUrl=Hs,this.abortController=new AbortController,this.isDevEnv=Ns()&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.IS_VITEST}get context(){return(0,Ne.Fd)(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,se.toMiliseconds)(e))}}class Ub extends I0{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=pb,this.registerDeviceToken=async s=>{const{clientId:a,token:u,notificationType:f,enableEncrypted:m=!1}=s,b=`${gb}/${this.projectId}/clients`;await gy()(b,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:a,type:f,token:u,always_raw:m})})},this.logger=(0,Ne.Ep)(t,this.context)}}var jb=Object.defineProperty,Rf=Object.getOwnPropertySymbols,zb=Object.prototype.hasOwnProperty,Lb=Object.prototype.propertyIsEnumerable,Nf=(r,e,t)=>e in r?jb(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Cf=(r,e)=>{for(var t in e||(e={}))zb.call(e,t)&&Nf(r,t,e[t]);if(Rf)for(var t of Rf(e))Lb.call(e,t)&&Nf(r,t,e[t]);return r};class Nc extends vo{constructor(e){var t;super(e),this.protocol=vf,this.version=kw,this.name=Pc,this.events=new ti.EventEmitter,this.initialized=!1,this.on=(f,m)=>this.events.on(f,m),this.once=(f,m)=>this.events.once(f,m),this.off=(f,m)=>this.events.off(f,m),this.removeListener=(f,m)=>this.events.removeListener(f,m),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||bf,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=(0,Ne.jI)({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:Uw.logger}),{logger:a,chunkLoggerController:u}=(0,Ne.Rt)({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=u,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var f,m;(f=this.logChunkController)!=null&&f.downloadLogsBlobInBrowser&&((m=this.logChunkController)==null||m.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=(0,Ne.Ep)(a,this.name),this.heartbeat=new vn.C$,this.crypto=new vb(this,this.logger,e==null?void 0:e.keychain),this.history=new qb(this,this.logger),this.expirer=new Bb(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Pi.Z(Cf(Cf({},jw),e==null?void 0:e.storageOptions)),this.relayer=new Cb({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Tb(this,this.logger),this.verify=new kb(this.projectId||"",this.logger),this.echoClient=new Ub(this.projectId||"",this.logger)}static async init(e){const t=new Nc(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(rb,s),t}get context(){return(0,Ne.Fd)(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const Kb=Nc,Of="wc",Ff=2,Df="client",Cc=`${Of}@${Ff}:${Df}:`,Oc={name:Df,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},CI={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_request_sent:"session_request_sent",session_event:"session_event",proposal_expire:"proposal_expire",session_authenticate:"session_authenticate",session_request_expire:"session_request_expire"},OI={database:":memory:"},Tf="WALLETCONNECT_DEEPLINK_CHOICE",FI={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},DI="history",TI="0.3",Hb="proposal",qI=null,qf="Proposal expired",Vb="session",us=se.SEVEN_DAYS,$b="engine",Yt={wc_sessionPropose:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1104},res:{ttl:se.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1106},res:{ttl:se.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1112},res:{ttl:se.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1114},res:{ttl:se.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:se.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:se.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1119}}},Fc={min:se.FIVE_MINUTES,max:se.SEVEN_DAYS},pi={idle:"IDLE",active:"ACTIVE"},Jb="request",Qb=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],Gb="wc",BI=1.5,Yb="auth",Wb="authKeys",Zb="pairingTopics",Xb="requests",$o=`${Gb}@${1.5}:${Yb}:`,Jo=`${$o}:PUB_KEY`;var e2=Object.defineProperty,t2=Object.defineProperties,r2=Object.getOwnPropertyDescriptors,Bf=Object.getOwnPropertySymbols,i2=Object.prototype.hasOwnProperty,n2=Object.prototype.propertyIsEnumerable,kf=(r,e,t)=>e in r?e2(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ut=(r,e)=>{for(var t in e||(e={}))i2.call(e,t)&&kf(r,t,e[t]);if(Bf)for(var t of Bf(e))n2.call(e,t)&&kf(r,t,e[t]);return r},Mn=(r,e)=>t2(r,r2(e));class s2 extends x0{constructor(e){super(e),this.name=$b,this.events=new(Ms()),this.initialized=!1,this.requestQueue={state:pi.idle,queue:[]},this.sessionRequestQueue={state:pi.idle,queue:[]},this.requestQueueDelay=se.ONE_SECOND,this.expectedPairingMethodMap=new Map,this.recentlyDeletedMap=new Map,this.recentlyDeletedLimit=200,this.relayMessageCache=[],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Yt)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,se.toMiliseconds)(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const s=Mn(Ut({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:u,optionalNamespaces:f,sessionProperties:m,relays:b}=s;let w=a,P,R=!1;try{w&&(R=this.client.core.pairing.pairings.get(w).active)}catch(oe){throw this.client.logger.error(`connect() -> pairing.get(${w}) failed`),oe}if(!w||!R){const{topic:oe,uri:re}=await this.client.core.pairing.create();w=oe,P=re}if(!w){const{message:oe}=Y("NO_MATCHING_KEY",`connect() pairing topic: ${w}`);throw new Error(oe)}const F=await this.client.core.crypto.generateKeyPair(),B=Yt.wc_sessionPropose.req.ttl||se.FIVE_MINUTES,k=$t(B),L=Ut({requiredNamespaces:u,optionalNamespaces:f,relays:b??[{protocol:wf}],proposer:{publicKey:F,metadata:this.client.metadata},expiryTimestamp:k,pairingTopic:w},m&&{sessionProperties:m}),{reject:H,resolve:ee,done:pe}=_n(B,qf);this.events.once(Ce("session_connect"),async({error:oe,session:re})=>{if(oe)H(oe);else if(re){re.self.publicKey=F;const ue=Mn(Ut({},re),{pairingTopic:L.pairingTopic,requiredNamespaces:L.requiredNamespaces,optionalNamespaces:L.optionalNamespaces});await this.client.session.set(re.topic,ue),await this.setExpiry(re.topic,re.expiry),w&&await this.client.core.pairing.updateMetadata({topic:w,metadata:re.peer.metadata}),this.cleanupDuplicatePairings(ue),ee(ue)}});const de=await this.sendRequest({topic:w,method:"wc_sessionPropose",params:L,throwOnFailedPublish:!0});return await this.setProposal(de,Ut({id:de},L)),{uri:P,approval:pe}},this.pair=async t=>{await this.isInitialized();try{return await this.client.core.pairing.pair(t)}catch(s){throw this.client.logger.error("pair() failed"),s}},this.approve=async t=>{await this.isInitialized();try{await this.isValidApprove(t)}catch(pe){throw this.client.logger.error("approve() -> isValidApprove() failed"),pe}const{id:s,relayProtocol:a,namespaces:u,sessionProperties:f,sessionConfig:m}=t;let b;try{b=this.client.proposal.get(s)}catch(pe){throw this.client.logger.error(`approve() -> proposal.get(${s}) failed`),pe}const{pairingTopic:w,proposer:P,requiredNamespaces:R,optionalNamespaces:F}=b,B=await this.client.core.crypto.generateKeyPair(),k=P.publicKey,L=await this.client.core.crypto.generateSharedKey(B,k),H=Ut(Ut({relay:{protocol:a??"irn"},namespaces:u,controller:{publicKey:B,metadata:this.client.metadata},expiry:$t(us)},f&&{sessionProperties:f}),m&&{sessionConfig:m});await this.client.core.relayer.subscribe(L);const ee=Mn(Ut({},H),{topic:L,requiredNamespaces:R,optionalNamespaces:F,pairingTopic:w,acknowledged:!1,self:H.controller,peer:{publicKey:P.publicKey,metadata:P.metadata},controller:B});await this.client.session.set(L,ee);try{await this.sendResult({id:s,topic:w,result:{relay:{protocol:a??"irn"},responderPublicKey:B},throwOnFailedPublish:!0}),await this.sendRequest({topic:L,method:"wc_sessionSettle",params:H,throwOnFailedPublish:!0})}catch(pe){throw this.client.logger.error(pe),this.client.session.delete(L,rt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(L),pe}return await this.client.core.pairing.updateMetadata({topic:w,metadata:P.metadata}),await this.client.proposal.delete(s,rt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:w}),await this.setExpiry(L,$t(us)),{topic:L,acknowledged:()=>new Promise(pe=>setTimeout(()=>pe(this.client.session.get(L)),500))}},this.reject=async t=>{await this.isInitialized();try{await this.isValidReject(t)}catch(f){throw this.client.logger.error("reject() -> isValidReject() failed"),f}const{id:s,reason:a}=t;let u;try{u=this.client.proposal.get(s).pairingTopic}catch(f){throw this.client.logger.error(`reject() -> proposal.get(${s}) failed`),f}u&&(await this.sendError({id:s,topic:u,error:a,rpcOpts:Yt.wc_sessionPropose.reject}),await this.client.proposal.delete(s,rt("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized();try{await this.isValidUpdate(t)}catch(R){throw this.client.logger.error("update() -> isValidUpdate() failed"),R}const{topic:s,namespaces:a}=t,{done:u,resolve:f,reject:m}=_n(),b=(0,we.payloadId)(),w=(0,we.getBigIntRpcId)().toString(),P=this.client.session.get(s).namespaces;return this.events.once(Ce("session_update",b),({error:R})=>{R?m(R):f()}),await this.client.session.update(s,{namespaces:a}),await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:a},throwOnFailedPublish:!0,clientRpcId:b,relayRpcId:w}).catch(R=>{this.client.logger.error(R),this.client.session.update(s,{namespaces:P}),m(R)}),{acknowledged:u}},this.extend=async t=>{await this.isInitialized();try{await this.isValidExtend(t)}catch(b){throw this.client.logger.error("extend() -> isValidExtend() failed"),b}const{topic:s}=t,a=(0,we.payloadId)(),{done:u,resolve:f,reject:m}=_n();return this.events.once(Ce("session_extend",a),({error:b})=>{b?m(b):f()}),await this.setExpiry(s,$t(us)),this.sendRequest({topic:s,method:"wc_sessionExtend",params:{},clientRpcId:a,throwOnFailedPublish:!0}).catch(b=>{m(b)}),{acknowledged:u}},this.request=async t=>{await this.isInitialized();try{await this.isValidRequest(t)}catch(B){throw this.client.logger.error("request() -> isValidRequest() failed"),B}const{chainId:s,request:a,topic:u,expiry:f=Yt.wc_sessionRequest.req.ttl}=t,m=this.client.session.get(u),b=(0,we.payloadId)(),w=(0,we.getBigIntRpcId)().toString(),{done:P,resolve:R,reject:F}=_n(f,"Request expired. Please try again.");return this.events.once(Ce("session_request",b),({error:B,result:k})=>{B?F(B):R(k)}),await Promise.all([new Promise(async B=>{await this.sendRequest({clientRpcId:b,relayRpcId:w,topic:u,method:"wc_sessionRequest",params:{request:Mn(Ut({},a),{expiryTimestamp:$t(f)}),chainId:s},expiry:f,throwOnFailedPublish:!0}).catch(k=>F(k)),this.client.events.emit("session_request_sent",{topic:u,request:a,chainId:s,id:b}),B()}),new Promise(async B=>{var k;if(!((k=m.sessionConfig)!=null&&k.disableDeepLink)){const L=await ng(this.client.core.storage,Tf);ig({id:b,topic:u,wcDeepLink:L})}B()}),P()]).then(B=>B[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:a}=t,{id:u}=a;(0,we.isJsonRpcResult)(a)?await this.sendResult({id:u,topic:s,result:a.result,throwOnFailedPublish:!0}):(0,we.isJsonRpcError)(a)&&await this.sendError({id:u,topic:s,error:a.error}),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized();try{await this.isValidPing(t)}catch(a){throw this.client.logger.error("ping() -> isValidPing() failed"),a}const{topic:s}=t;if(this.client.session.keys.includes(s)){const a=(0,we.payloadId)(),u=(0,we.getBigIntRpcId)().toString(),{done:f,resolve:m,reject:b}=_n();this.events.once(Ce("session_ping",a),({error:w})=>{w?b(w):m()}),await Promise.all([this.sendRequest({topic:s,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:a,relayRpcId:u}),f()])}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:a,chainId:u}=t,f=(0,we.getBigIntRpcId)().toString();await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:a,chainId:u},throwOnFailedPublish:!0,relayRpcId:f})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;if(this.client.session.keys.includes(s))await this.sendRequest({topic:s,method:"wc_sessionDelete",params:rt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:s,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(s))await this.client.core.pairing.disconnect({topic:s});else{const{message:a}=Y("MISMATCHED_TOPIC",`Session or pairing topic not found: ${s}`);throw new Error(a)}},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>qv(s,t))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.authenticate=async t=>{this.isInitialized(),this.isValidAuthenticate(t);const{chains:s,statement:a="",uri:u,domain:f,nonce:m,type:b,exp:w,nbf:P,methods:R=[],expiry:F}=t,B=[...t.resources||[]],{topic:k,uri:L}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"]});this.client.logger.info({message:"Generated new pairing",pairing:{topic:k,uri:L}});const H=await this.client.core.crypto.generateKeyPair(),ee=jo(H);if(await Promise.all([this.client.auth.authKeys.set(Jo,{responseTopic:ee,publicKey:H}),this.client.auth.pairingTopics.set(ee,{topic:ee,pairingTopic:k})]),await this.client.core.relayer.subscribe(ee),this.client.logger.info(`sending request to new pairing topic: ${k}`),R.length>0){const{namespace:l}=Ln(s[0]);let g=ev(l,"request",R);ns(B)&&(g=tv(g,B.pop())),B.push(g)}const pe=F&&F>Yt.wc_sessionAuthenticate.req.ttl?F:Yt.wc_sessionAuthenticate.req.ttl,de={authPayload:{type:b??"caip122",chains:s,statement:a,aud:u,domain:f,version:"1",nonce:m,iat:new Date().toISOString(),exp:w,nbf:P,resources:B},requester:{publicKey:H,metadata:this.client.metadata},expiryTimestamp:$t(pe)},oe={eip155:{chains:s,methods:[...new Set(["personal_sign",...R])],events:["chainChanged","accountsChanged"]}},re={requiredNamespaces:{},optionalNamespaces:oe,relays:[{protocol:"irn"}],pairingTopic:k,proposer:{publicKey:H,metadata:this.client.metadata},expiryTimestamp:$t(Yt.wc_sessionPropose.req.ttl)},{done:ue,resolve:be,reject:_e}=_n(pe,"Request expired"),Ve=async({error:l,session:g})=>{if(this.events.off(Ce("session_request",qe),Ht),l)_e(l);else if(g){g.self.publicKey=H,await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),k&&await this.client.core.pairing.updateMetadata({topic:k,metadata:g.peer.metadata});const A=this.client.session.get(g.topic);await this.deleteProposal(kt),be({session:A})}},Ht=async l=>{if(await this.deletePendingAuthRequest(qe,{message:"fulfilled",code:0}),l.error){const x=rt("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return l.error.code===x.code?void 0:(this.events.off(Ce("session_connect"),Ve),_e(l.error.message))}await this.deleteProposal(kt),this.events.off(Ce("session_connect"),Ve);const{cacaos:g,responder:A}=l.result,S=[],M=[];for(const x of g){await Ml({cacao:x,projectId:this.client.core.projectId})||(this.client.logger.error(x,"Signature verification failed"),_e(rt("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p}=x,I=ns(p.resources),ge=[Pl(p.iss)],le=Uo(p.iss);if(I){const y=Fl(I),K=Dl(I);S.push(...y),ge.push(...K)}for(const y of ge)M.push(`${y}:${le}`)}const O=await this.client.core.crypto.generateSharedKey(H,A.publicKey);let q;S.length>0&&(q={topic:O,acknowledged:!0,self:{publicKey:H,metadata:this.client.metadata},peer:A,controller:A.publicKey,expiry:$t(us),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:k,namespaces:Jl([...new Set(S)],[...new Set(M)])},await this.client.core.relayer.subscribe(O),await this.client.session.set(O,q),k&&await this.client.core.pairing.updateMetadata({topic:k,metadata:A.metadata}),q=this.client.session.get(O)),be({auths:g,session:q})},qe=(0,we.payloadId)(),kt=(0,we.payloadId)();this.events.once(Ce("session_connect"),Ve),this.events.once(Ce("session_request",qe),Ht);try{await Promise.all([this.sendRequest({topic:k,method:"wc_sessionAuthenticate",params:de,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:qe}),this.sendRequest({topic:k,method:"wc_sessionPropose",params:re,expiry:Yt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:kt})])}catch(l){throw this.events.off(Ce("session_connect"),Ve),this.events.off(Ce("session_request",qe),Ht),l}return await this.setProposal(kt,Ut({id:kt},re)),await this.setAuthRequest(qe,{request:Mn(Ut({},de),{verifyContext:{}}),pairingTopic:k}),{uri:L,response:ue}},this.approveSessionAuthenticate=async t=>{this.isInitialized();const{id:s,auths:a}=t,u=this.getPendingAuthRequest(s);if(!u)throw new Error(`Could not find pending auth request with id ${s}`);const f=u.requester.publicKey,m=await this.client.core.crypto.generateKeyPair(),b=jo(f),w={type:Fi,receiverPublicKey:f,senderPublicKey:m},P=[],R=[];for(const k of a){if(!await Ml({cacao:k,projectId:this.client.core.projectId})){const de=rt("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:s,topic:b,error:de,encodeOpts:w}),new Error(de.message)}const{p:L}=k,H=ns(L.resources),ee=[Pl(L.iss)],pe=Uo(L.iss);if(H){const de=Fl(H),oe=Dl(H);P.push(...de),ee.push(...oe)}for(const de of ee)R.push(`${de}:${pe}`)}const F=await this.client.core.crypto.generateSharedKey(m,f);let B;return(P==null?void 0:P.length)>0&&(B={topic:F,acknowledged:!0,self:{publicKey:m,metadata:this.client.metadata},peer:{publicKey:f,metadata:u.requester.metadata},controller:f,expiry:$t(us),authentication:a,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:u.pairingTopic,namespaces:Jl([...new Set(P)],[...new Set(R)])},await this.client.core.relayer.subscribe(F),await this.client.session.set(F,B),await this.client.core.pairing.updateMetadata({topic:u.pairingTopic,metadata:u.requester.metadata})),await this.sendResult({topic:b,id:s,result:{cacaos:a,responder:{publicKey:m,metadata:this.client.metadata}},encodeOpts:w,throwOnFailedPublish:!0}),await this.client.auth.requests.delete(s,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:u.pairingTopic}),{session:B}},this.rejectSessionAuthenticate=async t=>{await this.isInitialized();const{id:s,reason:a}=t,u=this.getPendingAuthRequest(s);if(!u)throw new Error(`Could not find pending auth request with id ${s}`);const f=u.requester.publicKey,m=await this.client.core.crypto.generateKeyPair(),b=jo(f),w={type:Fi,receiverPublicKey:f,senderPublicKey:m};await this.sendError({id:s,topic:b,error:a,encodeOpts:w,rpcOpts:Yt.wc_sessionAuthenticate.reject}),await this.client.auth.requests.delete(s,{message:"rejected",code:0}),await this.client.proposal.delete(s,rt("USER_DISCONNECTED"))},this.formatAuthMessage=t=>{this.isInitialized();const{request:s,iss:a}=t;return Rl(s,a)},this.processRelayMessageCache=()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)},this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(u=>{var f,m;return((f=u.peerMetadata)==null?void 0:f.url)&&((m=u.peerMetadata)==null?void 0:m.url)===t.peer.metadata.url&&u.topic&&u.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(u=>this.client.core.pairing.disconnect({topic:u.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async t=>{var s;const{topic:a,expirerHasDeleted:u=!1,emitEvent:f=!0,id:m=0}=t,{self:b}=this.client.session.get(a);await this.client.core.relayer.unsubscribe(a),await this.client.session.delete(a,rt("USER_DISCONNECTED")),this.addToRecentlyDeleted(a,"session"),this.client.core.crypto.keychain.has(b.publicKey)&&await this.client.core.crypto.deleteKeyPair(b.publicKey),this.client.core.crypto.keychain.has(a)&&await this.client.core.crypto.deleteSymKey(a),u||this.client.core.expirer.del(a),this.client.core.storage.removeItem(Tf).catch(w=>this.client.logger.warn(w)),this.getPendingSessionRequests().forEach(w=>{w.topic===a&&this.deletePendingSessionRequest(w.id,rt("USER_DISCONNECTED"))}),a===((s=this.sessionRequestQueue.queue[0])==null?void 0:s.topic)&&(this.sessionRequestQueue.state=pi.idle),f&&this.client.events.emit("session_delete",{id:m,topic:a})},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,rt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")},this.deletePendingSessionRequest=async(t,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),a?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(u=>u.id!==t),a&&(this.sessionRequestQueue.state=pi.idle,this.client.events.emit("session_request_expire",{id:t}))},this.deletePendingAuthRequest=async(t,s,a=!1)=>{await Promise.all([this.client.auth.requests.delete(t,s),a?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,s),await this.client.session.update(t,{expiry:s}))},this.setProposal=async(t,s)=>{this.client.core.expirer.set(t,$t(Yt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,s)},this.setAuthRequest=async(t,s)=>{const{request:a,pairingTopic:u}=s;this.client.core.expirer.set(t,a.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:a.authPayload,requester:a.requester,expiryTimestamp:a.expiryTimestamp,id:t,pairingTopic:u,verifyContext:a.verifyContext})},this.setPendingSessionRequest=async t=>{const{id:s,topic:a,params:u,verifyContext:f}=t,m=u.request.expiryTimestamp||$t(Yt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(s,m),await this.client.pendingRequest.set(s,{id:s,topic:a,params:u,verifyContext:f})},this.sendRequest=async t=>{const{topic:s,method:a,params:u,expiry:f,relayRpcId:m,clientRpcId:b,throwOnFailedPublish:w}=t,P=(0,we.formatJsonRpcRequest)(a,u,b);if(Hn()&&Qb.includes(a)){const B=Sn(JSON.stringify(P));this.client.core.verify.register({attestationId:B})}let R;try{R=await this.client.core.crypto.encode(s,P)}catch(B){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${s} failed`),B}const F=Yt[a].req;return f&&(F.ttl=f),m&&(F.id=m),this.client.core.history.set(s,P),w?(F.internal=Mn(Ut({},F.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,R,F)):this.client.core.relayer.publish(s,R,F).catch(B=>this.client.logger.error(B)),P.id},this.sendResult=async t=>{const{id:s,topic:a,result:u,throwOnFailedPublish:f,encodeOpts:m}=t,b=(0,we.formatJsonRpcResult)(s,u);let w;try{w=await this.client.core.crypto.encode(a,b,m)}catch(F){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${a} failed`),F}let P;try{P=await this.client.core.history.get(a,s)}catch(F){throw this.client.logger.error(`sendResult() -> history.get(${a}, ${s}) failed`),F}const R=Yt[P.request.method].res;f?(R.internal=Mn(Ut({},R.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,w,R)):this.client.core.relayer.publish(a,w,R).catch(F=>this.client.logger.error(F)),await this.client.core.history.resolve(b)},this.sendError=async t=>{const{id:s,topic:a,error:u,encodeOpts:f,rpcOpts:m}=t,b=(0,we.formatJsonRpcError)(s,u);let w;try{w=await this.client.core.crypto.encode(a,b,f)}catch(F){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${a} failed`),F}let P;try{P=await this.client.core.history.get(a,s)}catch(F){throw this.client.logger.error(`sendError() -> history.get(${a}, ${s}) failed`),F}const R=m||Yt[P.request.method].res;this.client.core.relayer.publish(a,w,R),await this.client.core.history.resolve(b)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(a=>{let u=!1;Xi(a.expiry)&&(u=!0),this.client.core.crypto.keychain.has(a.topic)||(u=!0),u&&t.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Xi(a.expiryTimestamp)&&s.push(a.id)}),await Promise.all([...t.map(a=>this.deleteSession({topic:a})),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===pi.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=pi.active;const t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=pi.idle},this.processRequest=async t=>{const{topic:s,payload:a}=t,u=a.method;if(!this.shouldIgnorePairingRequest({topic:s,requestMethod:u}))switch(u){case"wc_sessionPropose":return await this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return await this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return await this.onSessionExtendRequest(s,a);case"wc_sessionPing":return await this.onSessionPingRequest(s,a);case"wc_sessionDelete":return await this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return await this.onSessionRequest(s,a);case"wc_sessionEvent":return await this.onSessionEventRequest(s,a);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${u}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:a}=t,u=(await this.client.core.history.get(s,a.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${u}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:a}=Y("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.shouldIgnorePairingRequest=t=>{const{topic:s,requestMethod:a}=t,u=this.expectedPairingMethodMap.get(s);return!u||u.includes(a)?!1:!!(u.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)},this.onSessionProposeRequest=async(t,s)=>{const{params:a,id:u}=s;try{this.isValidConnect(Ut({},s.params));const f=a.expiryTimestamp||$t(Yt.wc_sessionPropose.req.ttl),m=Ut({id:u,pairingTopic:t,expiryTimestamp:f},a);await this.setProposal(u,m);const b=Sn(JSON.stringify(s)),w=await this.getVerifyContext(b,m.proposer.metadata);this.client.events.emit("session_proposal",{id:u,params:m,verifyContext:w})}catch(f){await this.sendError({id:u,topic:t,error:f,rpcOpts:Yt.wc_sessionPropose.autoReject}),this.client.logger.error(f)}},this.onSessionProposeResponse=async(t,s)=>{const{id:a}=s;if((0,we.isJsonRpcResult)(s)){const{result:u}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});const f=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const m=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:m});const b=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:b});const w=await this.client.core.crypto.generateSharedKey(m,b);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:w});const P=await this.client.core.relayer.subscribe(w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:P}),await this.client.core.pairing.activate({topic:t})}else if((0,we.isJsonRpcError)(s)){await this.client.proposal.delete(a,rt("USER_DISCONNECTED"));const u=Ce("session_connect");if(this.events.listenerCount(u)===0)throw new Error(`emitting ${u} without any listeners, 954`);this.events.emit(Ce("session_connect"),{error:s.error})}},this.onSessionSettleRequest=async(t,s)=>{const{id:a,params:u}=s;try{this.isValidSessionSettleRequest(u);const{relay:f,controller:m,expiry:b,namespaces:w,sessionProperties:P,sessionConfig:R}=s.params,F=Ut(Ut({topic:t,relay:f,expiry:b,namespaces:w,acknowledged:!0,pairingTopic:"",requiredNamespaces:{},optionalNamespaces:{},controller:m.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:m.publicKey,metadata:m.metadata}},P&&{sessionProperties:P}),R&&{sessionConfig:R});await this.sendResult({id:s.id,topic:t,result:!0,throwOnFailedPublish:!0});const B=Ce("session_connect");if(this.events.listenerCount(B)===0)throw new Error(`emitting ${B} without any listeners 997`);this.events.emit(Ce("session_connect"),{session:F})}catch(f){await this.sendError({id:a,topic:t,error:f}),this.client.logger.error(f)}},this.onSessionSettleResponse=async(t,s)=>{const{id:a}=s;(0,we.isJsonRpcResult)(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Ce("session_approve",a),{})):(0,we.isJsonRpcError)(s)&&(await this.client.session.delete(t,rt("USER_DISCONNECTED")),this.events.emit(Ce("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:a,id:u}=s;try{const f=`${t}_session_update`,m=zs.get(f);if(m&&this.isRequestOutOfSync(m,u)){this.client.logger.info(`Discarding out of sync request - ${u}`),this.sendError({id:u,topic:t,error:rt("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Ut({topic:t},a));try{zs.set(f,u),await this.client.session.update(t,{namespaces:a.namespaces}),await this.sendResult({id:u,topic:t,result:!0,throwOnFailedPublish:!0})}catch(b){throw zs.delete(f),b}this.client.events.emit("session_update",{id:u,topic:t,params:a})}catch(f){await this.sendError({id:u,topic:t,error:f}),this.client.logger.error(f)}},this.isRequestOutOfSync=(t,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,s)=>{const{id:a}=s,u=Ce("session_update",a);if(this.events.listenerCount(u)===0)throw new Error(`emitting ${u} without any listeners`);(0,we.isJsonRpcResult)(s)?this.events.emit(Ce("session_update",a),{}):(0,we.isJsonRpcError)(s)&&this.events.emit(Ce("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:a}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,$t(us)),await this.sendResult({id:a,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:a,topic:t})}catch(u){await this.sendError({id:a,topic:t,error:u}),this.client.logger.error(u)}},this.onSessionExtendResponse=(t,s)=>{const{id:a}=s,u=Ce("session_extend",a);if(this.events.listenerCount(u)===0)throw new Error(`emitting ${u} without any listeners`);(0,we.isJsonRpcResult)(s)?this.events.emit(Ce("session_extend",a),{}):(0,we.isJsonRpcError)(s)&&this.events.emit(Ce("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:a}=s;try{this.isValidPing({topic:t}),await this.sendResult({id:a,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:a,topic:t})}catch(u){await this.sendError({id:a,topic:t,error:u}),this.client.logger.error(u)}},this.onSessionPingResponse=(t,s)=>{const{id:a}=s,u=Ce("session_ping",a);if(this.events.listenerCount(u)===0)throw new Error(`emitting ${u} without any listeners`);setTimeout(()=>{(0,we.isJsonRpcResult)(s)?this.events.emit(Ce("session_ping",a),{}):(0,we.isJsonRpcError)(s)&&this.events.emit(Ce("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(u=>{this.client.core.relayer.once(dr.publish,async()=>{u(await this.deleteSession({topic:t,id:a}))})}),this.sendResult({id:a,topic:t,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:rt("USER_DISCONNECTED")})])}catch(u){this.client.logger.error(u)}},this.onSessionRequest=async(t,s)=>{var a;const{id:u,params:f}=s;try{await this.isValidRequest(Ut({topic:t},f));const m=Sn(JSON.stringify((0,we.formatJsonRpcRequest)("wc_sessionRequest",f,u))),b=this.client.session.get(t),w=await this.getVerifyContext(m,b.peer.metadata),P={id:u,topic:t,params:f,verifyContext:w};await this.setPendingSessionRequest(P),(a=this.client.signConfig)!=null&&a.disableRequestQueue?this.emitSessionRequest(P):(this.addSessionRequestToSessionRequestQueue(P),this.processSessionRequestQueue())}catch(m){await this.sendError({id:u,topic:t,error:m}),this.client.logger.error(m)}},this.onSessionRequestResponse=(t,s)=>{const{id:a}=s,u=Ce("session_request",a);if(this.events.listenerCount(u)===0)throw new Error(`emitting ${u} without any listeners`);(0,we.isJsonRpcResult)(s)?this.events.emit(Ce("session_request",a),{result:s.result}):(0,we.isJsonRpcError)(s)&&this.events.emit(Ce("session_request",a),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:a,params:u}=s;try{const f=`${t}_session_event_${u.event.name}`,m=zs.get(f);if(m&&this.isRequestOutOfSync(m,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(Ut({topic:t},u)),this.client.events.emit("session_event",{id:a,topic:t,params:u}),zs.set(f,a)}catch(f){await this.sendError({id:a,topic:t,error:f}),this.client.logger.error(f)}},this.onSessionAuthenticateResponse=(t,s)=>{const{id:a}=s;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:s}),(0,we.isJsonRpcResult)(s)?this.events.emit(Ce("session_request",a),{result:s.result}):(0,we.isJsonRpcError)(s)&&this.events.emit(Ce("session_request",a),{error:s.error})},this.onSessionAuthenticateRequest=async(t,s)=>{try{const{requester:a,authPayload:u,expiryTimestamp:f}=s.params,m=Sn(JSON.stringify(s)),b=await this.getVerifyContext(m,this.client.metadata),w={requester:a,pairingTopic:t,id:s.id,authPayload:u,verifyContext:b,expiryTimestamp:f};await this.setAuthRequest(s.id,{request:w,pairingTopic:t}),this.client.events.emit("session_authenticate",{topic:t,params:s.params,id:s.id,verifyContext:b})}catch(a){this.client.logger.error(a);const u=s.params.requester.publicKey,f=await this.client.core.crypto.generateKeyPair(),m={type:Fi,receiverPublicKey:u,senderPublicKey:f};await this.sendError({id:s.id,topic:t,error:a,encodeOpts:m,rpcOpts:Yt.wc_sessionAuthenticate.autoReject})}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=pi.idle,this.processSessionRequestQueue()},(0,se.toMiliseconds)(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:t,error:s})=>{const a=this.client.core.history.pending;a.length>0&&a.filter(u=>u.topic===t&&u.request.method==="wc_sessionRequest").forEach(u=>{const f=u.request.id,m=Ce("session_request",f);if(this.events.listenerCount(m)===0)throw new Error(`emitting ${m} without any listeners`);this.events.emit(Ce("session_request",u.request.id),{error:s})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===pi.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=pi.active,this.emitSessionRequest(t)}catch(s){this.client.logger.error(s)}},this.emitSessionRequest=t=>{this.client.events.emit("session_request",t)},this.onPairingCreated=t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;const s=this.client.proposal.getAll().find(a=>a.pairingTopic===t.topic);s&&this.onSessionProposeRequest(t.topic,(0,we.formatJsonRpcRequest)("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async t=>{if(!fr(t)){const{message:b}=Y("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(b)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:u,sessionProperties:f,relays:m}=t;if(sr(s)||await this.isValidPairingTopic(s),!Qv(m,!0)){const{message:b}=Y("MISSING_OR_INVALID",`connect() relays: ${m}`);throw new Error(b)}!sr(a)&&as(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!sr(u)&&as(u)!==0&&this.validateNamespaces(u,"optionalNamespaces"),sr(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(t,s)=>{const a=Jv(t,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async t=>{if(!fr(t))throw new Error(Y("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:a,relayProtocol:u,sessionProperties:f}=t;this.checkRecentlyDeleted(s),await this.isValidProposalId(s);const m=this.client.proposal.get(s),b=Ho(a,"approve()");if(b)throw new Error(b.message);const w=Ac(m.requiredNamespaces,a,"approve()");if(w)throw new Error(w.message);if(!Tt(u,!0)){const{message:P}=Y("MISSING_OR_INVALID",`approve() relayProtocol: ${u}`);throw new Error(P)}sr(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async t=>{if(!fr(t)){const{message:u}=Y("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(u)}const{id:s,reason:a}=t;if(this.checkRecentlyDeleted(s),await this.isValidProposalId(s),!Yv(a)){const{message:u}=Y("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(u)}},this.isValidSessionSettleRequest=t=>{if(!fr(t)){const{message:w}=Y("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(w)}const{relay:s,controller:a,namespaces:u,expiry:f}=t;if(!Yl(s)){const{message:w}=Y("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(w)}const m=zv(a,"onSessionSettleRequest()");if(m)throw new Error(m.message);const b=Ho(u,"onSessionSettleRequest()");if(b)throw new Error(b.message);if(Xi(f)){const{message:w}=Y("EXPIRED","onSessionSettleRequest()");throw new Error(w)}},this.isValidUpdate=async t=>{if(!fr(t)){const{message:b}=Y("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(b)}const{topic:s,namespaces:a}=t;this.checkRecentlyDeleted(s),await this.isValidSessionTopic(s);const u=this.client.session.get(s),f=Ho(a,"update()");if(f)throw new Error(f.message);const m=Ac(u.requiredNamespaces,a,"update()");if(m)throw new Error(m.message)},this.isValidExtend=async t=>{if(!fr(t)){const{message:a}=Y("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(a)}const{topic:s}=t;this.checkRecentlyDeleted(s),await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!fr(t)){const{message:b}=Y("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(b)}const{topic:s,request:a,chainId:u,expiry:f}=t;this.checkRecentlyDeleted(s),await this.isValidSessionTopic(s);const{namespaces:m}=this.client.session.get(s);if(!Wl(m,u)){const{message:b}=Y("MISSING_OR_INVALID",`request() chainId: ${u}`);throw new Error(b)}if(!Wv(a)){const{message:b}=Y("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(b)}if(!ey(m,u,a.method)){const{message:b}=Y("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(b)}if(f&&!ny(f,Fc)){const{message:b}=Y("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${Fc.min} and ${Fc.max}`);throw new Error(b)}},this.isValidRespond=async t=>{var s;if(!fr(t)){const{message:f}=Y("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(f)}const{topic:a,response:u}=t;try{await this.isValidSessionTopic(a)}catch(f){throw(s=t==null?void 0:t.response)!=null&&s.id&&this.cleanupAfterResponse(t),f}if(!Zv(u)){const{message:f}=Y("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(u)}`);throw new Error(f)}},this.isValidPing=async t=>{if(!fr(t)){const{message:a}=Y("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(a)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!fr(t)){const{message:m}=Y("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(m)}const{topic:s,event:a,chainId:u}=t;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Wl(f,u)){const{message:m}=Y("MISSING_OR_INVALID",`emit() chainId: ${u}`);throw new Error(m)}if(!Xv(a)){const{message:m}=Y("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(m)}if(!ty(f,u,a.name)){const{message:m}=Y("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(m)}},this.isValidDisconnect=async t=>{if(!fr(t)){const{message:a}=Y("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(a)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidAuthenticate=t=>{const{chains:s,uri:a,domain:u,nonce:f}=t;if(!Array.isArray(s)||s.length===0)throw new Error("chains is required and must be a non-empty array");if(!Tt(a,!1))throw new Error("uri is required parameter");if(!Tt(u,!1))throw new Error("domain is required parameter");if(!Tt(f,!1))throw new Error("nonce is required parameter");if([...new Set(s.map(b=>Ln(b).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:m}=Ln(s[0]);if(m!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")},this.getVerifyContext=async(t,s)=>{const a={verified:{verifyUrl:s.verifyUrl||Hs,validation:"UNKNOWN",origin:s.url||""}};try{const u=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});u&&(a.verified.origin=u.origin,a.verified.isScam=u.isScam,a.verified.validation=u.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.info(u)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(a=>{if(!Tt(a,!1)){const{message:u}=Y("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(u)}})},this.getPendingAuthRequest=t=>{const s=this.client.auth.requests.get(t);return typeof s=="object"?s:void 0},this.addToRecentlyDeleted=(t,s)=>{if(this.recentlyDeletedMap.set(t,s),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let a=0;const u=this.recentlyDeletedLimit/2;for(const f of this.recentlyDeletedMap.keys()){if(a++>=u)break;this.recentlyDeletedMap.delete(f)}}},this.checkRecentlyDeleted=t=>{const s=this.recentlyDeletedMap.get(t);if(s){const{message:a}=Y("MISSING_OR_INVALID",`Record was recently deleted - ${s}: ${t}`);throw new Error(a)}}}async isInitialized(){if(!this.initialized){const{message:e}=Y("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(dr.message,e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):this.onRelayMessage(e)})}async onRelayMessage(e){const{topic:t,message:s}=e,{publicKey:a}=this.client.auth.authKeys.keys.includes(Jo)?this.client.auth.authKeys.get(Jo):{responseTopic:void 0,publicKey:void 0},u=await this.client.core.crypto.decode(t,s,{receiverPublicKey:a});try{(0,we.isJsonRpcRequest)(u)?(this.client.core.history.set(t,u),this.onRelayEventRequest({topic:t,payload:u})):(0,we.isJsonRpcResponse)(u)?(await this.client.core.history.resolve(u),await this.onRelayEventResponse({topic:t,payload:u}),this.client.core.history.delete(t,u.id)):this.onRelayEventUnknownPayload({topic:t,payload:u})}catch(f){this.client.logger.error(f)}}registerExpirerEvents(){this.client.core.expirer.on(Or.expired,async e=>{const{topic:t,id:s}=yh(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,Y("EXPIRED"),!0);if(s&&this.client.auth.requests.keys.includes(s))return await this.deletePendingAuthRequest(s,Y("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(cs.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(cs.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!Tt(e,!1)){const{message:t}=Y("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=Y("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Xi(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=Y("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Tt(e,!1)){const{message:t}=Y("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=Y("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Xi(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=Y("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=Y("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Tt(e,!1)){const{message:t}=Y("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=Y("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!Gv(e)){const{message:t}=Y("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=Y("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Xi(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=Y("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class o2 extends Pn{constructor(e,t){super(e,t,Hb,Cc),this.core=e,this.logger=t}}class a2 extends Pn{constructor(e,t){super(e,t,Vb,Cc),this.core=e,this.logger=t}}class c2 extends Pn{constructor(e,t){super(e,t,Jb,Cc,s=>s.id),this.core=e,this.logger=t}}class u2 extends Pn{constructor(e,t){super(e,t,Wb,$o,()=>Jo),this.core=e,this.logger=t}}class h2 extends Pn{constructor(e,t){super(e,t,Zb,$o),this.core=e,this.logger=t}}class l2 extends Pn{constructor(e,t){super(e,t,Xb,$o,s=>s.id),this.core=e,this.logger=t}}class f2{constructor(e,t){this.core=e,this.logger=t,this.authKeys=new u2(this.core,this.logger),this.pairingTopics=new h2(this.core,this.logger),this.requests=new l2(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}class Dc extends S0{constructor(e){super(e),this.protocol=Of,this.version=Ff,this.name=Oc.name,this.events=new ti.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.authenticate=async s=>{try{return await this.engine.authenticate(s)}catch(a){throw this.logger.error(a.message),a}},this.formatAuthMessage=s=>{try{return this.engine.formatAuthMessage(s)}catch(a){throw this.logger.error(a.message),a}},this.approveSessionAuthenticate=async s=>{try{return await this.engine.approveSessionAuthenticate(s)}catch(a){throw this.logger.error(a.message),a}},this.rejectSessionAuthenticate=async s=>{try{return await this.engine.rejectSessionAuthenticate(s)}catch(a){throw this.logger.error(a.message),a}},this.name=(e==null?void 0:e.name)||Oc.name,this.metadata=(e==null?void 0:e.metadata)||J0(),this.signConfig=e==null?void 0:e.signConfig;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:(0,Ne.gw)((0,Ne.jI)({level:(e==null?void 0:e.logger)||Oc.logger}));this.core=(e==null?void 0:e.core)||new Kb(e),this.logger=(0,Ne.Ep)(t,this.name),this.session=new a2(this.core,this.logger),this.proposal=new o2(this.core,this.logger),this.pendingRequest=new c2(this.core,this.logger),this.engine=new s2(this),this.auth=new f2(this.core,this.logger)}static async init(e){const t=new Dc(e);return await t.initialize(),t}get context(){return(0,Ne.Fd)(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),await this.auth.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success"),this.engine.processRelayMessageCache()}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const kI=null,UI=null;var Di=ce(51916);const Uf="error",d2="wss://relay.walletconnect.com",p2="wc",g2="universal_provider",jf=`${p2}@2:${g2}:`,m2="https://rpc.walletconnect.com/v1/",hs="generic",gi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var $s=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ce.g<"u"?ce.g:typeof self<"u"?self:{},Tc={exports:{}};(function(r,e){(function(){var t,s="4.17.21",a=200,u="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",m="Invalid `variable` option passed into `_.template`",b="__lodash_hash_undefined__",w=500,P="__lodash_placeholder__",R=1,F=2,B=4,k=1,L=2,H=1,ee=2,pe=4,de=8,oe=16,re=32,ue=64,be=128,_e=256,Ve=512,Ht=30,qe="...",kt=800,l=16,g=1,A=2,S=3,M=1/0,O=9007199254740991,q=17976931348623157e292,x=NaN,p=4294967295,I=p-1,ge=p>>>1,le=[["ary",be],["bind",H],["bindKey",ee],["curry",de],["curryRight",oe],["flip",Ve],["partial",re],["partialRight",ue],["rearg",_e]],y="[object Arguments]",K="[object Array]",j="[object AsyncFunction]",Q="[object Boolean]",ne="[object Date]",te="[object DOMException]",ie="[object Error]",fe="[object Function]",Ae="[object GeneratorFunction]",W="[object Map]",je="[object Number]",at="[object Null]",Be="[object Object]",mi="[object Promise]",ct="[object Proxy]",ze="[object RegExp]",jt="[object Set]",Le="[object String]",$e="[object Symbol]",qi="[object Undefined]",Ke="[object WeakMap]",ut="[object WeakSet]",br="[object ArrayBuffer]",Ue="[object DataView]",Qe="[object Float32Array]",Jr="[object Float64Array]",Ge="[object Int8Array]",Ye="[object Int16Array]",Qr="[object Int32Array]",We="[object Uint8Array]",Ze="[object Uint8ClampedArray]",Gr="[object Uint16Array]",Xe="[object Uint32Array]",ht=/\b__p \+= '';/g,Bi=/\b(__p \+=) '' \+/g,lt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,it=/&(?:amp|lt|gt|quot|#39);/g,vi=/[&<>"']/g,ft=RegExp(it.source),dt=RegExp(vi.source),ki=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,nt=/<%=([\s\S]+?)%>/g,Ui=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gt=/^\w*$/,mt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Yr=/[\\^$.*+?()[\]{}|]/g,vt=RegExp(Yr.source),et=/^\s+/,ji=/\s/,yt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,wt=/\{\n\/\* \[wrapped with (.+)\] \*/,zi=/,? & /,_t=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,At=/[()=,{}\[\]\/\s]/,Li=/\\(\\)?/g,Et=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,st=/\w*$/,yi=/^[-+]0x[0-9a-f]+$/i,wi=/^0b[01]+$/i,bi=/^\[object .+?Constructor\]$/,_i=/^0o[0-7]+$/i,Ai=/^(?:0|[1-9]\d*)$/,Ei=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,on=/($^)/,Js=/['\n\r\u2028\u2029\\]/g,an="\\ud800-\\udfff",Qs="\\u0300-\\u036f",Gs="\\ufe20-\\ufe2f",Ys="\\u20d0-\\u20ff",ls=Qs+Gs+Ys,fs="\\u2700-\\u27bf",ds="a-z\\xdf-\\xf6\\xf8-\\xff",Ws="\\xac\\xb1\\xd7\\xf7",Zs="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Xs="\\u2000-\\u206f",eo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Xf="A-Z\\xc0-\\xd6\\xd8-\\xde",ed="\\ufe0e\\ufe0f",td=Ws+Zs+Xs+eo,jc="['\u2019]",V2="["+an+"]",rd="["+td+"]",Wo="["+ls+"]",id="\\d+",$2="["+fs+"]",nd="["+ds+"]",sd="[^"+an+td+id+fs+ds+Xf+"]",zc="\\ud83c[\\udffb-\\udfff]",J2="(?:"+Wo+"|"+zc+")",od="[^"+an+"]",Lc="(?:\\ud83c[\\udde6-\\uddff]){2}",Kc="[\\ud800-\\udbff][\\udc00-\\udfff]",ps="["+Xf+"]",ad="\\u200d",cd="(?:"+nd+"|"+sd+")",Q2="(?:"+ps+"|"+sd+")",ud="(?:"+jc+"(?:d|ll|m|re|s|t|ve))?",hd="(?:"+jc+"(?:D|LL|M|RE|S|T|VE))?",ld=J2+"?",fd="["+ed+"]?",G2="(?:"+ad+"(?:"+[od,Lc,Kc].join("|")+")"+fd+ld+")*",Y2="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",W2="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",dd=fd+ld+G2,Z2="(?:"+[$2,Lc,Kc].join("|")+")"+dd,X2="(?:"+[od+Wo+"?",Wo,Lc,Kc,V2].join("|")+")",e3=RegExp(jc,"g"),t3=RegExp(Wo,"g"),Hc=RegExp(zc+"(?="+zc+")|"+X2+dd,"g"),r3=RegExp([ps+"?"+nd+"+"+ud+"(?="+[rd,ps,"$"].join("|")+")",Q2+"+"+hd+"(?="+[rd,ps+cd,"$"].join("|")+")",ps+"?"+cd+"+"+ud,ps+"+"+hd,W2,Y2,id,Z2].join("|"),"g"),i3=RegExp("["+ad+an+ls+ed+"]"),n3=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,s3=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],o3=-1,Mt={};Mt[Qe]=Mt[Jr]=Mt[Ge]=Mt[Ye]=Mt[Qr]=Mt[We]=Mt[Ze]=Mt[Gr]=Mt[Xe]=!0,Mt[y]=Mt[K]=Mt[br]=Mt[Q]=Mt[Ue]=Mt[ne]=Mt[ie]=Mt[fe]=Mt[W]=Mt[je]=Mt[Be]=Mt[ze]=Mt[jt]=Mt[Le]=Mt[Ke]=!1;var xt={};xt[y]=xt[K]=xt[br]=xt[Ue]=xt[Q]=xt[ne]=xt[Qe]=xt[Jr]=xt[Ge]=xt[Ye]=xt[Qr]=xt[W]=xt[je]=xt[Be]=xt[ze]=xt[jt]=xt[Le]=xt[$e]=xt[We]=xt[Ze]=xt[Gr]=xt[Xe]=!0,xt[ie]=xt[fe]=xt[Ke]=!1;var a3={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},c3={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},u3={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},h3={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},l3=parseFloat,f3=parseInt,pd=typeof $s=="object"&&$s&&$s.Object===Object&&$s,d3=typeof self=="object"&&self&&self.Object===Object&&self,Wt=pd||d3||Function("return this")(),Vc=e&&!e.nodeType&&e,Nn=Vc&&!0&&r&&!r.nodeType&&r,gd=Nn&&Nn.exports===Vc,$c=gd&&pd.process,Fr=function(){try{var D=Nn&&Nn.require&&Nn.require("util").types;return D||$c&&$c.binding&&$c.binding("util")}catch{}}(),md=Fr&&Fr.isArrayBuffer,vd=Fr&&Fr.isDate,yd=Fr&&Fr.isMap,wd=Fr&&Fr.isRegExp,bd=Fr&&Fr.isSet,_d=Fr&&Fr.isTypedArray;function _r(D,z,U){switch(U.length){case 0:return D.call(z);case 1:return D.call(z,U[0]);case 2:return D.call(z,U[0],U[1]);case 3:return D.call(z,U[0],U[1],U[2])}return D.apply(z,U)}function p3(D,z,U,ae){for(var Ee=-1,He=D==null?0:D.length;++Ee<He;){var zt=D[Ee];z(ae,zt,U(zt),D)}return ae}function Dr(D,z){for(var U=-1,ae=D==null?0:D.length;++U<ae&&z(D[U],U,D)!==!1;);return D}function g3(D,z){for(var U=D==null?0:D.length;U--&&z(D[U],U,D)!==!1;);return D}function Ad(D,z){for(var U=-1,ae=D==null?0:D.length;++U<ae;)if(!z(D[U],U,D))return!1;return!0}function cn(D,z){for(var U=-1,ae=D==null?0:D.length,Ee=0,He=[];++U<ae;){var zt=D[U];z(zt,U,D)&&(He[Ee++]=zt)}return He}function Zo(D,z){var U=D==null?0:D.length;return!!U&&gs(D,z,0)>-1}function Jc(D,z,U){for(var ae=-1,Ee=D==null?0:D.length;++ae<Ee;)if(U(z,D[ae]))return!0;return!1}function Rt(D,z){for(var U=-1,ae=D==null?0:D.length,Ee=Array(ae);++U<ae;)Ee[U]=z(D[U],U,D);return Ee}function un(D,z){for(var U=-1,ae=z.length,Ee=D.length;++U<ae;)D[Ee+U]=z[U];return D}function Qc(D,z,U,ae){var Ee=-1,He=D==null?0:D.length;for(ae&&He&&(U=D[++Ee]);++Ee<He;)U=z(U,D[Ee],Ee,D);return U}function m3(D,z,U,ae){var Ee=D==null?0:D.length;for(ae&&Ee&&(U=D[--Ee]);Ee--;)U=z(U,D[Ee],Ee,D);return U}function Gc(D,z){for(var U=-1,ae=D==null?0:D.length;++U<ae;)if(z(D[U],U,D))return!0;return!1}var v3=Yc("length");function y3(D){return D.split("")}function w3(D){return D.match(_t)||[]}function Ed(D,z,U){var ae;return U(D,function(Ee,He,zt){if(z(Ee,He,zt))return ae=He,!1}),ae}function Xo(D,z,U,ae){for(var Ee=D.length,He=U+(ae?1:-1);ae?He--:++He<Ee;)if(z(D[He],He,D))return He;return-1}function gs(D,z,U){return z===z?C3(D,z,U):Xo(D,Id,U)}function b3(D,z,U,ae){for(var Ee=U-1,He=D.length;++Ee<He;)if(ae(D[Ee],z))return Ee;return-1}function Id(D){return D!==D}function Sd(D,z){var U=D==null?0:D.length;return U?Zc(D,z)/U:x}function Yc(D){return function(z){return z==null?t:z[D]}}function Wc(D){return function(z){return D==null?t:D[z]}}function xd(D,z,U,ae,Ee){return Ee(D,function(He,zt,It){U=ae?(ae=!1,He):z(U,He,zt,It)}),U}function _3(D,z){var U=D.length;for(D.sort(z);U--;)D[U]=D[U].value;return D}function Zc(D,z){for(var U,ae=-1,Ee=D.length;++ae<Ee;){var He=z(D[ae]);He!==t&&(U=U===t?He:U+He)}return U}function Xc(D,z){for(var U=-1,ae=Array(D);++U<D;)ae[U]=z(U);return ae}function A3(D,z){return Rt(z,function(U){return[U,D[U]]})}function Pd(D){return D&&D.slice(0,Cd(D)+1).replace(et,"")}function Ar(D){return function(z){return D(z)}}function eu(D,z){return Rt(z,function(U){return D[U]})}function to(D,z){return D.has(z)}function Md(D,z){for(var U=-1,ae=D.length;++U<ae&&gs(z,D[U],0)>-1;);return U}function Rd(D,z){for(var U=D.length;U--&&gs(z,D[U],0)>-1;);return U}function E3(D,z){for(var U=D.length,ae=0;U--;)D[U]===z&&++ae;return ae}var I3=Wc(a3),S3=Wc(c3);function x3(D){return"\\"+h3[D]}function P3(D,z){return D==null?t:D[z]}function ms(D){return i3.test(D)}function M3(D){return n3.test(D)}function R3(D){for(var z,U=[];!(z=D.next()).done;)U.push(z.value);return U}function tu(D){var z=-1,U=Array(D.size);return D.forEach(function(ae,Ee){U[++z]=[Ee,ae]}),U}function Nd(D,z){return function(U){return D(z(U))}}function hn(D,z){for(var U=-1,ae=D.length,Ee=0,He=[];++U<ae;){var zt=D[U];(zt===z||zt===P)&&(D[U]=P,He[Ee++]=U)}return He}function ea(D){var z=-1,U=Array(D.size);return D.forEach(function(ae){U[++z]=ae}),U}function N3(D){var z=-1,U=Array(D.size);return D.forEach(function(ae){U[++z]=[ae,ae]}),U}function C3(D,z,U){for(var ae=U-1,Ee=D.length;++ae<Ee;)if(D[ae]===z)return ae;return-1}function O3(D,z,U){for(var ae=U+1;ae--;)if(D[ae]===z)return ae;return ae}function vs(D){return ms(D)?D3(D):v3(D)}function Wr(D){return ms(D)?T3(D):y3(D)}function Cd(D){for(var z=D.length;z--&&ji.test(D.charAt(z)););return z}var F3=Wc(u3);function D3(D){for(var z=Hc.lastIndex=0;Hc.test(D);)++z;return z}function T3(D){return D.match(Hc)||[]}function q3(D){return D.match(r3)||[]}var B3=function D(z){z=z==null?Wt:ys.defaults(Wt.Object(),z,ys.pick(Wt,s3));var U=z.Array,ae=z.Date,Ee=z.Error,He=z.Function,zt=z.Math,It=z.Object,ru=z.RegExp,k3=z.String,Tr=z.TypeError,ta=U.prototype,U3=He.prototype,ws=It.prototype,ra=z["__core-js_shared__"],ia=U3.toString,tt=ws.hasOwnProperty,j3=0,Od=function(){var n=/[^.]+$/.exec(ra&&ra.keys&&ra.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),na=ws.toString,z3=ia.call(It),L3=Wt._,K3=ru("^"+ia.call(tt).replace(Yr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),sa=gd?z.Buffer:t,ln=z.Symbol,oa=z.Uint8Array,Fd=sa?sa.allocUnsafe:t,aa=Nd(It.getPrototypeOf,It),Dd=It.create,Td=ws.propertyIsEnumerable,ca=ta.splice,qd=ln?ln.isConcatSpreadable:t,ro=ln?ln.iterator:t,Cn=ln?ln.toStringTag:t,ua=function(){try{var n=qn(It,"defineProperty");return n({},"",{}),n}catch{}}(),H3=z.clearTimeout!==Wt.clearTimeout&&z.clearTimeout,V3=ae&&ae.now!==Wt.Date.now&&ae.now,$3=z.setTimeout!==Wt.setTimeout&&z.setTimeout,ha=zt.ceil,la=zt.floor,iu=It.getOwnPropertySymbols,J3=sa?sa.isBuffer:t,Bd=z.isFinite,Q3=ta.join,G3=Nd(It.keys,It),Lt=zt.max,er=zt.min,Y3=ae.now,W3=z.parseInt,kd=zt.random,Z3=ta.reverse,nu=qn(z,"DataView"),io=qn(z,"Map"),su=qn(z,"Promise"),bs=qn(z,"Set"),no=qn(z,"WeakMap"),so=qn(It,"create"),fa=no&&new no,_s={},X3=Bn(nu),e_=Bn(io),t_=Bn(su),r_=Bn(bs),i_=Bn(no),da=ln?ln.prototype:t,oo=da?da.valueOf:t,Ud=da?da.toString:t;function _(n){if(Ot(n)&&!Se(n)&&!(n instanceof Te)){if(n instanceof qr)return n;if(tt.call(n,"__wrapped__"))return jp(n)}return new qr(n)}var As=function(){function n(){}return function(o){if(!Nt(o))return{};if(Dd)return Dd(o);n.prototype=o;var h=new n;return n.prototype=t,h}}();function pa(){}function qr(n,o){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=t}_.templateSettings={escape:ki,evaluate:pt,interpolate:nt,variable:"",imports:{_}},_.prototype=pa.prototype,_.prototype.constructor=_,qr.prototype=As(pa.prototype),qr.prototype.constructor=qr;function Te(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=p,this.__views__=[]}function n_(){var n=new Te(this.__wrapped__);return n.__actions__=pr(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=pr(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=pr(this.__views__),n}function s_(){if(this.__filtered__){var n=new Te(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}function o_(){var n=this.__wrapped__.value(),o=this.__dir__,h=Se(n),d=o<0,v=h?n.length:0,E=yA(0,v,this.__views__),N=E.start,C=E.end,T=C-N,V=d?C:N-1,J=this.__iteratees__,G=J.length,Z=0,he=er(T,this.__takeCount__);if(!h||!d&&v==T&&he==T)return up(n,this.__actions__);var ve=[];e:for(;T--&&Z<he;){V+=o;for(var Me=-1,ye=n[V];++Me<G;){var Oe=J[Me],ke=Oe.iteratee,Sr=Oe.type,cr=ke(ye);if(Sr==A)ye=cr;else if(!cr){if(Sr==g)continue e;break e}}ve[Z++]=ye}return ve}Te.prototype=As(pa.prototype),Te.prototype.constructor=Te;function On(n){var o=-1,h=n==null?0:n.length;for(this.clear();++o<h;){var d=n[o];this.set(d[0],d[1])}}function a_(){this.__data__=so?so(null):{},this.size=0}function c_(n){var o=this.has(n)&&delete this.__data__[n];return this.size-=o?1:0,o}function u_(n){var o=this.__data__;if(so){var h=o[n];return h===b?t:h}return tt.call(o,n)?o[n]:t}function h_(n){var o=this.__data__;return so?o[n]!==t:tt.call(o,n)}function l_(n,o){var h=this.__data__;return this.size+=this.has(n)?0:1,h[n]=so&&o===t?b:o,this}On.prototype.clear=a_,On.prototype.delete=c_,On.prototype.get=u_,On.prototype.has=h_,On.prototype.set=l_;function Ki(n){var o=-1,h=n==null?0:n.length;for(this.clear();++o<h;){var d=n[o];this.set(d[0],d[1])}}function f_(){this.__data__=[],this.size=0}function d_(n){var o=this.__data__,h=ga(o,n);if(h<0)return!1;var d=o.length-1;return h==d?o.pop():ca.call(o,h,1),--this.size,!0}function p_(n){var o=this.__data__,h=ga(o,n);return h<0?t:o[h][1]}function g_(n){return ga(this.__data__,n)>-1}function m_(n,o){var h=this.__data__,d=ga(h,n);return d<0?(++this.size,h.push([n,o])):h[d][1]=o,this}Ki.prototype.clear=f_,Ki.prototype.delete=d_,Ki.prototype.get=p_,Ki.prototype.has=g_,Ki.prototype.set=m_;function Hi(n){var o=-1,h=n==null?0:n.length;for(this.clear();++o<h;){var d=n[o];this.set(d[0],d[1])}}function v_(){this.size=0,this.__data__={hash:new On,map:new(io||Ki),string:new On}}function y_(n){var o=Pa(this,n).delete(n);return this.size-=o?1:0,o}function w_(n){return Pa(this,n).get(n)}function b_(n){return Pa(this,n).has(n)}function __(n,o){var h=Pa(this,n),d=h.size;return h.set(n,o),this.size+=h.size==d?0:1,this}Hi.prototype.clear=v_,Hi.prototype.delete=y_,Hi.prototype.get=w_,Hi.prototype.has=b_,Hi.prototype.set=__;function Fn(n){var o=-1,h=n==null?0:n.length;for(this.__data__=new Hi;++o<h;)this.add(n[o])}function A_(n){return this.__data__.set(n,b),this}function E_(n){return this.__data__.has(n)}Fn.prototype.add=Fn.prototype.push=A_,Fn.prototype.has=E_;function Zr(n){var o=this.__data__=new Ki(n);this.size=o.size}function I_(){this.__data__=new Ki,this.size=0}function S_(n){var o=this.__data__,h=o.delete(n);return this.size=o.size,h}function x_(n){return this.__data__.get(n)}function P_(n){return this.__data__.has(n)}function M_(n,o){var h=this.__data__;if(h instanceof Ki){var d=h.__data__;if(!io||d.length<a-1)return d.push([n,o]),this.size=++h.size,this;h=this.__data__=new Hi(d)}return h.set(n,o),this.size=h.size,this}Zr.prototype.clear=I_,Zr.prototype.delete=S_,Zr.prototype.get=x_,Zr.prototype.has=P_,Zr.prototype.set=M_;function jd(n,o){var h=Se(n),d=!h&&kn(n),v=!h&&!d&&mn(n),E=!h&&!d&&!v&&xs(n),N=h||d||v||E,C=N?Xc(n.length,k3):[],T=C.length;for(var V in n)(o||tt.call(n,V))&&!(N&&(V=="length"||v&&(V=="offset"||V=="parent")||E&&(V=="buffer"||V=="byteLength"||V=="byteOffset")||Qi(V,T)))&&C.push(V);return C}function zd(n){var o=n.length;return o?n[mu(0,o-1)]:t}function R_(n,o){return Ma(pr(n),Dn(o,0,n.length))}function N_(n){return Ma(pr(n))}function ou(n,o,h){(h!==t&&!Xr(n[o],h)||h===t&&!(o in n))&&Vi(n,o,h)}function ao(n,o,h){var d=n[o];(!(tt.call(n,o)&&Xr(d,h))||h===t&&!(o in n))&&Vi(n,o,h)}function ga(n,o){for(var h=n.length;h--;)if(Xr(n[h][0],o))return h;return-1}function C_(n,o,h,d){return fn(n,function(v,E,N){o(d,v,h(v),N)}),d}function Ld(n,o){return n&&Si(o,Vt(o),n)}function O_(n,o){return n&&Si(o,mr(o),n)}function Vi(n,o,h){o=="__proto__"&&ua?ua(n,o,{configurable:!0,enumerable:!0,value:h,writable:!0}):n[o]=h}function au(n,o){for(var h=-1,d=o.length,v=U(d),E=n==null;++h<d;)v[h]=E?t:zu(n,o[h]);return v}function Dn(n,o,h){return n===n&&(h!==t&&(n=n<=h?n:h),o!==t&&(n=n>=o?n:o)),n}function Br(n,o,h,d,v,E){var N,C=o&R,T=o&F,V=o&B;if(h&&(N=v?h(n,d,v,E):h(n)),N!==t)return N;if(!Nt(n))return n;var J=Se(n);if(J){if(N=bA(n),!C)return pr(n,N)}else{var G=tr(n),Z=G==fe||G==Ae;if(mn(n))return fp(n,C);if(G==Be||G==y||Z&&!v){if(N=T||Z?{}:Cp(n),!C)return T?uA(n,O_(N,n)):cA(n,Ld(N,n))}else{if(!xt[G])return v?n:{};N=_A(n,G,C)}}E||(E=new Zr);var he=E.get(n);if(he)return he;E.set(n,N),o0(n)?n.forEach(function(ye){N.add(Br(ye,o,h,ye,n,E))}):n0(n)&&n.forEach(function(ye,Oe){N.set(Oe,Br(ye,o,h,Oe,n,E))});var ve=V?T?Pu:xu:T?mr:Vt,Me=J?t:ve(n);return Dr(Me||n,function(ye,Oe){Me&&(Oe=ye,ye=n[Oe]),ao(N,Oe,Br(ye,o,h,Oe,n,E))}),N}function F_(n){var o=Vt(n);return function(h){return Kd(h,n,o)}}function Kd(n,o,h){var d=h.length;if(n==null)return!d;for(n=It(n);d--;){var v=h[d],E=o[v],N=n[v];if(N===t&&!(v in n)||!E(N))return!1}return!0}function Hd(n,o,h){if(typeof n!="function")throw new Tr(f);return go(function(){n.apply(t,h)},o)}function co(n,o,h,d){var v=-1,E=Zo,N=!0,C=n.length,T=[],V=o.length;if(!C)return T;h&&(o=Rt(o,Ar(h))),d?(E=Jc,N=!1):o.length>=a&&(E=to,N=!1,o=new Fn(o));e:for(;++v<C;){var J=n[v],G=h==null?J:h(J);if(J=d||J!==0?J:0,N&&G===G){for(var Z=V;Z--;)if(o[Z]===G)continue e;T.push(J)}else E(o,G,d)||T.push(J)}return T}var fn=vp(Ii),Vd=vp(uu,!0);function D_(n,o){var h=!0;return fn(n,function(d,v,E){return h=!!o(d,v,E),h}),h}function ma(n,o,h){for(var d=-1,v=n.length;++d<v;){var E=n[d],N=o(E);if(N!=null&&(C===t?N===N&&!Ir(N):h(N,C)))var C=N,T=E}return T}function T_(n,o,h,d){var v=n.length;for(h=Pe(h),h<0&&(h=-h>v?0:v+h),d=d===t||d>v?v:Pe(d),d<0&&(d+=v),d=h>d?0:c0(d);h<d;)n[h++]=o;return n}function $d(n,o){var h=[];return fn(n,function(d,v,E){o(d,v,E)&&h.push(d)}),h}function Zt(n,o,h,d,v){var E=-1,N=n.length;for(h||(h=EA),v||(v=[]);++E<N;){var C=n[E];o>0&&h(C)?o>1?Zt(C,o-1,h,d,v):un(v,C):d||(v[v.length]=C)}return v}var cu=yp(),Jd=yp(!0);function Ii(n,o){return n&&cu(n,o,Vt)}function uu(n,o){return n&&Jd(n,o,Vt)}function va(n,o){return cn(o,function(h){return Gi(n[h])})}function Tn(n,o){o=pn(o,n);for(var h=0,d=o.length;n!=null&&h<d;)n=n[xi(o[h++])];return h&&h==d?n:t}function Qd(n,o,h){var d=o(n);return Se(n)?d:un(d,h(n))}function or(n){return n==null?n===t?qi:at:Cn&&Cn in It(n)?vA(n):NA(n)}function hu(n,o){return n>o}function q_(n,o){return n!=null&&tt.call(n,o)}function B_(n,o){return n!=null&&o in It(n)}function k_(n,o,h){return n>=er(o,h)&&n<Lt(o,h)}function lu(n,o,h){for(var d=h?Jc:Zo,v=n[0].length,E=n.length,N=E,C=U(E),T=1/0,V=[];N--;){var J=n[N];N&&o&&(J=Rt(J,Ar(o))),T=er(J.length,T),C[N]=!h&&(o||v>=120&&J.length>=120)?new Fn(N&&J):t}J=n[0];var G=-1,Z=C[0];e:for(;++G<v&&V.length<T;){var he=J[G],ve=o?o(he):he;if(he=h||he!==0?he:0,!(Z?to(Z,ve):d(V,ve,h))){for(N=E;--N;){var Me=C[N];if(!(Me?to(Me,ve):d(n[N],ve,h)))continue e}Z&&Z.push(ve),V.push(he)}}return V}function U_(n,o,h,d){return Ii(n,function(v,E,N){o(d,h(v),E,N)}),d}function uo(n,o,h){o=pn(o,n),n=Tp(n,o);var d=n==null?n:n[xi(Ur(o))];return d==null?t:_r(d,n,h)}function Gd(n){return Ot(n)&&or(n)==y}function j_(n){return Ot(n)&&or(n)==br}function z_(n){return Ot(n)&&or(n)==ne}function ho(n,o,h,d,v){return n===o?!0:n==null||o==null||!Ot(n)&&!Ot(o)?n!==n&&o!==o:L_(n,o,h,d,ho,v)}function L_(n,o,h,d,v,E){var N=Se(n),C=Se(o),T=N?K:tr(n),V=C?K:tr(o);T=T==y?Be:T,V=V==y?Be:V;var J=T==Be,G=V==Be,Z=T==V;if(Z&&mn(n)){if(!mn(o))return!1;N=!0,J=!1}if(Z&&!J)return E||(E=new Zr),N||xs(n)?Mp(n,o,h,d,v,E):gA(n,o,T,h,d,v,E);if(!(h&k)){var he=J&&tt.call(n,"__wrapped__"),ve=G&&tt.call(o,"__wrapped__");if(he||ve){var Me=he?n.value():n,ye=ve?o.value():o;return E||(E=new Zr),v(Me,ye,h,d,E)}}return Z?(E||(E=new Zr),mA(n,o,h,d,v,E)):!1}function K_(n){return Ot(n)&&tr(n)==W}function fu(n,o,h,d){var v=h.length,E=v,N=!d;if(n==null)return!E;for(n=It(n);v--;){var C=h[v];if(N&&C[2]?C[1]!==n[C[0]]:!(C[0]in n))return!1}for(;++v<E;){C=h[v];var T=C[0],V=n[T],J=C[1];if(N&&C[2]){if(V===t&&!(T in n))return!1}else{var G=new Zr;if(d)var Z=d(V,J,T,n,o,G);if(!(Z===t?ho(J,V,k|L,d,G):Z))return!1}}return!0}function Yd(n){if(!Nt(n)||SA(n))return!1;var o=Gi(n)?K3:bi;return o.test(Bn(n))}function H_(n){return Ot(n)&&or(n)==ze}function V_(n){return Ot(n)&&tr(n)==jt}function $_(n){return Ot(n)&&Da(n.length)&&!!Mt[or(n)]}function Wd(n){return typeof n=="function"?n:n==null?vr:typeof n=="object"?Se(n)?ep(n[0],n[1]):Xd(n):w0(n)}function du(n){if(!po(n))return G3(n);var o=[];for(var h in It(n))tt.call(n,h)&&h!="constructor"&&o.push(h);return o}function J_(n){if(!Nt(n))return RA(n);var o=po(n),h=[];for(var d in n)d=="constructor"&&(o||!tt.call(n,d))||h.push(d);return h}function pu(n,o){return n<o}function Zd(n,o){var h=-1,d=gr(n)?U(n.length):[];return fn(n,function(v,E,N){d[++h]=o(v,E,N)}),d}function Xd(n){var o=Ru(n);return o.length==1&&o[0][2]?Fp(o[0][0],o[0][1]):function(h){return h===n||fu(h,n,o)}}function ep(n,o){return Cu(n)&&Op(o)?Fp(xi(n),o):function(h){var d=zu(h,n);return d===t&&d===o?Lu(h,n):ho(o,d,k|L)}}function ya(n,o,h,d,v){n!==o&&cu(o,function(E,N){if(v||(v=new Zr),Nt(E))Q_(n,o,N,h,ya,d,v);else{var C=d?d(Fu(n,N),E,N+"",n,o,v):t;C===t&&(C=E),ou(n,N,C)}},mr)}function Q_(n,o,h,d,v,E,N){var C=Fu(n,h),T=Fu(o,h),V=N.get(T);if(V){ou(n,h,V);return}var J=E?E(C,T,h+"",n,o,N):t,G=J===t;if(G){var Z=Se(T),he=!Z&&mn(T),ve=!Z&&!he&&xs(T);J=T,Z||he||ve?Se(C)?J=C:qt(C)?J=pr(C):he?(G=!1,J=fp(T,!0)):ve?(G=!1,J=dp(T,!0)):J=[]:mo(T)||kn(T)?(J=C,kn(C)?J=u0(C):(!Nt(C)||Gi(C))&&(J=Cp(T))):G=!1}G&&(N.set(T,J),v(J,T,d,E,N),N.delete(T)),ou(n,h,J)}function tp(n,o){var h=n.length;if(h)return o+=o<0?h:0,Qi(o,h)?n[o]:t}function rp(n,o,h){o.length?o=Rt(o,function(E){return Se(E)?function(N){return Tn(N,E.length===1?E[0]:E)}:E}):o=[vr];var d=-1;o=Rt(o,Ar(me()));var v=Zd(n,function(E,N,C){var T=Rt(o,function(V){return V(E)});return{criteria:T,index:++d,value:E}});return _3(v,function(E,N){return aA(E,N,h)})}function G_(n,o){return ip(n,o,function(h,d){return Lu(n,d)})}function ip(n,o,h){for(var d=-1,v=o.length,E={};++d<v;){var N=o[d],C=Tn(n,N);h(C,N)&&lo(E,pn(N,n),C)}return E}function Y_(n){return function(o){return Tn(o,n)}}function gu(n,o,h,d){var v=d?b3:gs,E=-1,N=o.length,C=n;for(n===o&&(o=pr(o)),h&&(C=Rt(n,Ar(h)));++E<N;)for(var T=0,V=o[E],J=h?h(V):V;(T=v(C,J,T,d))>-1;)C!==n&&ca.call(C,T,1),ca.call(n,T,1);return n}function np(n,o){for(var h=n?o.length:0,d=h-1;h--;){var v=o[h];if(h==d||v!==E){var E=v;Qi(v)?ca.call(n,v,1):wu(n,v)}}return n}function mu(n,o){return n+la(kd()*(o-n+1))}function W_(n,o,h,d){for(var v=-1,E=Lt(ha((o-n)/(h||1)),0),N=U(E);E--;)N[d?E:++v]=n,n+=h;return N}function vu(n,o){var h="";if(!n||o<1||o>O)return h;do o%2&&(h+=n),o=la(o/2),o&&(n+=n);while(o);return h}function Re(n,o){return Du(Dp(n,o,vr),n+"")}function Z_(n){return zd(Ps(n))}function X_(n,o){var h=Ps(n);return Ma(h,Dn(o,0,h.length))}function lo(n,o,h,d){if(!Nt(n))return n;o=pn(o,n);for(var v=-1,E=o.length,N=E-1,C=n;C!=null&&++v<E;){var T=xi(o[v]),V=h;if(T==="__proto__"||T==="constructor"||T==="prototype")return n;if(v!=N){var J=C[T];V=d?d(J,T,C):t,V===t&&(V=Nt(J)?J:Qi(o[v+1])?[]:{})}ao(C,T,V),C=C[T]}return n}var sp=fa?function(n,o){return fa.set(n,o),n}:vr,eA=ua?function(n,o){return ua(n,"toString",{configurable:!0,enumerable:!1,value:Hu(o),writable:!0})}:vr;function tA(n){return Ma(Ps(n))}function kr(n,o,h){var d=-1,v=n.length;o<0&&(o=-o>v?0:v+o),h=h>v?v:h,h<0&&(h+=v),v=o>h?0:h-o>>>0,o>>>=0;for(var E=U(v);++d<v;)E[d]=n[d+o];return E}function rA(n,o){var h;return fn(n,function(d,v,E){return h=o(d,v,E),!h}),!!h}function wa(n,o,h){var d=0,v=n==null?d:n.length;if(typeof o=="number"&&o===o&&v<=ge){for(;d<v;){var E=d+v>>>1,N=n[E];N!==null&&!Ir(N)&&(h?N<=o:N<o)?d=E+1:v=E}return v}return yu(n,o,vr,h)}function yu(n,o,h,d){var v=0,E=n==null?0:n.length;if(E===0)return 0;o=h(o);for(var N=o!==o,C=o===null,T=Ir(o),V=o===t;v<E;){var J=la((v+E)/2),G=h(n[J]),Z=G!==t,he=G===null,ve=G===G,Me=Ir(G);if(N)var ye=d||ve;else V?ye=ve&&(d||Z):C?ye=ve&&Z&&(d||!he):T?ye=ve&&Z&&!he&&(d||!Me):he||Me?ye=!1:ye=d?G<=o:G<o;ye?v=J+1:E=J}return er(E,I)}function op(n,o){for(var h=-1,d=n.length,v=0,E=[];++h<d;){var N=n[h],C=o?o(N):N;if(!h||!Xr(C,T)){var T=C;E[v++]=N===0?0:N}}return E}function ap(n){return typeof n=="number"?n:Ir(n)?x:+n}function Er(n){if(typeof n=="string")return n;if(Se(n))return Rt(n,Er)+"";if(Ir(n))return Ud?Ud.call(n):"";var o=n+"";return o=="0"&&1/n==-M?"-0":o}function dn(n,o,h){var d=-1,v=Zo,E=n.length,N=!0,C=[],T=C;if(h)N=!1,v=Jc;else if(E>=a){var V=o?null:dA(n);if(V)return ea(V);N=!1,v=to,T=new Fn}else T=o?[]:C;e:for(;++d<E;){var J=n[d],G=o?o(J):J;if(J=h||J!==0?J:0,N&&G===G){for(var Z=T.length;Z--;)if(T[Z]===G)continue e;o&&T.push(G),C.push(J)}else v(T,G,h)||(T!==C&&T.push(G),C.push(J))}return C}function wu(n,o){return o=pn(o,n),n=Tp(n,o),n==null||delete n[xi(Ur(o))]}function cp(n,o,h,d){return lo(n,o,h(Tn(n,o)),d)}function ba(n,o,h,d){for(var v=n.length,E=d?v:-1;(d?E--:++E<v)&&o(n[E],E,n););return h?kr(n,d?0:E,d?E+1:v):kr(n,d?E+1:0,d?v:E)}function up(n,o){var h=n;return h instanceof Te&&(h=h.value()),Qc(o,function(d,v){return v.func.apply(v.thisArg,un([d],v.args))},h)}function bu(n,o,h){var d=n.length;if(d<2)return d?dn(n[0]):[];for(var v=-1,E=U(d);++v<d;)for(var N=n[v],C=-1;++C<d;)C!=v&&(E[v]=co(E[v]||N,n[C],o,h));return dn(Zt(E,1),o,h)}function hp(n,o,h){for(var d=-1,v=n.length,E=o.length,N={};++d<v;){var C=d<E?o[d]:t;h(N,n[d],C)}return N}function _u(n){return qt(n)?n:[]}function Au(n){return typeof n=="function"?n:vr}function pn(n,o){return Se(n)?n:Cu(n,o)?[n]:Up(Je(n))}var iA=Re;function gn(n,o,h){var d=n.length;return h=h===t?d:h,!o&&h>=d?n:kr(n,o,h)}var lp=H3||function(n){return Wt.clearTimeout(n)};function fp(n,o){if(o)return n.slice();var h=n.length,d=Fd?Fd(h):new n.constructor(h);return n.copy(d),d}function Eu(n){var o=new n.constructor(n.byteLength);return new oa(o).set(new oa(n)),o}function nA(n,o){var h=o?Eu(n.buffer):n.buffer;return new n.constructor(h,n.byteOffset,n.byteLength)}function sA(n){var o=new n.constructor(n.source,st.exec(n));return o.lastIndex=n.lastIndex,o}function oA(n){return oo?It(oo.call(n)):{}}function dp(n,o){var h=o?Eu(n.buffer):n.buffer;return new n.constructor(h,n.byteOffset,n.length)}function pp(n,o){if(n!==o){var h=n!==t,d=n===null,v=n===n,E=Ir(n),N=o!==t,C=o===null,T=o===o,V=Ir(o);if(!C&&!V&&!E&&n>o||E&&N&&T&&!C&&!V||d&&N&&T||!h&&T||!v)return 1;if(!d&&!E&&!V&&n<o||V&&h&&v&&!d&&!E||C&&h&&v||!N&&v||!T)return-1}return 0}function aA(n,o,h){for(var d=-1,v=n.criteria,E=o.criteria,N=v.length,C=h.length;++d<N;){var T=pp(v[d],E[d]);if(T){if(d>=C)return T;var V=h[d];return T*(V=="desc"?-1:1)}}return n.index-o.index}function gp(n,o,h,d){for(var v=-1,E=n.length,N=h.length,C=-1,T=o.length,V=Lt(E-N,0),J=U(T+V),G=!d;++C<T;)J[C]=o[C];for(;++v<N;)(G||v<E)&&(J[h[v]]=n[v]);for(;V--;)J[C++]=n[v++];return J}function mp(n,o,h,d){for(var v=-1,E=n.length,N=-1,C=h.length,T=-1,V=o.length,J=Lt(E-C,0),G=U(J+V),Z=!d;++v<J;)G[v]=n[v];for(var he=v;++T<V;)G[he+T]=o[T];for(;++N<C;)(Z||v<E)&&(G[he+h[N]]=n[v++]);return G}function pr(n,o){var h=-1,d=n.length;for(o||(o=U(d));++h<d;)o[h]=n[h];return o}function Si(n,o,h,d){var v=!h;h||(h={});for(var E=-1,N=o.length;++E<N;){var C=o[E],T=d?d(h[C],n[C],C,h,n):t;T===t&&(T=n[C]),v?Vi(h,C,T):ao(h,C,T)}return h}function cA(n,o){return Si(n,Nu(n),o)}function uA(n,o){return Si(n,Rp(n),o)}function _a(n,o){return function(h,d){var v=Se(h)?p3:C_,E=o?o():{};return v(h,n,me(d,2),E)}}function Es(n){return Re(function(o,h){var d=-1,v=h.length,E=v>1?h[v-1]:t,N=v>2?h[2]:t;for(E=n.length>3&&typeof E=="function"?(v--,E):t,N&&ar(h[0],h[1],N)&&(E=v<3?t:E,v=1),o=It(o);++d<v;){var C=h[d];C&&n(o,C,d,E)}return o})}function vp(n,o){return function(h,d){if(h==null)return h;if(!gr(h))return n(h,d);for(var v=h.length,E=o?v:-1,N=It(h);(o?E--:++E<v)&&d(N[E],E,N)!==!1;);return h}}function yp(n){return function(o,h,d){for(var v=-1,E=It(o),N=d(o),C=N.length;C--;){var T=N[n?C:++v];if(h(E[T],T,E)===!1)break}return o}}function hA(n,o,h){var d=o&H,v=fo(n);function E(){var N=this&&this!==Wt&&this instanceof E?v:n;return N.apply(d?h:this,arguments)}return E}function wp(n){return function(o){o=Je(o);var h=ms(o)?Wr(o):t,d=h?h[0]:o.charAt(0),v=h?gn(h,1).join(""):o.slice(1);return d[n]()+v}}function Is(n){return function(o){return Qc(v0(m0(o).replace(e3,"")),n,"")}}function fo(n){return function(){var o=arguments;switch(o.length){case 0:return new n;case 1:return new n(o[0]);case 2:return new n(o[0],o[1]);case 3:return new n(o[0],o[1],o[2]);case 4:return new n(o[0],o[1],o[2],o[3]);case 5:return new n(o[0],o[1],o[2],o[3],o[4]);case 6:return new n(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new n(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var h=As(n.prototype),d=n.apply(h,o);return Nt(d)?d:h}}function lA(n,o,h){var d=fo(n);function v(){for(var E=arguments.length,N=U(E),C=E,T=Ss(v);C--;)N[C]=arguments[C];var V=E<3&&N[0]!==T&&N[E-1]!==T?[]:hn(N,T);if(E-=V.length,E<h)return Ip(n,o,Aa,v.placeholder,t,N,V,t,t,h-E);var J=this&&this!==Wt&&this instanceof v?d:n;return _r(J,this,N)}return v}function bp(n){return function(o,h,d){var v=It(o);if(!gr(o)){var E=me(h,3);o=Vt(o),h=function(C){return E(v[C],C,v)}}var N=n(o,h,d);return N>-1?v[E?o[N]:N]:t}}function _p(n){return Ji(function(o){var h=o.length,d=h,v=qr.prototype.thru;for(n&&o.reverse();d--;){var E=o[d];if(typeof E!="function")throw new Tr(f);if(v&&!N&&xa(E)=="wrapper")var N=new qr([],!0)}for(d=N?d:h;++d<h;){E=o[d];var C=xa(E),T=C=="wrapper"?Mu(E):t;T&&Ou(T[0])&&T[1]==(be|de|re|_e)&&!T[4].length&&T[9]==1?N=N[xa(T[0])].apply(N,T[3]):N=E.length==1&&Ou(E)?N[C]():N.thru(E)}return function(){var V=arguments,J=V[0];if(N&&V.length==1&&Se(J))return N.plant(J).value();for(var G=0,Z=h?o[G].apply(this,V):J;++G<h;)Z=o[G].call(this,Z);return Z}})}function Aa(n,o,h,d,v,E,N,C,T,V){var J=o&be,G=o&H,Z=o&ee,he=o&(de|oe),ve=o&Ve,Me=Z?t:fo(n);function ye(){for(var Oe=arguments.length,ke=U(Oe),Sr=Oe;Sr--;)ke[Sr]=arguments[Sr];if(he)var cr=Ss(ye),xr=E3(ke,cr);if(d&&(ke=gp(ke,d,v,he)),E&&(ke=mp(ke,E,N,he)),Oe-=xr,he&&Oe<V){var Bt=hn(ke,cr);return Ip(n,o,Aa,ye.placeholder,h,ke,Bt,C,T,V-Oe)}var ei=G?h:this,Wi=Z?ei[n]:n;return Oe=ke.length,C?ke=CA(ke,C):ve&&Oe>1&&ke.reverse(),J&&T<Oe&&(ke.length=T),this&&this!==Wt&&this instanceof ye&&(Wi=Me||fo(Wi)),Wi.apply(ei,ke)}return ye}function Ap(n,o){return function(h,d){return U_(h,n,o(d),{})}}function Ea(n,o){return function(h,d){var v;if(h===t&&d===t)return o;if(h!==t&&(v=h),d!==t){if(v===t)return d;typeof h=="string"||typeof d=="string"?(h=Er(h),d=Er(d)):(h=ap(h),d=ap(d)),v=n(h,d)}return v}}function Iu(n){return Ji(function(o){return o=Rt(o,Ar(me())),Re(function(h){var d=this;return n(o,function(v){return _r(v,d,h)})})})}function Ia(n,o){o=o===t?" ":Er(o);var h=o.length;if(h<2)return h?vu(o,n):o;var d=vu(o,ha(n/vs(o)));return ms(o)?gn(Wr(d),0,n).join(""):d.slice(0,n)}function fA(n,o,h,d){var v=o&H,E=fo(n);function N(){for(var C=-1,T=arguments.length,V=-1,J=d.length,G=U(J+T),Z=this&&this!==Wt&&this instanceof N?E:n;++V<J;)G[V]=d[V];for(;T--;)G[V++]=arguments[++C];return _r(Z,v?h:this,G)}return N}function Ep(n){return function(o,h,d){return d&&typeof d!="number"&&ar(o,h,d)&&(h=d=t),o=Yi(o),h===t?(h=o,o=0):h=Yi(h),d=d===t?o<h?1:-1:Yi(d),W_(o,h,d,n)}}function Sa(n){return function(o,h){return typeof o=="string"&&typeof h=="string"||(o=jr(o),h=jr(h)),n(o,h)}}function Ip(n,o,h,d,v,E,N,C,T,V){var J=o&de,G=J?N:t,Z=J?t:N,he=J?E:t,ve=J?t:E;o|=J?re:ue,o&=~(J?ue:re),o&pe||(o&=~(H|ee));var Me=[n,o,v,he,G,ve,Z,C,T,V],ye=h.apply(t,Me);return Ou(n)&&qp(ye,Me),ye.placeholder=d,Bp(ye,n,o)}function Su(n){var o=zt[n];return function(h,d){if(h=jr(h),d=d==null?0:er(Pe(d),292),d&&Bd(h)){var v=(Je(h)+"e").split("e"),E=o(v[0]+"e"+(+v[1]+d));return v=(Je(E)+"e").split("e"),+(v[0]+"e"+(+v[1]-d))}return o(h)}}var dA=bs&&1/ea(new bs([,-0]))[1]==M?function(n){return new bs(n)}:Ju;function Sp(n){return function(o){var h=tr(o);return h==W?tu(o):h==jt?N3(o):A3(o,n(o))}}function $i(n,o,h,d,v,E,N,C){var T=o&ee;if(!T&&typeof n!="function")throw new Tr(f);var V=d?d.length:0;if(V||(o&=~(re|ue),d=v=t),N=N===t?N:Lt(Pe(N),0),C=C===t?C:Pe(C),V-=v?v.length:0,o&ue){var J=d,G=v;d=v=t}var Z=T?t:Mu(n),he=[n,o,h,d,v,J,G,E,N,C];if(Z&&MA(he,Z),n=he[0],o=he[1],h=he[2],d=he[3],v=he[4],C=he[9]=he[9]===t?T?0:n.length:Lt(he[9]-V,0),!C&&o&(de|oe)&&(o&=~(de|oe)),!o||o==H)var ve=hA(n,o,h);else o==de||o==oe?ve=lA(n,o,C):(o==re||o==(H|re))&&!v.length?ve=fA(n,o,h,d):ve=Aa.apply(t,he);var Me=Z?sp:qp;return Bp(Me(ve,he),n,o)}function xp(n,o,h,d){return n===t||Xr(n,ws[h])&&!tt.call(d,h)?o:n}function Pp(n,o,h,d,v,E){return Nt(n)&&Nt(o)&&(E.set(o,n),ya(n,o,t,Pp,E),E.delete(o)),n}function pA(n){return mo(n)?t:n}function Mp(n,o,h,d,v,E){var N=h&k,C=n.length,T=o.length;if(C!=T&&!(N&&T>C))return!1;var V=E.get(n),J=E.get(o);if(V&&J)return V==o&&J==n;var G=-1,Z=!0,he=h&L?new Fn:t;for(E.set(n,o),E.set(o,n);++G<C;){var ve=n[G],Me=o[G];if(d)var ye=N?d(Me,ve,G,o,n,E):d(ve,Me,G,n,o,E);if(ye!==t){if(ye)continue;Z=!1;break}if(he){if(!Gc(o,function(Oe,ke){if(!to(he,ke)&&(ve===Oe||v(ve,Oe,h,d,E)))return he.push(ke)})){Z=!1;break}}else if(!(ve===Me||v(ve,Me,h,d,E))){Z=!1;break}}return E.delete(n),E.delete(o),Z}function gA(n,o,h,d,v,E,N){switch(h){case Ue:if(n.byteLength!=o.byteLength||n.byteOffset!=o.byteOffset)return!1;n=n.buffer,o=o.buffer;case br:return!(n.byteLength!=o.byteLength||!E(new oa(n),new oa(o)));case Q:case ne:case je:return Xr(+n,+o);case ie:return n.name==o.name&&n.message==o.message;case ze:case Le:return n==o+"";case W:var C=tu;case jt:var T=d&k;if(C||(C=ea),n.size!=o.size&&!T)return!1;var V=N.get(n);if(V)return V==o;d|=L,N.set(n,o);var J=Mp(C(n),C(o),d,v,E,N);return N.delete(n),J;case $e:if(oo)return oo.call(n)==oo.call(o)}return!1}function mA(n,o,h,d,v,E){var N=h&k,C=xu(n),T=C.length,V=xu(o),J=V.length;if(T!=J&&!N)return!1;for(var G=T;G--;){var Z=C[G];if(!(N?Z in o:tt.call(o,Z)))return!1}var he=E.get(n),ve=E.get(o);if(he&&ve)return he==o&&ve==n;var Me=!0;E.set(n,o),E.set(o,n);for(var ye=N;++G<T;){Z=C[G];var Oe=n[Z],ke=o[Z];if(d)var Sr=N?d(ke,Oe,Z,o,n,E):d(Oe,ke,Z,n,o,E);if(!(Sr===t?Oe===ke||v(Oe,ke,h,d,E):Sr)){Me=!1;break}ye||(ye=Z=="constructor")}if(Me&&!ye){var cr=n.constructor,xr=o.constructor;cr!=xr&&"constructor"in n&&"constructor"in o&&!(typeof cr=="function"&&cr instanceof cr&&typeof xr=="function"&&xr instanceof xr)&&(Me=!1)}return E.delete(n),E.delete(o),Me}function Ji(n){return Du(Dp(n,t,Kp),n+"")}function xu(n){return Qd(n,Vt,Nu)}function Pu(n){return Qd(n,mr,Rp)}var Mu=fa?function(n){return fa.get(n)}:Ju;function xa(n){for(var o=n.name+"",h=_s[o],d=tt.call(_s,o)?h.length:0;d--;){var v=h[d],E=v.func;if(E==null||E==n)return v.name}return o}function Ss(n){var o=tt.call(_,"placeholder")?_:n;return o.placeholder}function me(){var n=_.iteratee||Vu;return n=n===Vu?Wd:n,arguments.length?n(arguments[0],arguments[1]):n}function Pa(n,o){var h=n.__data__;return IA(o)?h[typeof o=="string"?"string":"hash"]:h.map}function Ru(n){for(var o=Vt(n),h=o.length;h--;){var d=o[h],v=n[d];o[h]=[d,v,Op(v)]}return o}function qn(n,o){var h=P3(n,o);return Yd(h)?h:t}function vA(n){var o=tt.call(n,Cn),h=n[Cn];try{n[Cn]=t;var d=!0}catch{}var v=na.call(n);return d&&(o?n[Cn]=h:delete n[Cn]),v}var Nu=iu?function(n){return n==null?[]:(n=It(n),cn(iu(n),function(o){return Td.call(n,o)}))}:Qu,Rp=iu?function(n){for(var o=[];n;)un(o,Nu(n)),n=aa(n);return o}:Qu,tr=or;(nu&&tr(new nu(new ArrayBuffer(1)))!=Ue||io&&tr(new io)!=W||su&&tr(su.resolve())!=mi||bs&&tr(new bs)!=jt||no&&tr(new no)!=Ke)&&(tr=function(n){var o=or(n),h=o==Be?n.constructor:t,d=h?Bn(h):"";if(d)switch(d){case X3:return Ue;case e_:return W;case t_:return mi;case r_:return jt;case i_:return Ke}return o});function yA(n,o,h){for(var d=-1,v=h.length;++d<v;){var E=h[d],N=E.size;switch(E.type){case"drop":n+=N;break;case"dropRight":o-=N;break;case"take":o=er(o,n+N);break;case"takeRight":n=Lt(n,o-N);break}}return{start:n,end:o}}function wA(n){var o=n.match(wt);return o?o[1].split(zi):[]}function Np(n,o,h){o=pn(o,n);for(var d=-1,v=o.length,E=!1;++d<v;){var N=xi(o[d]);if(!(E=n!=null&&h(n,N)))break;n=n[N]}return E||++d!=v?E:(v=n==null?0:n.length,!!v&&Da(v)&&Qi(N,v)&&(Se(n)||kn(n)))}function bA(n){var o=n.length,h=new n.constructor(o);return o&&typeof n[0]=="string"&&tt.call(n,"index")&&(h.index=n.index,h.input=n.input),h}function Cp(n){return typeof n.constructor=="function"&&!po(n)?As(aa(n)):{}}function _A(n,o,h){var d=n.constructor;switch(o){case br:return Eu(n);case Q:case ne:return new d(+n);case Ue:return nA(n,h);case Qe:case Jr:case Ge:case Ye:case Qr:case We:case Ze:case Gr:case Xe:return dp(n,h);case W:return new d;case je:case Le:return new d(n);case ze:return sA(n);case jt:return new d;case $e:return oA(n)}}function AA(n,o){var h=o.length;if(!h)return n;var d=h-1;return o[d]=(h>1?"& ":"")+o[d],o=o.join(h>2?", ":" "),n.replace(yt,`{
/* [wrapped with `+o+`] */
`)}function EA(n){return Se(n)||kn(n)||!!(qd&&n&&n[qd])}function Qi(n,o){var h=typeof n;return o=o??O,!!o&&(h=="number"||h!="symbol"&&Ai.test(n))&&n>-1&&n%1==0&&n<o}function ar(n,o,h){if(!Nt(h))return!1;var d=typeof o;return(d=="number"?gr(h)&&Qi(o,h.length):d=="string"&&o in h)?Xr(h[o],n):!1}function Cu(n,o){if(Se(n))return!1;var h=typeof n;return h=="number"||h=="symbol"||h=="boolean"||n==null||Ir(n)?!0:gt.test(n)||!Ui.test(n)||o!=null&&n in It(o)}function IA(n){var o=typeof n;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?n!=="__proto__":n===null}function Ou(n){var o=xa(n),h=_[o];if(typeof h!="function"||!(o in Te.prototype))return!1;if(n===h)return!0;var d=Mu(h);return!!d&&n===d[0]}function SA(n){return!!Od&&Od in n}var xA=ra?Gi:Gu;function po(n){var o=n&&n.constructor,h=typeof o=="function"&&o.prototype||ws;return n===h}function Op(n){return n===n&&!Nt(n)}function Fp(n,o){return function(h){return h==null?!1:h[n]===o&&(o!==t||n in It(h))}}function PA(n){var o=Oa(n,function(d){return h.size===w&&h.clear(),d}),h=o.cache;return o}function MA(n,o){var h=n[1],d=o[1],v=h|d,E=v<(H|ee|be),N=d==be&&h==de||d==be&&h==_e&&n[7].length<=o[8]||d==(be|_e)&&o[7].length<=o[8]&&h==de;if(!(E||N))return n;d&H&&(n[2]=o[2],v|=h&H?0:pe);var C=o[3];if(C){var T=n[3];n[3]=T?gp(T,C,o[4]):C,n[4]=T?hn(n[3],P):o[4]}return C=o[5],C&&(T=n[5],n[5]=T?mp(T,C,o[6]):C,n[6]=T?hn(n[5],P):o[6]),C=o[7],C&&(n[7]=C),d&be&&(n[8]=n[8]==null?o[8]:er(n[8],o[8])),n[9]==null&&(n[9]=o[9]),n[0]=o[0],n[1]=v,n}function RA(n){var o=[];if(n!=null)for(var h in It(n))o.push(h);return o}function NA(n){return na.call(n)}function Dp(n,o,h){return o=Lt(o===t?n.length-1:o,0),function(){for(var d=arguments,v=-1,E=Lt(d.length-o,0),N=U(E);++v<E;)N[v]=d[o+v];v=-1;for(var C=U(o+1);++v<o;)C[v]=d[v];return C[o]=h(N),_r(n,this,C)}}function Tp(n,o){return o.length<2?n:Tn(n,kr(o,0,-1))}function CA(n,o){for(var h=n.length,d=er(o.length,h),v=pr(n);d--;){var E=o[d];n[d]=Qi(E,h)?v[E]:t}return n}function Fu(n,o){if(!(o==="constructor"&&typeof n[o]=="function")&&o!="__proto__")return n[o]}var qp=kp(sp),go=$3||function(n,o){return Wt.setTimeout(n,o)},Du=kp(eA);function Bp(n,o,h){var d=o+"";return Du(n,AA(d,OA(wA(d),h)))}function kp(n){var o=0,h=0;return function(){var d=Y3(),v=l-(d-h);if(h=d,v>0){if(++o>=kt)return arguments[0]}else o=0;return n.apply(t,arguments)}}function Ma(n,o){var h=-1,d=n.length,v=d-1;for(o=o===t?d:o;++h<o;){var E=mu(h,v),N=n[E];n[E]=n[h],n[h]=N}return n.length=o,n}var Up=PA(function(n){var o=[];return n.charCodeAt(0)===46&&o.push(""),n.replace(mt,function(h,d,v,E){o.push(v?E.replace(Li,"$1"):d||h)}),o});function xi(n){if(typeof n=="string"||Ir(n))return n;var o=n+"";return o=="0"&&1/n==-M?"-0":o}function Bn(n){if(n!=null){try{return ia.call(n)}catch{}try{return n+""}catch{}}return""}function OA(n,o){return Dr(le,function(h){var d="_."+h[0];o&h[1]&&!Zo(n,d)&&n.push(d)}),n.sort()}function jp(n){if(n instanceof Te)return n.clone();var o=new qr(n.__wrapped__,n.__chain__);return o.__actions__=pr(n.__actions__),o.__index__=n.__index__,o.__values__=n.__values__,o}function FA(n,o,h){(h?ar(n,o,h):o===t)?o=1:o=Lt(Pe(o),0);var d=n==null?0:n.length;if(!d||o<1)return[];for(var v=0,E=0,N=U(ha(d/o));v<d;)N[E++]=kr(n,v,v+=o);return N}function DA(n){for(var o=-1,h=n==null?0:n.length,d=0,v=[];++o<h;){var E=n[o];E&&(v[d++]=E)}return v}function TA(){var n=arguments.length;if(!n)return[];for(var o=U(n-1),h=arguments[0],d=n;d--;)o[d-1]=arguments[d];return un(Se(h)?pr(h):[h],Zt(o,1))}var qA=Re(function(n,o){return qt(n)?co(n,Zt(o,1,qt,!0)):[]}),BA=Re(function(n,o){var h=Ur(o);return qt(h)&&(h=t),qt(n)?co(n,Zt(o,1,qt,!0),me(h,2)):[]}),kA=Re(function(n,o){var h=Ur(o);return qt(h)&&(h=t),qt(n)?co(n,Zt(o,1,qt,!0),t,h):[]});function UA(n,o,h){var d=n==null?0:n.length;return d?(o=h||o===t?1:Pe(o),kr(n,o<0?0:o,d)):[]}function jA(n,o,h){var d=n==null?0:n.length;return d?(o=h||o===t?1:Pe(o),o=d-o,kr(n,0,o<0?0:o)):[]}function zA(n,o){return n&&n.length?ba(n,me(o,3),!0,!0):[]}function LA(n,o){return n&&n.length?ba(n,me(o,3),!0):[]}function KA(n,o,h,d){var v=n==null?0:n.length;return v?(h&&typeof h!="number"&&ar(n,o,h)&&(h=0,d=v),T_(n,o,h,d)):[]}function zp(n,o,h){var d=n==null?0:n.length;if(!d)return-1;var v=h==null?0:Pe(h);return v<0&&(v=Lt(d+v,0)),Xo(n,me(o,3),v)}function Lp(n,o,h){var d=n==null?0:n.length;if(!d)return-1;var v=d-1;return h!==t&&(v=Pe(h),v=h<0?Lt(d+v,0):er(v,d-1)),Xo(n,me(o,3),v,!0)}function Kp(n){var o=n==null?0:n.length;return o?Zt(n,1):[]}function HA(n){var o=n==null?0:n.length;return o?Zt(n,M):[]}function VA(n,o){var h=n==null?0:n.length;return h?(o=o===t?1:Pe(o),Zt(n,o)):[]}function $A(n){for(var o=-1,h=n==null?0:n.length,d={};++o<h;){var v=n[o];d[v[0]]=v[1]}return d}function Hp(n){return n&&n.length?n[0]:t}function JA(n,o,h){var d=n==null?0:n.length;if(!d)return-1;var v=h==null?0:Pe(h);return v<0&&(v=Lt(d+v,0)),gs(n,o,v)}function QA(n){var o=n==null?0:n.length;return o?kr(n,0,-1):[]}var GA=Re(function(n){var o=Rt(n,_u);return o.length&&o[0]===n[0]?lu(o):[]}),YA=Re(function(n){var o=Ur(n),h=Rt(n,_u);return o===Ur(h)?o=t:h.pop(),h.length&&h[0]===n[0]?lu(h,me(o,2)):[]}),WA=Re(function(n){var o=Ur(n),h=Rt(n,_u);return o=typeof o=="function"?o:t,o&&h.pop(),h.length&&h[0]===n[0]?lu(h,t,o):[]});function ZA(n,o){return n==null?"":Q3.call(n,o)}function Ur(n){var o=n==null?0:n.length;return o?n[o-1]:t}function XA(n,o,h){var d=n==null?0:n.length;if(!d)return-1;var v=d;return h!==t&&(v=Pe(h),v=v<0?Lt(d+v,0):er(v,d-1)),o===o?O3(n,o,v):Xo(n,Id,v,!0)}function e6(n,o){return n&&n.length?tp(n,Pe(o)):t}var t6=Re(Vp);function Vp(n,o){return n&&n.length&&o&&o.length?gu(n,o):n}function r6(n,o,h){return n&&n.length&&o&&o.length?gu(n,o,me(h,2)):n}function i6(n,o,h){return n&&n.length&&o&&o.length?gu(n,o,t,h):n}var n6=Ji(function(n,o){var h=n==null?0:n.length,d=au(n,o);return np(n,Rt(o,function(v){return Qi(v,h)?+v:v}).sort(pp)),d});function s6(n,o){var h=[];if(!(n&&n.length))return h;var d=-1,v=[],E=n.length;for(o=me(o,3);++d<E;){var N=n[d];o(N,d,n)&&(h.push(N),v.push(d))}return np(n,v),h}function Tu(n){return n==null?n:Z3.call(n)}function o6(n,o,h){var d=n==null?0:n.length;return d?(h&&typeof h!="number"&&ar(n,o,h)?(o=0,h=d):(o=o==null?0:Pe(o),h=h===t?d:Pe(h)),kr(n,o,h)):[]}function a6(n,o){return wa(n,o)}function c6(n,o,h){return yu(n,o,me(h,2))}function u6(n,o){var h=n==null?0:n.length;if(h){var d=wa(n,o);if(d<h&&Xr(n[d],o))return d}return-1}function h6(n,o){return wa(n,o,!0)}function l6(n,o,h){return yu(n,o,me(h,2),!0)}function f6(n,o){var h=n==null?0:n.length;if(h){var d=wa(n,o,!0)-1;if(Xr(n[d],o))return d}return-1}function d6(n){return n&&n.length?op(n):[]}function p6(n,o){return n&&n.length?op(n,me(o,2)):[]}function g6(n){var o=n==null?0:n.length;return o?kr(n,1,o):[]}function m6(n,o,h){return n&&n.length?(o=h||o===t?1:Pe(o),kr(n,0,o<0?0:o)):[]}function v6(n,o,h){var d=n==null?0:n.length;return d?(o=h||o===t?1:Pe(o),o=d-o,kr(n,o<0?0:o,d)):[]}function y6(n,o){return n&&n.length?ba(n,me(o,3),!1,!0):[]}function w6(n,o){return n&&n.length?ba(n,me(o,3)):[]}var b6=Re(function(n){return dn(Zt(n,1,qt,!0))}),_6=Re(function(n){var o=Ur(n);return qt(o)&&(o=t),dn(Zt(n,1,qt,!0),me(o,2))}),A6=Re(function(n){var o=Ur(n);return o=typeof o=="function"?o:t,dn(Zt(n,1,qt,!0),t,o)});function E6(n){return n&&n.length?dn(n):[]}function I6(n,o){return n&&n.length?dn(n,me(o,2)):[]}function S6(n,o){return o=typeof o=="function"?o:t,n&&n.length?dn(n,t,o):[]}function qu(n){if(!(n&&n.length))return[];var o=0;return n=cn(n,function(h){if(qt(h))return o=Lt(h.length,o),!0}),Xc(o,function(h){return Rt(n,Yc(h))})}function $p(n,o){if(!(n&&n.length))return[];var h=qu(n);return o==null?h:Rt(h,function(d){return _r(o,t,d)})}var x6=Re(function(n,o){return qt(n)?co(n,o):[]}),P6=Re(function(n){return bu(cn(n,qt))}),M6=Re(function(n){var o=Ur(n);return qt(o)&&(o=t),bu(cn(n,qt),me(o,2))}),R6=Re(function(n){var o=Ur(n);return o=typeof o=="function"?o:t,bu(cn(n,qt),t,o)}),N6=Re(qu);function C6(n,o){return hp(n||[],o||[],ao)}function O6(n,o){return hp(n||[],o||[],lo)}var F6=Re(function(n){var o=n.length,h=o>1?n[o-1]:t;return h=typeof h=="function"?(n.pop(),h):t,$p(n,h)});function Jp(n){var o=_(n);return o.__chain__=!0,o}function D6(n,o){return o(n),n}function Ra(n,o){return o(n)}var T6=Ji(function(n){var o=n.length,h=o?n[0]:0,d=this.__wrapped__,v=function(E){return au(E,n)};return o>1||this.__actions__.length||!(d instanceof Te)||!Qi(h)?this.thru(v):(d=d.slice(h,+h+(o?1:0)),d.__actions__.push({func:Ra,args:[v],thisArg:t}),new qr(d,this.__chain__).thru(function(E){return o&&!E.length&&E.push(t),E}))});function q6(){return Jp(this)}function B6(){return new qr(this.value(),this.__chain__)}function k6(){this.__values__===t&&(this.__values__=a0(this.value()));var n=this.__index__>=this.__values__.length,o=n?t:this.__values__[this.__index__++];return{done:n,value:o}}function U6(){return this}function j6(n){for(var o,h=this;h instanceof pa;){var d=jp(h);d.__index__=0,d.__values__=t,o?v.__wrapped__=d:o=d;var v=d;h=h.__wrapped__}return v.__wrapped__=n,o}function z6(){var n=this.__wrapped__;if(n instanceof Te){var o=n;return this.__actions__.length&&(o=new Te(this)),o=o.reverse(),o.__actions__.push({func:Ra,args:[Tu],thisArg:t}),new qr(o,this.__chain__)}return this.thru(Tu)}function L6(){return up(this.__wrapped__,this.__actions__)}var K6=_a(function(n,o,h){tt.call(n,h)?++n[h]:Vi(n,h,1)});function H6(n,o,h){var d=Se(n)?Ad:D_;return h&&ar(n,o,h)&&(o=t),d(n,me(o,3))}function V6(n,o){var h=Se(n)?cn:$d;return h(n,me(o,3))}var $6=bp(zp),J6=bp(Lp);function Q6(n,o){return Zt(Na(n,o),1)}function G6(n,o){return Zt(Na(n,o),M)}function Y6(n,o,h){return h=h===t?1:Pe(h),Zt(Na(n,o),h)}function Qp(n,o){var h=Se(n)?Dr:fn;return h(n,me(o,3))}function Gp(n,o){var h=Se(n)?g3:Vd;return h(n,me(o,3))}var W6=_a(function(n,o,h){tt.call(n,h)?n[h].push(o):Vi(n,h,[o])});function Z6(n,o,h,d){n=gr(n)?n:Ps(n),h=h&&!d?Pe(h):0;var v=n.length;return h<0&&(h=Lt(v+h,0)),Ta(n)?h<=v&&n.indexOf(o,h)>-1:!!v&&gs(n,o,h)>-1}var X6=Re(function(n,o,h){var d=-1,v=typeof o=="function",E=gr(n)?U(n.length):[];return fn(n,function(N){E[++d]=v?_r(o,N,h):uo(N,o,h)}),E}),eE=_a(function(n,o,h){Vi(n,h,o)});function Na(n,o){var h=Se(n)?Rt:Zd;return h(n,me(o,3))}function tE(n,o,h,d){return n==null?[]:(Se(o)||(o=o==null?[]:[o]),h=d?t:h,Se(h)||(h=h==null?[]:[h]),rp(n,o,h))}var rE=_a(function(n,o,h){n[h?0:1].push(o)},function(){return[[],[]]});function iE(n,o,h){var d=Se(n)?Qc:xd,v=arguments.length<3;return d(n,me(o,4),h,v,fn)}function nE(n,o,h){var d=Se(n)?m3:xd,v=arguments.length<3;return d(n,me(o,4),h,v,Vd)}function sE(n,o){var h=Se(n)?cn:$d;return h(n,Fa(me(o,3)))}function oE(n){var o=Se(n)?zd:Z_;return o(n)}function aE(n,o,h){(h?ar(n,o,h):o===t)?o=1:o=Pe(o);var d=Se(n)?R_:X_;return d(n,o)}function cE(n){var o=Se(n)?N_:tA;return o(n)}function uE(n){if(n==null)return 0;if(gr(n))return Ta(n)?vs(n):n.length;var o=tr(n);return o==W||o==jt?n.size:du(n).length}function hE(n,o,h){var d=Se(n)?Gc:rA;return h&&ar(n,o,h)&&(o=t),d(n,me(o,3))}var lE=Re(function(n,o){if(n==null)return[];var h=o.length;return h>1&&ar(n,o[0],o[1])?o=[]:h>2&&ar(o[0],o[1],o[2])&&(o=[o[0]]),rp(n,Zt(o,1),[])}),Ca=V3||function(){return Wt.Date.now()};function fE(n,o){if(typeof o!="function")throw new Tr(f);return n=Pe(n),function(){if(--n<1)return o.apply(this,arguments)}}function Yp(n,o,h){return o=h?t:o,o=n&&o==null?n.length:o,$i(n,be,t,t,t,t,o)}function Wp(n,o){var h;if(typeof o!="function")throw new Tr(f);return n=Pe(n),function(){return--n>0&&(h=o.apply(this,arguments)),n<=1&&(o=t),h}}var Bu=Re(function(n,o,h){var d=H;if(h.length){var v=hn(h,Ss(Bu));d|=re}return $i(n,d,o,h,v)}),Zp=Re(function(n,o,h){var d=H|ee;if(h.length){var v=hn(h,Ss(Zp));d|=re}return $i(o,d,n,h,v)});function Xp(n,o,h){o=h?t:o;var d=$i(n,de,t,t,t,t,t,o);return d.placeholder=Xp.placeholder,d}function e0(n,o,h){o=h?t:o;var d=$i(n,oe,t,t,t,t,t,o);return d.placeholder=e0.placeholder,d}function t0(n,o,h){var d,v,E,N,C,T,V=0,J=!1,G=!1,Z=!0;if(typeof n!="function")throw new Tr(f);o=jr(o)||0,Nt(h)&&(J=!!h.leading,G="maxWait"in h,E=G?Lt(jr(h.maxWait)||0,o):E,Z="trailing"in h?!!h.trailing:Z);function he(Bt){var ei=d,Wi=v;return d=v=t,V=Bt,N=n.apply(Wi,ei),N}function ve(Bt){return V=Bt,C=go(Oe,o),J?he(Bt):N}function Me(Bt){var ei=Bt-T,Wi=Bt-V,b0=o-ei;return G?er(b0,E-Wi):b0}function ye(Bt){var ei=Bt-T,Wi=Bt-V;return T===t||ei>=o||ei<0||G&&Wi>=E}function Oe(){var Bt=Ca();if(ye(Bt))return ke(Bt);C=go(Oe,Me(Bt))}function ke(Bt){return C=t,Z&&d?he(Bt):(d=v=t,N)}function Sr(){C!==t&&lp(C),V=0,d=T=v=C=t}function cr(){return C===t?N:ke(Ca())}function xr(){var Bt=Ca(),ei=ye(Bt);if(d=arguments,v=this,T=Bt,ei){if(C===t)return ve(T);if(G)return lp(C),C=go(Oe,o),he(T)}return C===t&&(C=go(Oe,o)),N}return xr.cancel=Sr,xr.flush=cr,xr}var dE=Re(function(n,o){return Hd(n,1,o)}),pE=Re(function(n,o,h){return Hd(n,jr(o)||0,h)});function gE(n){return $i(n,Ve)}function Oa(n,o){if(typeof n!="function"||o!=null&&typeof o!="function")throw new Tr(f);var h=function(){var d=arguments,v=o?o.apply(this,d):d[0],E=h.cache;if(E.has(v))return E.get(v);var N=n.apply(this,d);return h.cache=E.set(v,N)||E,N};return h.cache=new(Oa.Cache||Hi),h}Oa.Cache=Hi;function Fa(n){if(typeof n!="function")throw new Tr(f);return function(){var o=arguments;switch(o.length){case 0:return!n.call(this);case 1:return!n.call(this,o[0]);case 2:return!n.call(this,o[0],o[1]);case 3:return!n.call(this,o[0],o[1],o[2])}return!n.apply(this,o)}}function mE(n){return Wp(2,n)}var vE=iA(function(n,o){o=o.length==1&&Se(o[0])?Rt(o[0],Ar(me())):Rt(Zt(o,1),Ar(me()));var h=o.length;return Re(function(d){for(var v=-1,E=er(d.length,h);++v<E;)d[v]=o[v].call(this,d[v]);return _r(n,this,d)})}),ku=Re(function(n,o){var h=hn(o,Ss(ku));return $i(n,re,t,o,h)}),r0=Re(function(n,o){var h=hn(o,Ss(r0));return $i(n,ue,t,o,h)}),yE=Ji(function(n,o){return $i(n,_e,t,t,t,o)});function wE(n,o){if(typeof n!="function")throw new Tr(f);return o=o===t?o:Pe(o),Re(n,o)}function bE(n,o){if(typeof n!="function")throw new Tr(f);return o=o==null?0:Lt(Pe(o),0),Re(function(h){var d=h[o],v=gn(h,0,o);return d&&un(v,d),_r(n,this,v)})}function _E(n,o,h){var d=!0,v=!0;if(typeof n!="function")throw new Tr(f);return Nt(h)&&(d="leading"in h?!!h.leading:d,v="trailing"in h?!!h.trailing:v),t0(n,o,{leading:d,maxWait:o,trailing:v})}function AE(n){return Yp(n,1)}function EE(n,o){return ku(Au(o),n)}function IE(){if(!arguments.length)return[];var n=arguments[0];return Se(n)?n:[n]}function SE(n){return Br(n,B)}function xE(n,o){return o=typeof o=="function"?o:t,Br(n,B,o)}function PE(n){return Br(n,R|B)}function ME(n,o){return o=typeof o=="function"?o:t,Br(n,R|B,o)}function RE(n,o){return o==null||Kd(n,o,Vt(o))}function Xr(n,o){return n===o||n!==n&&o!==o}var NE=Sa(hu),CE=Sa(function(n,o){return n>=o}),kn=Gd(function(){return arguments}())?Gd:function(n){return Ot(n)&&tt.call(n,"callee")&&!Td.call(n,"callee")},Se=U.isArray,OE=md?Ar(md):j_;function gr(n){return n!=null&&Da(n.length)&&!Gi(n)}function qt(n){return Ot(n)&&gr(n)}function FE(n){return n===!0||n===!1||Ot(n)&&or(n)==Q}var mn=J3||Gu,DE=vd?Ar(vd):z_;function TE(n){return Ot(n)&&n.nodeType===1&&!mo(n)}function qE(n){if(n==null)return!0;if(gr(n)&&(Se(n)||typeof n=="string"||typeof n.splice=="function"||mn(n)||xs(n)||kn(n)))return!n.length;var o=tr(n);if(o==W||o==jt)return!n.size;if(po(n))return!du(n).length;for(var h in n)if(tt.call(n,h))return!1;return!0}function BE(n,o){return ho(n,o)}function kE(n,o,h){h=typeof h=="function"?h:t;var d=h?h(n,o):t;return d===t?ho(n,o,t,h):!!d}function Uu(n){if(!Ot(n))return!1;var o=or(n);return o==ie||o==te||typeof n.message=="string"&&typeof n.name=="string"&&!mo(n)}function UE(n){return typeof n=="number"&&Bd(n)}function Gi(n){if(!Nt(n))return!1;var o=or(n);return o==fe||o==Ae||o==j||o==ct}function i0(n){return typeof n=="number"&&n==Pe(n)}function Da(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=O}function Nt(n){var o=typeof n;return n!=null&&(o=="object"||o=="function")}function Ot(n){return n!=null&&typeof n=="object"}var n0=yd?Ar(yd):K_;function jE(n,o){return n===o||fu(n,o,Ru(o))}function zE(n,o,h){return h=typeof h=="function"?h:t,fu(n,o,Ru(o),h)}function LE(n){return s0(n)&&n!=+n}function KE(n){if(xA(n))throw new Ee(u);return Yd(n)}function HE(n){return n===null}function VE(n){return n==null}function s0(n){return typeof n=="number"||Ot(n)&&or(n)==je}function mo(n){if(!Ot(n)||or(n)!=Be)return!1;var o=aa(n);if(o===null)return!0;var h=tt.call(o,"constructor")&&o.constructor;return typeof h=="function"&&h instanceof h&&ia.call(h)==z3}var ju=wd?Ar(wd):H_;function $E(n){return i0(n)&&n>=-O&&n<=O}var o0=bd?Ar(bd):V_;function Ta(n){return typeof n=="string"||!Se(n)&&Ot(n)&&or(n)==Le}function Ir(n){return typeof n=="symbol"||Ot(n)&&or(n)==$e}var xs=_d?Ar(_d):$_;function JE(n){return n===t}function QE(n){return Ot(n)&&tr(n)==Ke}function GE(n){return Ot(n)&&or(n)==ut}var YE=Sa(pu),WE=Sa(function(n,o){return n<=o});function a0(n){if(!n)return[];if(gr(n))return Ta(n)?Wr(n):pr(n);if(ro&&n[ro])return R3(n[ro]());var o=tr(n),h=o==W?tu:o==jt?ea:Ps;return h(n)}function Yi(n){if(!n)return n===0?n:0;if(n=jr(n),n===M||n===-M){var o=n<0?-1:1;return o*q}return n===n?n:0}function Pe(n){var o=Yi(n),h=o%1;return o===o?h?o-h:o:0}function c0(n){return n?Dn(Pe(n),0,p):0}function jr(n){if(typeof n=="number")return n;if(Ir(n))return x;if(Nt(n)){var o=typeof n.valueOf=="function"?n.valueOf():n;n=Nt(o)?o+"":o}if(typeof n!="string")return n===0?n:+n;n=Pd(n);var h=wi.test(n);return h||_i.test(n)?f3(n.slice(2),h?2:8):yi.test(n)?x:+n}function u0(n){return Si(n,mr(n))}function ZE(n){return n?Dn(Pe(n),-O,O):n===0?n:0}function Je(n){return n==null?"":Er(n)}var XE=Es(function(n,o){if(po(o)||gr(o)){Si(o,Vt(o),n);return}for(var h in o)tt.call(o,h)&&ao(n,h,o[h])}),h0=Es(function(n,o){Si(o,mr(o),n)}),qa=Es(function(n,o,h,d){Si(o,mr(o),n,d)}),e8=Es(function(n,o,h,d){Si(o,Vt(o),n,d)}),t8=Ji(au);function r8(n,o){var h=As(n);return o==null?h:Ld(h,o)}var i8=Re(function(n,o){n=It(n);var h=-1,d=o.length,v=d>2?o[2]:t;for(v&&ar(o[0],o[1],v)&&(d=1);++h<d;)for(var E=o[h],N=mr(E),C=-1,T=N.length;++C<T;){var V=N[C],J=n[V];(J===t||Xr(J,ws[V])&&!tt.call(n,V))&&(n[V]=E[V])}return n}),n8=Re(function(n){return n.push(t,Pp),_r(l0,t,n)});function s8(n,o){return Ed(n,me(o,3),Ii)}function o8(n,o){return Ed(n,me(o,3),uu)}function a8(n,o){return n==null?n:cu(n,me(o,3),mr)}function c8(n,o){return n==null?n:Jd(n,me(o,3),mr)}function u8(n,o){return n&&Ii(n,me(o,3))}function h8(n,o){return n&&uu(n,me(o,3))}function l8(n){return n==null?[]:va(n,Vt(n))}function f8(n){return n==null?[]:va(n,mr(n))}function zu(n,o,h){var d=n==null?t:Tn(n,o);return d===t?h:d}function d8(n,o){return n!=null&&Np(n,o,q_)}function Lu(n,o){return n!=null&&Np(n,o,B_)}var p8=Ap(function(n,o,h){o!=null&&typeof o.toString!="function"&&(o=na.call(o)),n[o]=h},Hu(vr)),g8=Ap(function(n,o,h){o!=null&&typeof o.toString!="function"&&(o=na.call(o)),tt.call(n,o)?n[o].push(h):n[o]=[h]},me),m8=Re(uo);function Vt(n){return gr(n)?jd(n):du(n)}function mr(n){return gr(n)?jd(n,!0):J_(n)}function v8(n,o){var h={};return o=me(o,3),Ii(n,function(d,v,E){Vi(h,o(d,v,E),d)}),h}function y8(n,o){var h={};return o=me(o,3),Ii(n,function(d,v,E){Vi(h,v,o(d,v,E))}),h}var w8=Es(function(n,o,h){ya(n,o,h)}),l0=Es(function(n,o,h,d){ya(n,o,h,d)}),b8=Ji(function(n,o){var h={};if(n==null)return h;var d=!1;o=Rt(o,function(E){return E=pn(E,n),d||(d=E.length>1),E}),Si(n,Pu(n),h),d&&(h=Br(h,R|F|B,pA));for(var v=o.length;v--;)wu(h,o[v]);return h});function _8(n,o){return f0(n,Fa(me(o)))}var A8=Ji(function(n,o){return n==null?{}:G_(n,o)});function f0(n,o){if(n==null)return{};var h=Rt(Pu(n),function(d){return[d]});return o=me(o),ip(n,h,function(d,v){return o(d,v[0])})}function E8(n,o,h){o=pn(o,n);var d=-1,v=o.length;for(v||(v=1,n=t);++d<v;){var E=n==null?t:n[xi(o[d])];E===t&&(d=v,E=h),n=Gi(E)?E.call(n):E}return n}function I8(n,o,h){return n==null?n:lo(n,o,h)}function S8(n,o,h,d){return d=typeof d=="function"?d:t,n==null?n:lo(n,o,h,d)}var d0=Sp(Vt),p0=Sp(mr);function x8(n,o,h){var d=Se(n),v=d||mn(n)||xs(n);if(o=me(o,4),h==null){var E=n&&n.constructor;v?h=d?new E:[]:Nt(n)?h=Gi(E)?As(aa(n)):{}:h={}}return(v?Dr:Ii)(n,function(N,C,T){return o(h,N,C,T)}),h}function P8(n,o){return n==null?!0:wu(n,o)}function M8(n,o,h){return n==null?n:cp(n,o,Au(h))}function R8(n,o,h,d){return d=typeof d=="function"?d:t,n==null?n:cp(n,o,Au(h),d)}function Ps(n){return n==null?[]:eu(n,Vt(n))}function N8(n){return n==null?[]:eu(n,mr(n))}function C8(n,o,h){return h===t&&(h=o,o=t),h!==t&&(h=jr(h),h=h===h?h:0),o!==t&&(o=jr(o),o=o===o?o:0),Dn(jr(n),o,h)}function O8(n,o,h){return o=Yi(o),h===t?(h=o,o=0):h=Yi(h),n=jr(n),k_(n,o,h)}function F8(n,o,h){if(h&&typeof h!="boolean"&&ar(n,o,h)&&(o=h=t),h===t&&(typeof o=="boolean"?(h=o,o=t):typeof n=="boolean"&&(h=n,n=t)),n===t&&o===t?(n=0,o=1):(n=Yi(n),o===t?(o=n,n=0):o=Yi(o)),n>o){var d=n;n=o,o=d}if(h||n%1||o%1){var v=kd();return er(n+v*(o-n+l3("1e-"+((v+"").length-1))),o)}return mu(n,o)}var D8=Is(function(n,o,h){return o=o.toLowerCase(),n+(h?g0(o):o)});function g0(n){return Ku(Je(n).toLowerCase())}function m0(n){return n=Je(n),n&&n.replace(Ei,I3).replace(t3,"")}function T8(n,o,h){n=Je(n),o=Er(o);var d=n.length;h=h===t?d:Dn(Pe(h),0,d);var v=h;return h-=o.length,h>=0&&n.slice(h,v)==o}function q8(n){return n=Je(n),n&&dt.test(n)?n.replace(vi,S3):n}function B8(n){return n=Je(n),n&&vt.test(n)?n.replace(Yr,"\\$&"):n}var k8=Is(function(n,o,h){return n+(h?"-":"")+o.toLowerCase()}),U8=Is(function(n,o,h){return n+(h?" ":"")+o.toLowerCase()}),j8=wp("toLowerCase");function z8(n,o,h){n=Je(n),o=Pe(o);var d=o?vs(n):0;if(!o||d>=o)return n;var v=(o-d)/2;return Ia(la(v),h)+n+Ia(ha(v),h)}function L8(n,o,h){n=Je(n),o=Pe(o);var d=o?vs(n):0;return o&&d<o?n+Ia(o-d,h):n}function K8(n,o,h){n=Je(n),o=Pe(o);var d=o?vs(n):0;return o&&d<o?Ia(o-d,h)+n:n}function H8(n,o,h){return h||o==null?o=0:o&&(o=+o),W3(Je(n).replace(et,""),o||0)}function V8(n,o,h){return(h?ar(n,o,h):o===t)?o=1:o=Pe(o),vu(Je(n),o)}function $8(){var n=arguments,o=Je(n[0]);return n.length<3?o:o.replace(n[1],n[2])}var J8=Is(function(n,o,h){return n+(h?"_":"")+o.toLowerCase()});function Q8(n,o,h){return h&&typeof h!="number"&&ar(n,o,h)&&(o=h=t),h=h===t?p:h>>>0,h?(n=Je(n),n&&(typeof o=="string"||o!=null&&!ju(o))&&(o=Er(o),!o&&ms(n))?gn(Wr(n),0,h):n.split(o,h)):[]}var G8=Is(function(n,o,h){return n+(h?" ":"")+Ku(o)});function Y8(n,o,h){return n=Je(n),h=h==null?0:Dn(Pe(h),0,n.length),o=Er(o),n.slice(h,h+o.length)==o}function W8(n,o,h){var d=_.templateSettings;h&&ar(n,o,h)&&(o=t),n=Je(n),o=qa({},o,d,xp);var v=qa({},o.imports,d.imports,xp),E=Vt(v),N=eu(v,E),C,T,V=0,J=o.interpolate||on,G="__p += '",Z=ru((o.escape||on).source+"|"+J.source+"|"+(J===nt?Et:on).source+"|"+(o.evaluate||on).source+"|$","g"),he="//# sourceURL="+(tt.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++o3+"]")+`
`;n.replace(Z,function(ye,Oe,ke,Sr,cr,xr){return ke||(ke=Sr),G+=n.slice(V,xr).replace(Js,x3),Oe&&(C=!0,G+=`' +
__e(`+Oe+`) +
'`),cr&&(T=!0,G+=`';
`+cr+`;
__p += '`),ke&&(G+=`' +
((__t = (`+ke+`)) == null ? '' : __t) +
'`),V=xr+ye.length,ye}),G+=`';
`;var ve=tt.call(o,"variable")&&o.variable;if(!ve)G=`with (obj) {
`+G+`
}
`;else if(At.test(ve))throw new Ee(m);G=(T?G.replace(ht,""):G).replace(Bi,"$1").replace(lt,"$1;"),G="function("+(ve||"obj")+`) {
`+(ve?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(C?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+G+`return __p
}`;var Me=y0(function(){return He(E,he+"return "+G).apply(t,N)});if(Me.source=G,Uu(Me))throw Me;return Me}function Z8(n){return Je(n).toLowerCase()}function X8(n){return Je(n).toUpperCase()}function e4(n,o,h){if(n=Je(n),n&&(h||o===t))return Pd(n);if(!n||!(o=Er(o)))return n;var d=Wr(n),v=Wr(o),E=Md(d,v),N=Rd(d,v)+1;return gn(d,E,N).join("")}function t4(n,o,h){if(n=Je(n),n&&(h||o===t))return n.slice(0,Cd(n)+1);if(!n||!(o=Er(o)))return n;var d=Wr(n),v=Rd(d,Wr(o))+1;return gn(d,0,v).join("")}function r4(n,o,h){if(n=Je(n),n&&(h||o===t))return n.replace(et,"");if(!n||!(o=Er(o)))return n;var d=Wr(n),v=Md(d,Wr(o));return gn(d,v).join("")}function i4(n,o){var h=Ht,d=qe;if(Nt(o)){var v="separator"in o?o.separator:v;h="length"in o?Pe(o.length):h,d="omission"in o?Er(o.omission):d}n=Je(n);var E=n.length;if(ms(n)){var N=Wr(n);E=N.length}if(h>=E)return n;var C=h-vs(d);if(C<1)return d;var T=N?gn(N,0,C).join(""):n.slice(0,C);if(v===t)return T+d;if(N&&(C+=T.length-C),ju(v)){if(n.slice(C).search(v)){var V,J=T;for(v.global||(v=ru(v.source,Je(st.exec(v))+"g")),v.lastIndex=0;V=v.exec(J);)var G=V.index;T=T.slice(0,G===t?C:G)}}else if(n.indexOf(Er(v),C)!=C){var Z=T.lastIndexOf(v);Z>-1&&(T=T.slice(0,Z))}return T+d}function n4(n){return n=Je(n),n&&ft.test(n)?n.replace(it,F3):n}var s4=Is(function(n,o,h){return n+(h?" ":"")+o.toUpperCase()}),Ku=wp("toUpperCase");function v0(n,o,h){return n=Je(n),o=h?t:o,o===t?M3(n)?q3(n):w3(n):n.match(o)||[]}var y0=Re(function(n,o){try{return _r(n,t,o)}catch(h){return Uu(h)?h:new Ee(h)}}),o4=Ji(function(n,o){return Dr(o,function(h){h=xi(h),Vi(n,h,Bu(n[h],n))}),n});function a4(n){var o=n==null?0:n.length,h=me();return n=o?Rt(n,function(d){if(typeof d[1]!="function")throw new Tr(f);return[h(d[0]),d[1]]}):[],Re(function(d){for(var v=-1;++v<o;){var E=n[v];if(_r(E[0],this,d))return _r(E[1],this,d)}})}function c4(n){return F_(Br(n,R))}function Hu(n){return function(){return n}}function u4(n,o){return n==null||n!==n?o:n}var h4=_p(),l4=_p(!0);function vr(n){return n}function Vu(n){return Wd(typeof n=="function"?n:Br(n,R))}function f4(n){return Xd(Br(n,R))}function d4(n,o){return ep(n,Br(o,R))}var p4=Re(function(n,o){return function(h){return uo(h,n,o)}}),g4=Re(function(n,o){return function(h){return uo(n,h,o)}});function $u(n,o,h){var d=Vt(o),v=va(o,d);h==null&&!(Nt(o)&&(v.length||!d.length))&&(h=o,o=n,n=this,v=va(o,Vt(o)));var E=!(Nt(h)&&"chain"in h)||!!h.chain,N=Gi(n);return Dr(v,function(C){var T=o[C];n[C]=T,N&&(n.prototype[C]=function(){var V=this.__chain__;if(E||V){var J=n(this.__wrapped__),G=J.__actions__=pr(this.__actions__);return G.push({func:T,args:arguments,thisArg:n}),J.__chain__=V,J}return T.apply(n,un([this.value()],arguments))})}),n}function m4(){return Wt._===this&&(Wt._=L3),this}function Ju(){}function v4(n){return n=Pe(n),Re(function(o){return tp(o,n)})}var y4=Iu(Rt),w4=Iu(Ad),b4=Iu(Gc);function w0(n){return Cu(n)?Yc(xi(n)):Y_(n)}function _4(n){return function(o){return n==null?t:Tn(n,o)}}var A4=Ep(),E4=Ep(!0);function Qu(){return[]}function Gu(){return!1}function I4(){return{}}function S4(){return""}function x4(){return!0}function P4(n,o){if(n=Pe(n),n<1||n>O)return[];var h=p,d=er(n,p);o=me(o),n-=p;for(var v=Xc(d,o);++h<n;)o(h);return v}function M4(n){return Se(n)?Rt(n,xi):Ir(n)?[n]:pr(Up(Je(n)))}function R4(n){var o=++j3;return Je(n)+o}var N4=Ea(function(n,o){return n+o},0),C4=Su("ceil"),O4=Ea(function(n,o){return n/o},1),F4=Su("floor");function D4(n){return n&&n.length?ma(n,vr,hu):t}function T4(n,o){return n&&n.length?ma(n,me(o,2),hu):t}function q4(n){return Sd(n,vr)}function B4(n,o){return Sd(n,me(o,2))}function k4(n){return n&&n.length?ma(n,vr,pu):t}function U4(n,o){return n&&n.length?ma(n,me(o,2),pu):t}var j4=Ea(function(n,o){return n*o},1),z4=Su("round"),L4=Ea(function(n,o){return n-o},0);function K4(n){return n&&n.length?Zc(n,vr):0}function H4(n,o){return n&&n.length?Zc(n,me(o,2)):0}return _.after=fE,_.ary=Yp,_.assign=XE,_.assignIn=h0,_.assignInWith=qa,_.assignWith=e8,_.at=t8,_.before=Wp,_.bind=Bu,_.bindAll=o4,_.bindKey=Zp,_.castArray=IE,_.chain=Jp,_.chunk=FA,_.compact=DA,_.concat=TA,_.cond=a4,_.conforms=c4,_.constant=Hu,_.countBy=K6,_.create=r8,_.curry=Xp,_.curryRight=e0,_.debounce=t0,_.defaults=i8,_.defaultsDeep=n8,_.defer=dE,_.delay=pE,_.difference=qA,_.differenceBy=BA,_.differenceWith=kA,_.drop=UA,_.dropRight=jA,_.dropRightWhile=zA,_.dropWhile=LA,_.fill=KA,_.filter=V6,_.flatMap=Q6,_.flatMapDeep=G6,_.flatMapDepth=Y6,_.flatten=Kp,_.flattenDeep=HA,_.flattenDepth=VA,_.flip=gE,_.flow=h4,_.flowRight=l4,_.fromPairs=$A,_.functions=l8,_.functionsIn=f8,_.groupBy=W6,_.initial=QA,_.intersection=GA,_.intersectionBy=YA,_.intersectionWith=WA,_.invert=p8,_.invertBy=g8,_.invokeMap=X6,_.iteratee=Vu,_.keyBy=eE,_.keys=Vt,_.keysIn=mr,_.map=Na,_.mapKeys=v8,_.mapValues=y8,_.matches=f4,_.matchesProperty=d4,_.memoize=Oa,_.merge=w8,_.mergeWith=l0,_.method=p4,_.methodOf=g4,_.mixin=$u,_.negate=Fa,_.nthArg=v4,_.omit=b8,_.omitBy=_8,_.once=mE,_.orderBy=tE,_.over=y4,_.overArgs=vE,_.overEvery=w4,_.overSome=b4,_.partial=ku,_.partialRight=r0,_.partition=rE,_.pick=A8,_.pickBy=f0,_.property=w0,_.propertyOf=_4,_.pull=t6,_.pullAll=Vp,_.pullAllBy=r6,_.pullAllWith=i6,_.pullAt=n6,_.range=A4,_.rangeRight=E4,_.rearg=yE,_.reject=sE,_.remove=s6,_.rest=wE,_.reverse=Tu,_.sampleSize=aE,_.set=I8,_.setWith=S8,_.shuffle=cE,_.slice=o6,_.sortBy=lE,_.sortedUniq=d6,_.sortedUniqBy=p6,_.split=Q8,_.spread=bE,_.tail=g6,_.take=m6,_.takeRight=v6,_.takeRightWhile=y6,_.takeWhile=w6,_.tap=D6,_.throttle=_E,_.thru=Ra,_.toArray=a0,_.toPairs=d0,_.toPairsIn=p0,_.toPath=M4,_.toPlainObject=u0,_.transform=x8,_.unary=AE,_.union=b6,_.unionBy=_6,_.unionWith=A6,_.uniq=E6,_.uniqBy=I6,_.uniqWith=S6,_.unset=P8,_.unzip=qu,_.unzipWith=$p,_.update=M8,_.updateWith=R8,_.values=Ps,_.valuesIn=N8,_.without=x6,_.words=v0,_.wrap=EE,_.xor=P6,_.xorBy=M6,_.xorWith=R6,_.zip=N6,_.zipObject=C6,_.zipObjectDeep=O6,_.zipWith=F6,_.entries=d0,_.entriesIn=p0,_.extend=h0,_.extendWith=qa,$u(_,_),_.add=N4,_.attempt=y0,_.camelCase=D8,_.capitalize=g0,_.ceil=C4,_.clamp=C8,_.clone=SE,_.cloneDeep=PE,_.cloneDeepWith=ME,_.cloneWith=xE,_.conformsTo=RE,_.deburr=m0,_.defaultTo=u4,_.divide=O4,_.endsWith=T8,_.eq=Xr,_.escape=q8,_.escapeRegExp=B8,_.every=H6,_.find=$6,_.findIndex=zp,_.findKey=s8,_.findLast=J6,_.findLastIndex=Lp,_.findLastKey=o8,_.floor=F4,_.forEach=Qp,_.forEachRight=Gp,_.forIn=a8,_.forInRight=c8,_.forOwn=u8,_.forOwnRight=h8,_.get=zu,_.gt=NE,_.gte=CE,_.has=d8,_.hasIn=Lu,_.head=Hp,_.identity=vr,_.includes=Z6,_.indexOf=JA,_.inRange=O8,_.invoke=m8,_.isArguments=kn,_.isArray=Se,_.isArrayBuffer=OE,_.isArrayLike=gr,_.isArrayLikeObject=qt,_.isBoolean=FE,_.isBuffer=mn,_.isDate=DE,_.isElement=TE,_.isEmpty=qE,_.isEqual=BE,_.isEqualWith=kE,_.isError=Uu,_.isFinite=UE,_.isFunction=Gi,_.isInteger=i0,_.isLength=Da,_.isMap=n0,_.isMatch=jE,_.isMatchWith=zE,_.isNaN=LE,_.isNative=KE,_.isNil=VE,_.isNull=HE,_.isNumber=s0,_.isObject=Nt,_.isObjectLike=Ot,_.isPlainObject=mo,_.isRegExp=ju,_.isSafeInteger=$E,_.isSet=o0,_.isString=Ta,_.isSymbol=Ir,_.isTypedArray=xs,_.isUndefined=JE,_.isWeakMap=QE,_.isWeakSet=GE,_.join=ZA,_.kebabCase=k8,_.last=Ur,_.lastIndexOf=XA,_.lowerCase=U8,_.lowerFirst=j8,_.lt=YE,_.lte=WE,_.max=D4,_.maxBy=T4,_.mean=q4,_.meanBy=B4,_.min=k4,_.minBy=U4,_.stubArray=Qu,_.stubFalse=Gu,_.stubObject=I4,_.stubString=S4,_.stubTrue=x4,_.multiply=j4,_.nth=e6,_.noConflict=m4,_.noop=Ju,_.now=Ca,_.pad=z8,_.padEnd=L8,_.padStart=K8,_.parseInt=H8,_.random=F8,_.reduce=iE,_.reduceRight=nE,_.repeat=V8,_.replace=$8,_.result=E8,_.round=z4,_.runInContext=D,_.sample=oE,_.size=uE,_.snakeCase=J8,_.some=hE,_.sortedIndex=a6,_.sortedIndexBy=c6,_.sortedIndexOf=u6,_.sortedLastIndex=h6,_.sortedLastIndexBy=l6,_.sortedLastIndexOf=f6,_.startCase=G8,_.startsWith=Y8,_.subtract=L4,_.sum=K4,_.sumBy=H4,_.template=W8,_.times=P4,_.toFinite=Yi,_.toInteger=Pe,_.toLength=c0,_.toLower=Z8,_.toNumber=jr,_.toSafeInteger=ZE,_.toString=Je,_.toUpper=X8,_.trim=e4,_.trimEnd=t4,_.trimStart=r4,_.truncate=i4,_.unescape=n4,_.uniqueId=R4,_.upperCase=s4,_.upperFirst=Ku,_.each=Qp,_.eachRight=Gp,_.first=Hp,$u(_,function(){var n={};return Ii(_,function(o,h){tt.call(_.prototype,h)||(n[h]=o)}),n}(),{chain:!1}),_.VERSION=s,Dr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){_[n].placeholder=_}),Dr(["drop","take"],function(n,o){Te.prototype[n]=function(h){h=h===t?1:Lt(Pe(h),0);var d=this.__filtered__&&!o?new Te(this):this.clone();return d.__filtered__?d.__takeCount__=er(h,d.__takeCount__):d.__views__.push({size:er(h,p),type:n+(d.__dir__<0?"Right":"")}),d},Te.prototype[n+"Right"]=function(h){return this.reverse()[n](h).reverse()}}),Dr(["filter","map","takeWhile"],function(n,o){var h=o+1,d=h==g||h==S;Te.prototype[n]=function(v){var E=this.clone();return E.__iteratees__.push({iteratee:me(v,3),type:h}),E.__filtered__=E.__filtered__||d,E}}),Dr(["head","last"],function(n,o){var h="take"+(o?"Right":"");Te.prototype[n]=function(){return this[h](1).value()[0]}}),Dr(["initial","tail"],function(n,o){var h="drop"+(o?"":"Right");Te.prototype[n]=function(){return this.__filtered__?new Te(this):this[h](1)}}),Te.prototype.compact=function(){return this.filter(vr)},Te.prototype.find=function(n){return this.filter(n).head()},Te.prototype.findLast=function(n){return this.reverse().find(n)},Te.prototype.invokeMap=Re(function(n,o){return typeof n=="function"?new Te(this):this.map(function(h){return uo(h,n,o)})}),Te.prototype.reject=function(n){return this.filter(Fa(me(n)))},Te.prototype.slice=function(n,o){n=Pe(n);var h=this;return h.__filtered__&&(n>0||o<0)?new Te(h):(n<0?h=h.takeRight(-n):n&&(h=h.drop(n)),o!==t&&(o=Pe(o),h=o<0?h.dropRight(-o):h.take(o-n)),h)},Te.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},Te.prototype.toArray=function(){return this.take(p)},Ii(Te.prototype,function(n,o){var h=/^(?:filter|find|map|reject)|While$/.test(o),d=/^(?:head|last)$/.test(o),v=_[d?"take"+(o=="last"?"Right":""):o],E=d||/^find/.test(o);v&&(_.prototype[o]=function(){var N=this.__wrapped__,C=d?[1]:arguments,T=N instanceof Te,V=C[0],J=T||Se(N),G=function(Oe){var ke=v.apply(_,un([Oe],C));return d&&Z?ke[0]:ke};J&&h&&typeof V=="function"&&V.length!=1&&(T=J=!1);var Z=this.__chain__,he=!!this.__actions__.length,ve=E&&!Z,Me=T&&!he;if(!E&&J){N=Me?N:new Te(this);var ye=n.apply(N,C);return ye.__actions__.push({func:Ra,args:[G],thisArg:t}),new qr(ye,Z)}return ve&&Me?n.apply(this,C):(ye=this.thru(G),ve?d?ye.value()[0]:ye.value():ye)})}),Dr(["pop","push","shift","sort","splice","unshift"],function(n){var o=ta[n],h=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",d=/^(?:pop|shift)$/.test(n);_.prototype[n]=function(){var v=arguments;if(d&&!this.__chain__){var E=this.value();return o.apply(Se(E)?E:[],v)}return this[h](function(N){return o.apply(Se(N)?N:[],v)})}}),Ii(Te.prototype,function(n,o){var h=_[o];if(h){var d=h.name+"";tt.call(_s,d)||(_s[d]=[]),_s[d].push({name:o,func:h})}}),_s[Aa(t,ee).name]=[{name:"wrapper",func:t}],Te.prototype.clone=n_,Te.prototype.reverse=s_,Te.prototype.value=o_,_.prototype.at=T6,_.prototype.chain=q6,_.prototype.commit=B6,_.prototype.next=k6,_.prototype.plant=j6,_.prototype.reverse=z6,_.prototype.toJSON=_.prototype.valueOf=_.prototype.value=L6,_.prototype.first=_.prototype.head,ro&&(_.prototype[ro]=U6),_},ys=B3();Nn?((Nn.exports=ys)._=ys,Vc._=ys):Wt._=ys}).call($s)})(Tc,Tc.exports);var v2=Object.defineProperty,y2=Object.defineProperties,w2=Object.getOwnPropertyDescriptors,zf=Object.getOwnPropertySymbols,b2=Object.prototype.hasOwnProperty,_2=Object.prototype.propertyIsEnumerable,Lf=(r,e,t)=>e in r?v2(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Qo=(r,e)=>{for(var t in e||(e={}))b2.call(e,t)&&Lf(r,t,e[t]);if(zf)for(var t of zf(e))_2.call(e,t)&&Lf(r,t,e[t]);return r},A2=(r,e)=>y2(r,w2(e));function Ti(r,e,t){var s;const a=Ln(r);return((s=e.rpcMap)==null?void 0:s[a.reference])||`${m2}?chainId=${a.namespace}:${a.reference}&projectId=${t}`}function Rn(r){return r.includes(":")?r.split(":")[1]:r}function Kf(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function E2(r,e){const t=Object.keys(e.namespaces).filter(a=>a.includes(r));if(!t.length)return[];const s=[];return t.forEach(a=>{const u=e.namespaces[a].accounts;s.push(...u)}),s}function qc(r={},e={}){const t=Hf(r),s=Hf(e);return Tc.exports.merge(t,s)}function Hf(r){var e,t,s,a;const u={};if(!as(r))return u;for(const[f,m]of Object.entries(r)){const b=Lo(f)?[f]:m.chains,w=m.methods||[],P=m.events||[],R=m.rpcMap||{},F=os(f);u[F]=A2(Qo(Qo({},u[F]),m),{chains:zr(b,(e=u[F])==null?void 0:e.chains),methods:zr(w,(t=u[F])==null?void 0:t.methods),events:zr(P,(s=u[F])==null?void 0:s.events),rpcMap:Qo(Qo({},R),(a=u[F])==null?void 0:a.rpcMap)})}return u}function I2(r){return r.includes(":")?r.split(":")[2]:r}function Vf(r){const e={};for(const[t,s]of Object.entries(r)){const a=s.methods||[],u=s.events||[],f=s.accounts||[],m=Lo(t)?[t]:s.chains?s.chains:Kf(s.accounts);e[t]={chains:m,methods:a,events:u,accounts:f}}return e}function Bc(r){return typeof r=="number"?r:r.includes("0x")?parseInt(r,16):(r=r.includes(":")?r.split(":")[1]:r,isNaN(Number(r))?r:Number(r))}const $f={},ot=r=>$f[r],kc=(r,e)=>{$f[r]=e};class S2{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(gi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const a=Rn(t);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Ti(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new fi.r(new Di.Z(s,ot("disableProviderPing")))}}var x2=Object.defineProperty,P2=Object.defineProperties,M2=Object.getOwnPropertyDescriptors,Jf=Object.getOwnPropertySymbols,R2=Object.prototype.hasOwnProperty,N2=Object.prototype.propertyIsEnumerable,Qf=(r,e,t)=>e in r?x2(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Gf=(r,e)=>{for(var t in e||(e={}))R2.call(e,t)&&Qf(r,t,e[t]);if(Jf)for(var t of Jf(e))N2.call(e,t)&&Qf(r,t,e[t]);return r},Yf=(r,e)=>P2(r,M2(e));class C2{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=ot("events"),this.client=ot("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(gi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||Ti(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new fi.r(new Di.k(s,ot("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const a=parseInt(Rn(t));e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let a=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const u=parseInt(a,16);if(this.isChainApproved(u))this.setDefaultChain(`${u}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${u}`);else throw new Error(`Failed to switch to chain 'eip155:${u}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,s,a;const u=(s=(t=e.request)==null?void 0:t.params)==null?void 0:s[0];if(!u)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const f=this.client.session.get(e.topic),m=((a=f==null?void 0:f.sessionProperties)==null?void 0:a.capabilities)||{};if(m!=null&&m[u])return m==null?void 0:m[u];const b=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Yf(Gf({},f.sessionProperties||{}),{capabilities:Yf(Gf({},m||{}),{[u]:b})})})}catch(w){console.warn("Failed to update session with capabilities",w)}return b}}class O2{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(gi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const a=Rn(t);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Ti(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new fi.r(new Di.Z(s,ot("disableProviderPing")))}}class F2{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(gi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const a=Rn(t);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Ti(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new fi.r(new Di.Z(s,ot("disableProviderPing")))}}class D2{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(gi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t),a=Rn(t);e[a]=this.createHttpProvider(a,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new fi.r(new Di.Z(s,ot("disableProviderPing")))}}class T2{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(gi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const a=Rn(t);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Ti(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new fi.r(new Di.Z(s,ot("disableProviderPing")))}}class q2{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(gi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const a=Rn(t);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Ti(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new fi.r(new Di.Z(s,ot("disableProviderPing")))}}class B2{constructor(e){this.name="near",this.namespace=e.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||Ti(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(gi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Ti(e,this.namespace);return typeof s>"u"?void 0:new fi.r(new Di.Z(s,ot("disableProviderPing")))}}class k2{constructor(e){this.name=hs,this.namespace=e.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(gi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;const s={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(a=>{const u=Ln(a);s[`${u.namespace}:${u.reference}`]=this.createHttpProvider(a)}),s}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Ti(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new fi.r(new Di.Z(s,ot("disableProviderPing")))}}var U2=Object.defineProperty,j2=Object.defineProperties,z2=Object.getOwnPropertyDescriptors,Wf=Object.getOwnPropertySymbols,L2=Object.prototype.hasOwnProperty,K2=Object.prototype.propertyIsEnumerable,Zf=(r,e,t)=>e in r?U2(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Go=(r,e)=>{for(var t in e||(e={}))L2.call(e,t)&&Zf(r,t,e[t]);if(Wf)for(var t of Wf(e))K2.call(e,t)&&Zf(r,t,e[t]);return r},Uc=(r,e)=>j2(r,z2(e));class Yo{constructor(e){this.events=new(Ms()),this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:(0,Ne.gw)((0,Ne.jI)({level:(e==null?void 0:e.logger)||Uf})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new Yo(e);return await t.initialize(),t}async request(e,t,s){const[a,u]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(a).request({request:Go({},e),chainId:`${a}:${u}`,topic:this.session.topic,expiry:s})}sendAsync(e,t,s,a){const u=new Date().getTime();this.request(e,s,a).then(f=>t(null,(0,we.formatJsonRpcResult)(u,f))).catch(f=>t(f,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:rt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:t,response:s}=await this.client.authenticate(e);t&&(this.uri=t,this.events.emit("display_uri",t));const a=await s();if(this.session=a.session,this.session){const u=Vf(this.session.namespaces);this.namespaces=qc(this.namespaces,u),this.persist("namespaces",this.namespaces),this.onConnect()}return a}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(u=>{this.session=u;const f=Vf(u.namespaces);this.namespaces=qc(this.namespaces,f),this.persist("namespaces",this.namespaces)}).catch(u=>{if(u.message!==qf)throw u;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,a]=this.validateChain(e),u=this.getProvider(s);u.name===hs?u.setDefaultChain(`${s}:${a}`,t):u.setDefaultChain(a,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(xn(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Dc.init({logger:this.providerOpts.logger||Uf,relayUrl:this.providerOpts.relayUrl||d2,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>os(t)))];kc("client",this.client),kc("events",this.events),kc("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=E2(t,this.session),a=Kf(s),u=qc(this.namespaces,this.optionalNamespaces),f=Uc(Go({},u[t]),{accounts:s,chains:a});switch(t){case"eip155":this.rpcProviders[t]=new C2({namespace:f});break;case"solana":this.rpcProviders[t]=new O2({namespace:f});break;case"cosmos":this.rpcProviders[t]=new F2({namespace:f});break;case"polkadot":this.rpcProviders[t]=new S2({namespace:f});break;case"cip34":this.rpcProviders[t]=new D2({namespace:f});break;case"elrond":this.rpcProviders[t]=new T2({namespace:f});break;case"multiversx":this.rpcProviders[t]=new q2({namespace:f});break;case"near":this.rpcProviders[t]=new B2({namespace:f});break;default:this.rpcProviders[hs]?this.rpcProviders[hs].updateNamespace(f):this.rpcProviders[hs]=new k2({namespace:f})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const a=s.data;a&&xn(a)&&this.events.emit("accountsChanged",a.map(I2))}else if(s.name==="chainChanged"){const a=t.chainId,u=t.event.data,f=os(a),m=Bc(a)!==Bc(u)?`${f}:${Bc(u)}`:a;this.onChainChanged(m)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:a}=t,u=(s=this.client)==null?void 0:s.session.get(e);this.session=Uc(Go({},u),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Uc(Go({},rt("USER_DISCONNECTED")),{data:e.topic}))}),this.on(gi.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[hs]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:a}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(f=>os(f)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const a=os(Object.keys(this.namespaces)[0]),u=this.rpcProviders[a].getDefaultChain();return[a,u]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){if(!this.namespaces)return;const[s,a]=this.validateChain(e);a&&(t||this.getProvider(s).setDefaultChain(a),this.namespaces[s]?this.namespaces[s].defaultChain=a:this.namespaces[`${s}:${a}`]?this.namespaces[`${s}:${a}`].defaultChain=a:this.namespaces[`${s}:${a}`]={defaultChain:a},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",a))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${jf}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${jf}/${e}`)}}const H2=Yo},51538:function(Ba,Un,ce){Ba.exports=self.fetch||(self.fetch=ce(9868).default||ce(9868))},9868:function(Ba,Un,ce){"use strict";ce.r(Un),ce.d(Un,{default:function(){return ti}});function ti(Ms,Pi){return Pi=Pi||{},new Promise(function(vn,Ne){var Ft=new XMLHttpRequest,vo=[],ka=[],yn={},yo=function(){return{ok:(Ft.status/100|0)==2,statusText:Ft.statusText,status:Ft.status,url:Ft.responseURL,text:function(){return Promise.resolve(Ft.responseText)},json:function(){return Promise.resolve(Ft.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([Ft.response]))},clone:yo,headers:{keys:function(){return vo},entries:function(){return ka},get:function(jn){return yn[jn.toLowerCase()]},has:function(jn){return jn.toLowerCase()in yn}}}};for(var wo in Ft.open(Pi.method||"get",Ms,!0),Ft.onload=function(){Ft.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(jn,Zi,bo){vo.push(Zi=Zi.toLowerCase()),ka.push([Zi,bo]),yn[Zi]=yn[Zi]?yn[Zi]+","+bo:bo}),vn(yo())},Ft.onerror=Ne,Ft.withCredentials=Pi.credentials=="include",Pi.headers)Ft.setRequestHeader(wo,Pi.headers[wo]);Ft.send(Pi.body||null)})}}}]);
