"use strict";(self.webpackChunk_ant_design_web3_docs=self.webpackChunk_ant_design_web3_docs||[]).push([[7490],{16346:function(f,a,d){var i;i={value:!0},a.SafeAppProvider=void 0;var c=d(57832);Object.defineProperty(a,"SafeAppProvider",{enumerable:!0,get:function(){return c.SafeAppProvider}})},57832:function(f,a,d){Object.defineProperty(a,"__esModule",{value:!0}),a.SafeAppProvider=void 0;const i=d(72100),c=d(48647);class _ extends i.EventEmitter{constructor(n,h){super(),this.submittedTxs=new Map,this.safe=n,this.sdk=h}async connect(){this.emit("connect",{chainId:this.chainId})}async disconnect(){}get chainId(){return this.safe.chainId}async request(n){const{method:h,params:e=[]}=n;switch(h){case"eth_accounts":return[this.safe.safeAddress];case"net_version":case"eth_chainId":return`0x${this.chainId.toString(16)}`;case"personal_sign":{const[s,t]=e;if(this.safe.safeAddress.toLowerCase()!==t.toLowerCase())throw new Error("The address or message hash is invalid");const o=await this.sdk.txs.signMessage(s);return("signature"in o?o.signature:void 0)||"0x"}case"eth_sign":{const[s,t]=e;if(this.safe.safeAddress.toLowerCase()!==s.toLowerCase()||!t.startsWith("0x"))throw new Error("The address or message hash is invalid");const o=await this.sdk.txs.signMessage(t);return("signature"in o?o.signature:void 0)||"0x"}case"eth_signTypedData":case"eth_signTypedData_v4":{const[s,t]=e,o=typeof t=="string"?JSON.parse(t):t;if(this.safe.safeAddress.toLowerCase()!==s.toLowerCase())throw new Error("The address is invalid");const g=await this.sdk.txs.signTypedMessage(o);return("signature"in g?g.signature:void 0)||"0x"}case"eth_sendTransaction":const r={...e[0],value:e[0].value||"0",data:e[0].data||"0x"};typeof r.gas=="string"&&r.gas.startsWith("0x")&&(r.gas=parseInt(r.gas,16));const l=await this.sdk.txs.send({txs:[r],params:{safeTxGas:r.gas}});return this.submittedTxs.set(l.safeTxHash,{from:this.safe.safeAddress,hash:l.safeTxHash,gas:0,gasPrice:"0x00",nonce:0,input:r.data,value:r.value,to:r.to,blockHash:null,blockNumber:null,transactionIndex:null}),l.safeTxHash;case"eth_blockNumber":return(await this.sdk.eth.getBlockByNumber(["latest"])).number;case"eth_getBalance":return this.sdk.eth.getBalance([(0,c.getLowerCase)(e[0]),e[1]]);case"eth_getCode":return this.sdk.eth.getCode([(0,c.getLowerCase)(e[0]),e[1]]);case"eth_getTransactionCount":return this.sdk.eth.getTransactionCount([(0,c.getLowerCase)(e[0]),e[1]]);case"eth_getStorageAt":return this.sdk.eth.getStorageAt([(0,c.getLowerCase)(e[0]),e[1],e[2]]);case"eth_getBlockByNumber":return this.sdk.eth.getBlockByNumber([e[0],e[1]]);case"eth_getBlockByHash":return this.sdk.eth.getBlockByHash([e[0],e[1]]);case"eth_getTransactionByHash":let u=e[0];try{u=(await this.sdk.txs.getBySafeTxHash(u)).txHash||u}catch{}return this.submittedTxs.has(u)?this.submittedTxs.get(u):this.sdk.eth.getTransactionByHash([u]).then(s=>(s&&(s.hash=e[0]),s));case"eth_getTransactionReceipt":{let s=e[0];try{s=(await this.sdk.txs.getBySafeTxHash(s)).txHash||s}catch{}return this.sdk.eth.getTransactionReceipt([s]).then(t=>(t&&(t.transactionHash=e[0]),t))}case"eth_estimateGas":return this.sdk.eth.getEstimateGas(e[0]);case"eth_call":return this.sdk.eth.call([e[0],e[1]]);case"eth_getLogs":return this.sdk.eth.getPastLogs([e[0]]);case"eth_gasPrice":return this.sdk.eth.getGasPrice();case"wallet_getPermissions":return this.sdk.wallet.getPermissions();case"wallet_requestPermissions":return this.sdk.wallet.requestPermissions(e[0]);case"safe_setSettings":return this.sdk.eth.setSafeSettings([e[0]]);default:throw Error(`"${n.method}" not implemented`)}}send(n,h){n||h("Undefined request"),this.request(n).then(e=>h(null,{jsonrpc:"2.0",id:n.id,result:e})).catch(e=>h(e,null))}}a.SafeAppProvider=_},48647:function(f,a){Object.defineProperty(a,"__esModule",{value:!0}),a.getLowerCase=void 0;function d(i){return i&&i.toLowerCase()}a.getLowerCase=d}}]);
